import{R as uh,f as M0}from"./lib.modern-DHFPEOLP.js";import{e as rn}from"./livewire.esm-C819BCfU.js";const O0="modulepreload",N0=function(o){return"/build/"+o},Bc={},zc=function(n,e,r){let a=Promise.resolve();if(e&&e.length>0){let u=function(g){return Promise.all(g.map(v=>Promise.resolve(v).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),f=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));a=u(e.map(g=>{if(g=N0(g),g in Bc)return;Bc[g]=!0;const v=g.endsWith(".css"),y=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${y}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":O0,v||(S.as="script"),S.crossOrigin="",S.href=g,f&&S.setAttribute("nonce",f),document.head.appendChild(S),v)return new Promise((C,A)=>{S.addEventListener("load",C),S.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return a.then(u=>{for(const h of u||[])h.status==="rejected"&&l(h.reason);return n().catch(l)})};typeof window.pusherConfig<"u"?zc(async()=>{const{default:o}=await import("./echo-DL0QqwGZ.js");return{default:o}},[]).then(({default:o})=>{zc(async()=>{const{default:n}=await import("./pusher-DMYFTBOl.js").then(e=>e.p);return{default:n}},[]).then(({default:n})=>{window.Pusher=n;let e=window.pusherConfig;window.Echo=new o({broadcaster:"pusher",key:e.key,cluster:e.cluster,wsHost:e.wsHost??`ws-${e.cluster}.pusher.com`,wsPort:e.port??80,wssPort:e.port??443,forceTLS:(e.scheme??"https")==="https",enabledTransports:["ws","wss"]})}).catch(n=>console.log("Failed to load Pusher:",n))}).catch(o=>console.log("Failed to load Echo:",o)):console.log("window.pusherConfig is not defined.");function Wc(o,n){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),e.push.apply(e,r)}return e}function an(o){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?Wc(Object(e),!0).forEach(function(r){L0(o,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):Wc(Object(e)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(e,r))})}return o}function Oo(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Oo=function(n){return typeof n}:Oo=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Oo(o)}function L0(o,n,e){return n in o?Object.defineProperty(o,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[n]=e,o}function Sn(){return Sn=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},Sn.apply(this,arguments)}function F0(o,n){if(o==null)return{};var e={},r=Object.keys(o),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(e[a]=o[a]);return e}function k0(o,n){if(o==null)return{};var e=F0(o,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(o);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(o,r)&&(e[r]=o[r])}return e}var $0="1.15.2";function wn(o){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(o)}var En=wn(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Cr=wn(/Edge/i),Hc=wn(/firefox/i),pr=wn(/safari/i)&&!wn(/chrome/i)&&!wn(/android/i),ch=wn(/iP(ad|od|hone)/i),hh=wn(/chrome/i)&&wn(/android/i),fh={capture:!1,passive:!1};function vt(o,n,e){o.addEventListener(n,e,!En&&fh)}function gt(o,n,e){o.removeEventListener(n,e,!En&&fh)}function Uo(o,n){if(n){if(n[0]===">"&&(n=n.substring(1)),o)try{if(o.matches)return o.matches(n);if(o.msMatchesSelector)return o.msMatchesSelector(n);if(o.webkitMatchesSelector)return o.webkitMatchesSelector(n)}catch{return!1}return!1}}function B0(o){return o.host&&o!==document&&o.host.nodeType?o.host:o.parentNode}function Je(o,n,e,r){if(o){e=e||document;do{if(n!=null&&(n[0]===">"?o.parentNode===e&&Uo(o,n):Uo(o,n))||r&&o===e)return o;if(o===e)break}while(o=B0(o))}return null}var Uc=/\s+/g;function De(o,n,e){if(o&&n)if(o.classList)o.classList[e?"add":"remove"](n);else{var r=(" "+o.className+" ").replace(Uc," ").replace(" "+n+" "," ");o.className=(r+(e?" "+n:"")).replace(Uc," ")}}function V(o,n,e){var r=o&&o.style;if(r){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(o,""):o.currentStyle&&(e=o.currentStyle),n===void 0?e:e[n];!(n in r)&&n.indexOf("webkit")===-1&&(n="-webkit-"+n),r[n]=e+(typeof e=="string"?"":"px")}}function Di(o,n){var e="";if(typeof o=="string")e=o;else do{var r=V(o,"transform");r&&r!=="none"&&(e=r+" "+e)}while(!n&&(o=o.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(e)}function dh(o,n,e){if(o){var r=o.getElementsByTagName(n),a=0,l=r.length;if(e)for(;a<l;a++)e(r[a],a);return r}return[]}function on(){var o=document.scrollingElement;return o||document.documentElement}function Xt(o,n,e,r,a){if(!(!o.getBoundingClientRect&&o!==window)){var l,u,h,f,g,v,y;if(o!==window&&o.parentNode&&o!==on()?(l=o.getBoundingClientRect(),u=l.top,h=l.left,f=l.bottom,g=l.right,v=l.height,y=l.width):(u=0,h=0,f=window.innerHeight,g=window.innerWidth,v=window.innerHeight,y=window.innerWidth),(n||e)&&o!==window&&(a=a||o.parentNode,!En))do if(a&&a.getBoundingClientRect&&(V(a,"transform")!=="none"||e&&V(a,"position")!=="static")){var S=a.getBoundingClientRect();u-=S.top+parseInt(V(a,"border-top-width")),h-=S.left+parseInt(V(a,"border-left-width")),f=u+l.height,g=h+l.width;break}while(a=a.parentNode);if(r&&o!==window){var C=Di(a||o),A=C&&C.a,R=C&&C.d;C&&(u/=R,h/=A,y/=A,v/=R,f=u+v,g=h+y)}return{top:u,left:h,bottom:f,right:g,width:y,height:v}}}function Gc(o,n,e){for(var r=$n(o,!0),a=Xt(o)[n];r;){var l=Xt(r)[e],u=void 0;if(u=a>=l,!u)return r;if(r===on())break;r=$n(r,!1)}return!1}function Mi(o,n,e,r){for(var a=0,l=0,u=o.children;l<u.length;){if(u[l].style.display!=="none"&&u[l]!==K.ghost&&(r||u[l]!==K.dragged)&&Je(u[l],e.draggable,o,!1)){if(a===n)return u[l];a++}l++}return null}function tl(o,n){for(var e=o.lastElementChild;e&&(e===K.ghost||V(e,"display")==="none"||n&&!Uo(e,n));)e=e.previousElementSibling;return e||null}function He(o,n){var e=0;if(!o||!o.parentNode)return-1;for(;o=o.previousElementSibling;)o.nodeName.toUpperCase()!=="TEMPLATE"&&o!==K.clone&&(!n||Uo(o,n))&&e++;return e}function Yc(o){var n=0,e=0,r=on();if(o)do{var a=Di(o),l=a.a,u=a.d;n+=o.scrollLeft*l,e+=o.scrollTop*u}while(o!==r&&(o=o.parentNode));return[n,e]}function z0(o,n){for(var e in o)if(o.hasOwnProperty(e)){for(var r in n)if(n.hasOwnProperty(r)&&n[r]===o[e][r])return Number(e)}return-1}function $n(o,n){if(!o||!o.getBoundingClientRect)return on();var e=o,r=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var a=V(e);if(e.clientWidth<e.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return on();if(r||n)return e;r=!0}}while(e=e.parentNode);return on()}function W0(o,n){if(o&&n)for(var e in n)n.hasOwnProperty(e)&&(o[e]=n[e]);return o}function Sa(o,n){return Math.round(o.top)===Math.round(n.top)&&Math.round(o.left)===Math.round(n.left)&&Math.round(o.height)===Math.round(n.height)&&Math.round(o.width)===Math.round(n.width)}var mr;function gh(o,n){return function(){if(!mr){var e=arguments,r=this;e.length===1?o.call(r,e[0]):o.apply(r,e),mr=setTimeout(function(){mr=void 0},n)}}}function H0(){clearTimeout(mr),mr=void 0}function ph(o,n,e){o.scrollLeft+=n,o.scrollTop+=e}function mh(o){var n=window.Polymer,e=window.jQuery||window.Zepto;return n&&n.dom?n.dom(o).cloneNode(!0):e?e(o).clone(!0)[0]:o.cloneNode(!0)}function vh(o,n,e){var r={};return Array.from(o.children).forEach(function(a){var l,u,h,f;if(!(!Je(a,n.draggable,o,!1)||a.animated||a===e)){var g=Xt(a);r.left=Math.min((l=r.left)!==null&&l!==void 0?l:1/0,g.left),r.top=Math.min((u=r.top)!==null&&u!==void 0?u:1/0,g.top),r.right=Math.max((h=r.right)!==null&&h!==void 0?h:-1/0,g.right),r.bottom=Math.max((f=r.bottom)!==null&&f!==void 0?f:-1/0,g.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var Oe="Sortable"+new Date().getTime();function U0(){var o=[],n;return{captureAnimationState:function(){if(o=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(a){if(!(V(a,"display")==="none"||a===K.ghost)){o.push({target:a,rect:Xt(a)});var l=an({},o[o.length-1].rect);if(a.thisAnimationDuration){var u=Di(a,!0);u&&(l.top-=u.f,l.left-=u.e)}a.fromRect=l}})}},addAnimationState:function(r){o.push(r)},removeAnimationState:function(r){o.splice(z0(o,{target:r}),1)},animateAll:function(r){var a=this;if(!this.options.animation){clearTimeout(n),typeof r=="function"&&r();return}var l=!1,u=0;o.forEach(function(h){var f=0,g=h.target,v=g.fromRect,y=Xt(g),S=g.prevFromRect,C=g.prevToRect,A=h.rect,R=Di(g,!0);R&&(y.top-=R.f,y.left-=R.e),g.toRect=y,g.thisAnimationDuration&&Sa(S,y)&&!Sa(v,y)&&(A.top-y.top)/(A.left-y.left)===(v.top-y.top)/(v.left-y.left)&&(f=Y0(A,S,C,a.options)),Sa(y,v)||(g.prevFromRect=v,g.prevToRect=y,f||(f=a.options.animation),a.animate(g,A,y,f)),f&&(l=!0,u=Math.max(u,f),clearTimeout(g.animationResetTimer),g.animationResetTimer=setTimeout(function(){g.animationTime=0,g.prevFromRect=null,g.fromRect=null,g.prevToRect=null,g.thisAnimationDuration=null},f),g.thisAnimationDuration=f)}),clearTimeout(n),l?n=setTimeout(function(){typeof r=="function"&&r()},u):typeof r=="function"&&r(),o=[]},animate:function(r,a,l,u){if(u){V(r,"transition",""),V(r,"transform","");var h=Di(this.el),f=h&&h.a,g=h&&h.d,v=(a.left-l.left)/(f||1),y=(a.top-l.top)/(g||1);r.animatingX=!!v,r.animatingY=!!y,V(r,"transform","translate3d("+v+"px,"+y+"px,0)"),this.forRepaintDummy=G0(r),V(r,"transition","transform "+u+"ms"+(this.options.easing?" "+this.options.easing:"")),V(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){V(r,"transition",""),V(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},u)}}}}function G0(o){return o.offsetWidth}function Y0(o,n,e,r){return Math.sqrt(Math.pow(n.top-o.top,2)+Math.pow(n.left-o.left,2))/Math.sqrt(Math.pow(n.top-e.top,2)+Math.pow(n.left-e.left,2))*r.animation}var wi=[],Ea={initializeByDefault:!0},Tr={mount:function(n){for(var e in Ea)Ea.hasOwnProperty(e)&&!(e in n)&&(n[e]=Ea[e]);wi.forEach(function(r){if(r.pluginName===n.pluginName)throw"Sortable: Cannot mount plugin ".concat(n.pluginName," more than once")}),wi.push(n)},pluginEvent:function(n,e,r){var a=this;this.eventCanceled=!1,r.cancel=function(){a.eventCanceled=!0};var l=n+"Global";wi.forEach(function(u){e[u.pluginName]&&(e[u.pluginName][l]&&e[u.pluginName][l](an({sortable:e},r)),e.options[u.pluginName]&&e[u.pluginName][n]&&e[u.pluginName][n](an({sortable:e},r)))})},initializePlugins:function(n,e,r,a){wi.forEach(function(h){var f=h.pluginName;if(!(!n.options[f]&&!h.initializeByDefault)){var g=new h(n,e,n.options);g.sortable=n,g.options=n.options,n[f]=g,Sn(r,g.defaults)}});for(var l in n.options)if(n.options.hasOwnProperty(l)){var u=this.modifyOption(n,l,n.options[l]);typeof u<"u"&&(n.options[l]=u)}},getEventProperties:function(n,e){var r={};return wi.forEach(function(a){typeof a.eventProperties=="function"&&Sn(r,a.eventProperties.call(e[a.pluginName],n))}),r},modifyOption:function(n,e,r){var a;return wi.forEach(function(l){n[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[e]=="function"&&(a=l.optionListeners[e].call(n[l.pluginName],r))}),a}};function q0(o){var n=o.sortable,e=o.rootEl,r=o.name,a=o.targetEl,l=o.cloneEl,u=o.toEl,h=o.fromEl,f=o.oldIndex,g=o.newIndex,v=o.oldDraggableIndex,y=o.newDraggableIndex,S=o.originalEvent,C=o.putSortable,A=o.extraEventProperties;if(n=n||e&&e[Oe],!!n){var R,M=n.options,z="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!En&&!Cr?R=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(R=document.createEvent("Event"),R.initEvent(r,!0,!0)),R.to=u||e,R.from=h||e,R.item=a||e,R.clone=l,R.oldIndex=f,R.newIndex=g,R.oldDraggableIndex=v,R.newDraggableIndex=y,R.originalEvent=S,R.pullMode=C?C.lastPutMode:void 0;var N=an(an({},A),Tr.getEventProperties(r,n));for(var B in N)R[B]=N[B];e&&e.dispatchEvent(R),M[z]&&M[z].call(n,R)}}var X0=["evt"],be=function(n,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=r.evt,l=k0(r,X0);Tr.pluginEvent.bind(K)(n,e,an({dragEl:L,parentEl:$t,ghostEl:j,rootEl:Rt,nextEl:jn,lastDownEl:No,cloneEl:Lt,cloneHidden:Fn,dragStarted:ar,putSortable:ne,activeSortable:K.active,originalEvent:a,oldIndex:Ai,oldDraggableIndex:vr,newIndex:Re,newDraggableIndex:Nn,hideGhostForTarget:_h,unhideGhostForTarget:Sh,cloneNowHidden:function(){Fn=!0},cloneNowShown:function(){Fn=!1},dispatchSortableEvent:function(h){de({sortable:e,name:h,originalEvent:a})}},l))};function de(o){q0(an({putSortable:ne,cloneEl:Lt,targetEl:L,rootEl:Rt,oldIndex:Ai,oldDraggableIndex:vr,newIndex:Re,newDraggableIndex:Nn},o))}var L,$t,j,Rt,jn,No,Lt,Fn,Ai,Re,vr,Nn,So,ne,Ci=!1,Go=!1,Yo=[],Kn,Ke,xa,Ca,qc,Xc,ar,_i,yr,br=!1,Eo=!1,Lo,le,Ta=[],Ha=!1,qo=[],jo=typeof document<"u",xo=ch,Vc=Cr||En?"cssFloat":"float",V0=jo&&!hh&&!ch&&"draggable"in document.createElement("div"),yh=function(){if(jo){if(En)return!1;var o=document.createElement("x");return o.style.cssText="pointer-events:auto",o.style.pointerEvents==="auto"}}(),bh=function(n,e){var r=V(n),a=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),l=Mi(n,0,e),u=Mi(n,1,e),h=l&&V(l),f=u&&V(u),g=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+Xt(l).width,v=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+Xt(u).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&h.float&&h.float!=="none"){var y=h.float==="left"?"left":"right";return u&&(f.clear==="both"||f.clear===y)?"vertical":"horizontal"}return l&&(h.display==="block"||h.display==="flex"||h.display==="table"||h.display==="grid"||g>=a&&r[Vc]==="none"||u&&r[Vc]==="none"&&g+v>a)?"vertical":"horizontal"},K0=function(n,e,r){var a=r?n.left:n.top,l=r?n.right:n.bottom,u=r?n.width:n.height,h=r?e.left:e.top,f=r?e.right:e.bottom,g=r?e.width:e.height;return a===h||l===f||a+u/2===h+g/2},Z0=function(n,e){var r;return Yo.some(function(a){var l=a[Oe].options.emptyInsertThreshold;if(!(!l||tl(a))){var u=Xt(a),h=n>=u.left-l&&n<=u.right+l,f=e>=u.top-l&&e<=u.bottom+l;if(h&&f)return r=a}}),r},wh=function(n){function e(l,u){return function(h,f,g,v){var y=h.options.group.name&&f.options.group.name&&h.options.group.name===f.options.group.name;if(l==null&&(u||y))return!0;if(l==null||l===!1)return!1;if(u&&l==="clone")return l;if(typeof l=="function")return e(l(h,f,g,v),u)(h,f,g,v);var S=(u?h:f).options.group.name;return l===!0||typeof l=="string"&&l===S||l.join&&l.indexOf(S)>-1}}var r={},a=n.group;(!a||Oo(a)!="object")&&(a={name:a}),r.name=a.name,r.checkPull=e(a.pull,!0),r.checkPut=e(a.put),r.revertClone=a.revertClone,n.group=r},_h=function(){!yh&&j&&V(j,"display","none")},Sh=function(){!yh&&j&&V(j,"display","")};jo&&!hh&&document.addEventListener("click",function(o){if(Go)return o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.stopImmediatePropagation&&o.stopImmediatePropagation(),Go=!1,!1},!0);var Zn=function(n){if(L){n=n.touches?n.touches[0]:n;var e=Z0(n.clientX,n.clientY);if(e){var r={};for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a]);r.target=r.rootEl=e,r.preventDefault=void 0,r.stopPropagation=void 0,e[Oe]._onDragOver(r)}}},Q0=function(n){L&&L.parentNode[Oe]._isOutsideThisEl(n.target)};function K(o,n){if(!(o&&o.nodeType&&o.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(o));this.el=o,this.options=n=Sn({},n),o[Oe]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(o.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return bh(o,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(u,h){u.setData("Text",h.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:K.supportPointer!==!1&&"PointerEvent"in window&&!pr,emptyInsertThreshold:5};Tr.initializePlugins(this,o,e);for(var r in e)!(r in n)&&(n[r]=e[r]);wh(n);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=n.forceFallback?!1:V0,this.nativeDraggable&&(this.options.touchStartThreshold=1),n.supportPointer?vt(o,"pointerdown",this._onTapStart):(vt(o,"mousedown",this._onTapStart),vt(o,"touchstart",this._onTapStart)),this.nativeDraggable&&(vt(o,"dragover",this),vt(o,"dragenter",this)),Yo.push(this.el),n.store&&n.store.get&&this.sort(n.store.get(this)||[]),Sn(this,U0())}K.prototype={constructor:K,_isOutsideThisEl:function(n){!this.el.contains(n)&&n!==this.el&&(_i=null)},_getDirection:function(n,e){return typeof this.options.direction=="function"?this.options.direction.call(this,n,e,L):this.options.direction},_onTapStart:function(n){if(n.cancelable){var e=this,r=this.el,a=this.options,l=a.preventOnFilter,u=n.type,h=n.touches&&n.touches[0]||n.pointerType&&n.pointerType==="touch"&&n,f=(h||n).target,g=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||f,v=a.filter;if(ob(r),!L&&!(/mousedown|pointerdown/.test(u)&&n.button!==0||a.disabled)&&!g.isContentEditable&&!(!this.nativeDraggable&&pr&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=Je(f,a.draggable,r,!1),!(f&&f.animated)&&No!==f)){if(Ai=He(f),vr=He(f,a.draggable),typeof v=="function"){if(v.call(this,n,f,this)){de({sortable:e,rootEl:g,name:"filter",targetEl:f,toEl:r,fromEl:r}),be("filter",e,{evt:n}),l&&n.cancelable&&n.preventDefault();return}}else if(v&&(v=v.split(",").some(function(y){if(y=Je(g,y.trim(),r,!1),y)return de({sortable:e,rootEl:y,name:"filter",targetEl:f,fromEl:r,toEl:r}),be("filter",e,{evt:n}),!0}),v)){l&&n.cancelable&&n.preventDefault();return}a.handle&&!Je(g,a.handle,r,!1)||this._prepareDragStart(n,h,f)}}},_prepareDragStart:function(n,e,r){var a=this,l=a.el,u=a.options,h=l.ownerDocument,f;if(r&&!L&&r.parentNode===l){var g=Xt(r);if(Rt=l,L=r,$t=L.parentNode,jn=L.nextSibling,No=r,So=u.group,K.dragged=L,Kn={target:L,clientX:(e||n).clientX,clientY:(e||n).clientY},qc=Kn.clientX-g.left,Xc=Kn.clientY-g.top,this._lastX=(e||n).clientX,this._lastY=(e||n).clientY,L.style["will-change"]="all",f=function(){if(be("delayEnded",a,{evt:n}),K.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Hc&&a.nativeDraggable&&(L.draggable=!0),a._triggerDragStart(n,e),de({sortable:a,name:"choose",originalEvent:n}),De(L,u.chosenClass,!0)},u.ignore.split(",").forEach(function(v){dh(L,v.trim(),Aa)}),vt(h,"dragover",Zn),vt(h,"mousemove",Zn),vt(h,"touchmove",Zn),vt(h,"mouseup",a._onDrop),vt(h,"touchend",a._onDrop),vt(h,"touchcancel",a._onDrop),Hc&&this.nativeDraggable&&(this.options.touchStartThreshold=4,L.draggable=!0),be("delayStart",this,{evt:n}),u.delay&&(!u.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(Cr||En))){if(K.eventCanceled){this._onDrop();return}vt(h,"mouseup",a._disableDelayedDrag),vt(h,"touchend",a._disableDelayedDrag),vt(h,"touchcancel",a._disableDelayedDrag),vt(h,"mousemove",a._delayedDragTouchMoveHandler),vt(h,"touchmove",a._delayedDragTouchMoveHandler),u.supportPointer&&vt(h,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(f,u.delay)}else f()}},_delayedDragTouchMoveHandler:function(n){var e=n.touches?n.touches[0]:n;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){L&&Aa(L),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var n=this.el.ownerDocument;gt(n,"mouseup",this._disableDelayedDrag),gt(n,"touchend",this._disableDelayedDrag),gt(n,"touchcancel",this._disableDelayedDrag),gt(n,"mousemove",this._delayedDragTouchMoveHandler),gt(n,"touchmove",this._delayedDragTouchMoveHandler),gt(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(n,e){e=e||n.pointerType=="touch"&&n,!this.nativeDraggable||e?this.options.supportPointer?vt(document,"pointermove",this._onTouchMove):e?vt(document,"touchmove",this._onTouchMove):vt(document,"mousemove",this._onTouchMove):(vt(L,"dragend",this),vt(Rt,"dragstart",this._onDragStart));try{document.selection?Fo(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(n,e){if(Ci=!1,Rt&&L){be("dragStarted",this,{evt:e}),this.nativeDraggable&&vt(document,"dragover",Q0);var r=this.options;!n&&De(L,r.dragClass,!1),De(L,r.ghostClass,!0),K.active=this,n&&this._appendGhost(),de({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(Ke){this._lastX=Ke.clientX,this._lastY=Ke.clientY,_h();for(var n=document.elementFromPoint(Ke.clientX,Ke.clientY),e=n;n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(Ke.clientX,Ke.clientY),n!==e);)e=n;if(L.parentNode[Oe]._isOutsideThisEl(n),e)do{if(e[Oe]){var r=void 0;if(r=e[Oe]._onDragOver({clientX:Ke.clientX,clientY:Ke.clientY,target:n,rootEl:e}),r&&!this.options.dragoverBubble)break}n=e}while(e=e.parentNode);Sh()}},_onTouchMove:function(n){if(Kn){var e=this.options,r=e.fallbackTolerance,a=e.fallbackOffset,l=n.touches?n.touches[0]:n,u=j&&Di(j,!0),h=j&&u&&u.a,f=j&&u&&u.d,g=xo&&le&&Yc(le),v=(l.clientX-Kn.clientX+a.x)/(h||1)+(g?g[0]-Ta[0]:0)/(h||1),y=(l.clientY-Kn.clientY+a.y)/(f||1)+(g?g[1]-Ta[1]:0)/(f||1);if(!K.active&&!Ci){if(r&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<r)return;this._onDragStart(n,!0)}if(j){u?(u.e+=v-(xa||0),u.f+=y-(Ca||0)):u={a:1,b:0,c:0,d:1,e:v,f:y};var S="matrix(".concat(u.a,",").concat(u.b,",").concat(u.c,",").concat(u.d,",").concat(u.e,",").concat(u.f,")");V(j,"webkitTransform",S),V(j,"mozTransform",S),V(j,"msTransform",S),V(j,"transform",S),xa=v,Ca=y,Ke=l}n.cancelable&&n.preventDefault()}},_appendGhost:function(){if(!j){var n=this.options.fallbackOnBody?document.body:Rt,e=Xt(L,!0,xo,!0,n),r=this.options;if(xo){for(le=n;V(le,"position")==="static"&&V(le,"transform")==="none"&&le!==document;)le=le.parentNode;le!==document.body&&le!==document.documentElement?(le===document&&(le=on()),e.top+=le.scrollTop,e.left+=le.scrollLeft):le=on(),Ta=Yc(le)}j=L.cloneNode(!0),De(j,r.ghostClass,!1),De(j,r.fallbackClass,!0),De(j,r.dragClass,!0),V(j,"transition",""),V(j,"transform",""),V(j,"box-sizing","border-box"),V(j,"margin",0),V(j,"top",e.top),V(j,"left",e.left),V(j,"width",e.width),V(j,"height",e.height),V(j,"opacity","0.8"),V(j,"position",xo?"absolute":"fixed"),V(j,"zIndex","100000"),V(j,"pointerEvents","none"),K.ghost=j,n.appendChild(j),V(j,"transform-origin",qc/parseInt(j.style.width)*100+"% "+Xc/parseInt(j.style.height)*100+"%")}},_onDragStart:function(n,e){var r=this,a=n.dataTransfer,l=r.options;if(be("dragStart",this,{evt:n}),K.eventCanceled){this._onDrop();return}be("setupClone",this),K.eventCanceled||(Lt=mh(L),Lt.removeAttribute("id"),Lt.draggable=!1,Lt.style["will-change"]="",this._hideClone(),De(Lt,this.options.chosenClass,!1),K.clone=Lt),r.cloneId=Fo(function(){be("clone",r),!K.eventCanceled&&(r.options.removeCloneOnHide||Rt.insertBefore(Lt,L),r._hideClone(),de({sortable:r,name:"clone"}))}),!e&&De(L,l.dragClass,!0),e?(Go=!0,r._loopId=setInterval(r._emulateDragOver,50)):(gt(document,"mouseup",r._onDrop),gt(document,"touchend",r._onDrop),gt(document,"touchcancel",r._onDrop),a&&(a.effectAllowed="move",l.setData&&l.setData.call(r,a,L)),vt(document,"drop",r),V(L,"transform","translateZ(0)")),Ci=!0,r._dragStartId=Fo(r._dragStarted.bind(r,e,n)),vt(document,"selectstart",r),ar=!0,pr&&V(document.body,"user-select","none")},_onDragOver:function(n){var e=this.el,r=n.target,a,l,u,h=this.options,f=h.group,g=K.active,v=So===f,y=h.sort,S=ne||g,C,A=this,R=!1;if(Ha)return;function M(Ht,Ni){be(Ht,A,an({evt:n,isOwner:v,axis:C?"vertical":"horizontal",revert:u,dragRect:a,targetRect:l,canSort:y,fromSortable:S,target:r,completed:N,onMove:function(oe,Li){return Co(Rt,e,L,a,oe,Xt(oe),n,Li)},changed:B},Ni))}function z(){M("dragOverAnimationCapture"),A.captureAnimationState(),A!==S&&S.captureAnimationState()}function N(Ht){return M("dragOverCompleted",{insertion:Ht}),Ht&&(v?g._hideClone():g._showClone(A),A!==S&&(De(L,ne?ne.options.ghostClass:g.options.ghostClass,!1),De(L,h.ghostClass,!0)),ne!==A&&A!==K.active?ne=A:A===K.active&&ne&&(ne=null),S===A&&(A._ignoreWhileAnimating=r),A.animateAll(function(){M("dragOverAnimationComplete"),A._ignoreWhileAnimating=null}),A!==S&&(S.animateAll(),S._ignoreWhileAnimating=null)),(r===L&&!L.animated||r===e&&!r.animated)&&(_i=null),!h.dragoverBubble&&!n.rootEl&&r!==document&&(L.parentNode[Oe]._isOutsideThisEl(n.target),!Ht&&Zn(n)),!h.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),R=!0}function B(){Re=He(L),Nn=He(L,h.draggable),de({sortable:A,name:"change",toEl:e,newIndex:Re,newDraggableIndex:Nn,originalEvent:n})}if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),r=Je(r,h.draggable,e,!0),M("dragOver"),K.eventCanceled)return R;if(L.contains(n.target)||r.animated&&r.animatingX&&r.animatingY||A._ignoreWhileAnimating===r)return N(!1);if(Go=!1,g&&!h.disabled&&(v?y||(u=$t!==Rt):ne===this||(this.lastPutMode=So.checkPull(this,g,L,n))&&f.checkPut(this,g,L,n))){if(C=this._getDirection(n,r)==="vertical",a=Xt(L),M("dragOverValid"),K.eventCanceled)return R;if(u)return $t=Rt,z(),this._hideClone(),M("revert"),K.eventCanceled||(jn?Rt.insertBefore(L,jn):Rt.appendChild(L)),N(!0);var G=tl(e,h.draggable);if(!G||eb(n,C,this)&&!G.animated){if(G===L)return N(!1);if(G&&e===n.target&&(r=G),r&&(l=Xt(r)),Co(Rt,e,L,a,r,l,n,!!r)!==!1)return z(),G&&G.nextSibling?e.insertBefore(L,G.nextSibling):e.appendChild(L),$t=e,B(),N(!0)}else if(G&&tb(n,C,this)){var ft=Mi(e,0,h,!0);if(ft===L)return N(!1);if(r=ft,l=Xt(r),Co(Rt,e,L,a,r,l,n,!1)!==!1)return z(),e.insertBefore(L,ft),$t=e,B(),N(!0)}else if(r.parentNode===e){l=Xt(r);var ut=0,dt,xt=L.parentNode!==e,nt=!K0(L.animated&&L.toRect||a,r.animated&&r.toRect||l,C),Jt=C?"top":"left",It=Gc(r,"top","top")||Gc(L,"top","top"),Vt=It?It.scrollTop:void 0;_i!==r&&(dt=l[Jt],br=!1,Eo=!nt&&h.invertSwap||xt),ut=nb(n,r,l,C,nt?1:h.swapThreshold,h.invertedSwapThreshold==null?h.swapThreshold:h.invertedSwapThreshold,Eo,_i===r);var Dt;if(ut!==0){var Ot=He(L);do Ot-=ut,Dt=$t.children[Ot];while(Dt&&(V(Dt,"display")==="none"||Dt===j))}if(ut===0||Dt===r)return N(!1);_i=r,yr=ut;var jt=r.nextElementSibling,wt=!1;wt=ut===1;var Ct=Co(Rt,e,L,a,r,l,n,wt);if(Ct!==!1)return(Ct===1||Ct===-1)&&(wt=Ct===1),Ha=!0,setTimeout(j0,30),z(),wt&&!jt?e.appendChild(L):r.parentNode.insertBefore(L,wt?jt:r),It&&ph(It,0,Vt-It.scrollTop),$t=L.parentNode,dt!==void 0&&!Eo&&(Lo=Math.abs(dt-Xt(r)[Jt])),B(),N(!0)}if(e.contains(L))return N(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){gt(document,"mousemove",this._onTouchMove),gt(document,"touchmove",this._onTouchMove),gt(document,"pointermove",this._onTouchMove),gt(document,"dragover",Zn),gt(document,"mousemove",Zn),gt(document,"touchmove",Zn)},_offUpEvents:function(){var n=this.el.ownerDocument;gt(n,"mouseup",this._onDrop),gt(n,"touchend",this._onDrop),gt(n,"pointerup",this._onDrop),gt(n,"touchcancel",this._onDrop),gt(document,"selectstart",this)},_onDrop:function(n){var e=this.el,r=this.options;if(Re=He(L),Nn=He(L,r.draggable),be("drop",this,{evt:n}),$t=L&&L.parentNode,Re=He(L),Nn=He(L,r.draggable),K.eventCanceled){this._nulling();return}Ci=!1,Eo=!1,br=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ua(this.cloneId),Ua(this._dragStartId),this.nativeDraggable&&(gt(document,"drop",this),gt(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),pr&&V(document.body,"user-select",""),V(L,"transform",""),n&&(ar&&(n.cancelable&&n.preventDefault(),!r.dropBubble&&n.stopPropagation()),j&&j.parentNode&&j.parentNode.removeChild(j),(Rt===$t||ne&&ne.lastPutMode!=="clone")&&Lt&&Lt.parentNode&&Lt.parentNode.removeChild(Lt),L&&(this.nativeDraggable&&gt(L,"dragend",this),Aa(L),L.style["will-change"]="",ar&&!Ci&&De(L,ne?ne.options.ghostClass:this.options.ghostClass,!1),De(L,this.options.chosenClass,!1),de({sortable:this,name:"unchoose",toEl:$t,newIndex:null,newDraggableIndex:null,originalEvent:n}),Rt!==$t?(Re>=0&&(de({rootEl:$t,name:"add",toEl:$t,fromEl:Rt,originalEvent:n}),de({sortable:this,name:"remove",toEl:$t,originalEvent:n}),de({rootEl:$t,name:"sort",toEl:$t,fromEl:Rt,originalEvent:n}),de({sortable:this,name:"sort",toEl:$t,originalEvent:n})),ne&&ne.save()):Re!==Ai&&Re>=0&&(de({sortable:this,name:"update",toEl:$t,originalEvent:n}),de({sortable:this,name:"sort",toEl:$t,originalEvent:n})),K.active&&((Re==null||Re===-1)&&(Re=Ai,Nn=vr),de({sortable:this,name:"end",toEl:$t,originalEvent:n}),this.save()))),this._nulling()},_nulling:function(){be("nulling",this),Rt=L=$t=j=jn=Lt=No=Fn=Kn=Ke=ar=Re=Nn=Ai=vr=_i=yr=ne=So=K.dragged=K.ghost=K.clone=K.active=null,qo.forEach(function(n){n.checked=!0}),qo.length=xa=Ca=0},handleEvent:function(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":L&&(this._onDragOver(n),J0(n));break;case"selectstart":n.preventDefault();break}},toArray:function(){for(var n=[],e,r=this.el.children,a=0,l=r.length,u=this.options;a<l;a++)e=r[a],Je(e,u.draggable,this.el,!1)&&n.push(e.getAttribute(u.dataIdAttr)||rb(e));return n},sort:function(n,e){var r={},a=this.el;this.toArray().forEach(function(l,u){var h=a.children[u];Je(h,this.options.draggable,a,!1)&&(r[l]=h)},this),e&&this.captureAnimationState(),n.forEach(function(l){r[l]&&(a.removeChild(r[l]),a.appendChild(r[l]))}),e&&this.animateAll()},save:function(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function(n,e){return Je(n,e||this.options.draggable,this.el,!1)},option:function(n,e){var r=this.options;if(e===void 0)return r[n];var a=Tr.modifyOption(this,n,e);typeof a<"u"?r[n]=a:r[n]=e,n==="group"&&wh(r)},destroy:function(){be("destroy",this);var n=this.el;n[Oe]=null,gt(n,"mousedown",this._onTapStart),gt(n,"touchstart",this._onTapStart),gt(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(gt(n,"dragover",this),gt(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Yo.splice(Yo.indexOf(this.el),1),this.el=n=null},_hideClone:function(){if(!Fn){if(be("hideClone",this),K.eventCanceled)return;V(Lt,"display","none"),this.options.removeCloneOnHide&&Lt.parentNode&&Lt.parentNode.removeChild(Lt),Fn=!0}},_showClone:function(n){if(n.lastPutMode!=="clone"){this._hideClone();return}if(Fn){if(be("showClone",this),K.eventCanceled)return;L.parentNode==Rt&&!this.options.group.revertClone?Rt.insertBefore(Lt,L):jn?Rt.insertBefore(Lt,jn):Rt.appendChild(Lt),this.options.group.revertClone&&this.animate(L,Lt),V(Lt,"display",""),Fn=!1}}};function J0(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}function Co(o,n,e,r,a,l,u,h){var f,g=o[Oe],v=g.options.onMove,y;return window.CustomEvent&&!En&&!Cr?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=n,f.from=o,f.dragged=e,f.draggedRect=r,f.related=a||n,f.relatedRect=l||Xt(n),f.willInsertAfter=h,f.originalEvent=u,o.dispatchEvent(f),v&&(y=v.call(g,f,u)),y}function Aa(o){o.draggable=!1}function j0(){Ha=!1}function tb(o,n,e){var r=Xt(Mi(e.el,0,e.options,!0)),a=vh(e.el,e.options,j),l=10;return n?o.clientX<a.left-l||o.clientY<r.top&&o.clientX<r.right:o.clientY<a.top-l||o.clientY<r.bottom&&o.clientX<r.left}function eb(o,n,e){var r=Xt(tl(e.el,e.options.draggable)),a=vh(e.el,e.options,j),l=10;return n?o.clientX>a.right+l||o.clientY>r.bottom&&o.clientX>r.left:o.clientY>a.bottom+l||o.clientX>r.right&&o.clientY>r.top}function nb(o,n,e,r,a,l,u,h){var f=r?o.clientY:o.clientX,g=r?e.height:e.width,v=r?e.top:e.left,y=r?e.bottom:e.right,S=!1;if(!u){if(h&&Lo<g*a){if(!br&&(yr===1?f>v+g*l/2:f<y-g*l/2)&&(br=!0),br)S=!0;else if(yr===1?f<v+Lo:f>y-Lo)return-yr}else if(f>v+g*(1-a)/2&&f<y-g*(1-a)/2)return ib(n)}return S=S||u,S&&(f<v+g*l/2||f>y-g*l/2)?f>v+g/2?1:-1:0}function ib(o){return He(L)<He(o)?1:-1}function rb(o){for(var n=o.tagName+o.className+o.src+o.href+o.textContent,e=n.length,r=0;e--;)r+=n.charCodeAt(e);return r.toString(36)}function ob(o){qo.length=0;for(var n=o.getElementsByTagName("input"),e=n.length;e--;){var r=n[e];r.checked&&qo.push(r)}}function Fo(o){return setTimeout(o,0)}function Ua(o){return clearTimeout(o)}jo&&vt(document,"touchmove",function(o){(K.active||Ci)&&o.cancelable&&o.preventDefault()});K.utils={on:vt,off:gt,css:V,find:dh,is:function(n,e){return!!Je(n,e,n,!1)},extend:W0,throttle:gh,closest:Je,toggleClass:De,clone:mh,index:He,nextTick:Fo,cancelNextTick:Ua,detectDirection:bh,getChild:Mi};K.get=function(o){return o[Oe]};K.mount=function(){for(var o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];n[0].constructor===Array&&(n=n[0]),n.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(K.utils=an(an({},K.utils),r.utils)),Tr.mount(r)})};K.create=function(o,n){return new K(o,n)};K.version=$0;var Ut=[],lr,Ga,Ya=!1,Ia,Da,Xo,ur;function sb(){function o(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this))}return o.prototype={dragStarted:function(e){var r=e.originalEvent;this.sortable.nativeDraggable?vt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?vt(document,"pointermove",this._handleFallbackAutoScroll):r.touches?vt(document,"touchmove",this._handleFallbackAutoScroll):vt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var r=e.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?gt(document,"dragover",this._handleAutoScroll):(gt(document,"pointermove",this._handleFallbackAutoScroll),gt(document,"touchmove",this._handleFallbackAutoScroll),gt(document,"mousemove",this._handleFallbackAutoScroll)),Kc(),ko(),H0()},nulling:function(){Xo=Ga=lr=Ya=ur=Ia=Da=null,Ut.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,r){var a=this,l=(e.touches?e.touches[0]:e).clientX,u=(e.touches?e.touches[0]:e).clientY,h=document.elementFromPoint(l,u);if(Xo=e,r||this.options.forceAutoScrollFallback||Cr||En||pr){Pa(e,this.options,h,r);var f=$n(h,!0);Ya&&(!ur||l!==Ia||u!==Da)&&(ur&&Kc(),ur=setInterval(function(){var g=$n(document.elementFromPoint(l,u),!0);g!==f&&(f=g,ko()),Pa(e,a.options,g,r)},10),Ia=l,Da=u)}else{if(!this.options.bubbleScroll||$n(h,!0)===on()){ko();return}Pa(e,this.options,$n(h,!1),!1)}}},Sn(o,{pluginName:"scroll",initializeByDefault:!0})}function ko(){Ut.forEach(function(o){clearInterval(o.pid)}),Ut=[]}function Kc(){clearInterval(ur)}var Pa=gh(function(o,n,e,r){if(n.scroll){var a=(o.touches?o.touches[0]:o).clientX,l=(o.touches?o.touches[0]:o).clientY,u=n.scrollSensitivity,h=n.scrollSpeed,f=on(),g=!1,v;Ga!==e&&(Ga=e,ko(),lr=n.scroll,v=n.scrollFn,lr===!0&&(lr=$n(e,!0)));var y=0,S=lr;do{var C=S,A=Xt(C),R=A.top,M=A.bottom,z=A.left,N=A.right,B=A.width,G=A.height,ft=void 0,ut=void 0,dt=C.scrollWidth,xt=C.scrollHeight,nt=V(C),Jt=C.scrollLeft,It=C.scrollTop;C===f?(ft=B<dt&&(nt.overflowX==="auto"||nt.overflowX==="scroll"||nt.overflowX==="visible"),ut=G<xt&&(nt.overflowY==="auto"||nt.overflowY==="scroll"||nt.overflowY==="visible")):(ft=B<dt&&(nt.overflowX==="auto"||nt.overflowX==="scroll"),ut=G<xt&&(nt.overflowY==="auto"||nt.overflowY==="scroll"));var Vt=ft&&(Math.abs(N-a)<=u&&Jt+B<dt)-(Math.abs(z-a)<=u&&!!Jt),Dt=ut&&(Math.abs(M-l)<=u&&It+G<xt)-(Math.abs(R-l)<=u&&!!It);if(!Ut[y])for(var Ot=0;Ot<=y;Ot++)Ut[Ot]||(Ut[Ot]={});(Ut[y].vx!=Vt||Ut[y].vy!=Dt||Ut[y].el!==C)&&(Ut[y].el=C,Ut[y].vx=Vt,Ut[y].vy=Dt,clearInterval(Ut[y].pid),(Vt!=0||Dt!=0)&&(g=!0,Ut[y].pid=setInterval((function(){r&&this.layer===0&&K.active._onTouchMove(Xo);var jt=Ut[this.layer].vy?Ut[this.layer].vy*h:0,wt=Ut[this.layer].vx?Ut[this.layer].vx*h:0;typeof v=="function"&&v.call(K.dragged.parentNode[Oe],wt,jt,o,Xo,Ut[this.layer].el)!=="continue"||ph(Ut[this.layer].el,wt,jt)}).bind({layer:y}),24))),y++}while(n.bubbleScroll&&S!==f&&(S=$n(S,!1)));Ya=g}},30),Eh=function(n){var e=n.originalEvent,r=n.putSortable,a=n.dragEl,l=n.activeSortable,u=n.dispatchSortableEvent,h=n.hideGhostForTarget,f=n.unhideGhostForTarget;if(e){var g=r||l;h();var v=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,y=document.elementFromPoint(v.clientX,v.clientY);f(),g&&!g.el.contains(y)&&(u("spill"),this.onSpill({dragEl:a,putSortable:r}))}};function el(){}el.prototype={startIndex:null,dragStart:function(n){var e=n.oldDraggableIndex;this.startIndex=e},onSpill:function(n){var e=n.dragEl,r=n.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var a=Mi(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(e,a):this.sortable.el.appendChild(e),this.sortable.animateAll(),r&&r.animateAll()},drop:Eh};Sn(el,{pluginName:"revertOnSpill"});function nl(){}nl.prototype={onSpill:function(n){var e=n.dragEl,r=n.putSortable,a=r||this.sortable;a.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),a.animateAll()},drop:Eh};Sn(nl,{pluginName:"removeOnSpill"});K.mount(new sb);K.mount(nl,el);var ab=K;function lb(o){o.directive("sort",(n,{value:e,modifiers:r,expression:a},{effect:l,evaluate:u,evaluateLater:h,cleanup:f})=>{if(e==="config"||e==="handle"||e==="group")return;if(e==="key"||e==="item"){if([void 0,null,""].includes(a))return;n._x_sort_key=u(a);return}let g={hideGhost:!r.includes("ghost"),useHandles:!!n.querySelector("[x-sort\\:handle]"),group:db(n,r)},v=ub(a,h),y=cb(n,r,u),S=hb(n,y,g,(C,A)=>{v(C,A)});f(()=>S.destroy())})}function ub(o,n){if([void 0,null,""].includes(o))return()=>{};let e=n(o);return(r,a)=>{Alpine.dontAutoEvaluateFunctions(()=>{e(l=>{typeof l=="function"&&l(r,a)},{scope:{$key:r,$item:r,$position:a}})})}}function cb(o,n,e){return o.hasAttribute("x-sort:config")?e(o.getAttribute("x-sort:config")):{}}function hb(o,n,e,r){let a,l={animation:150,handle:e.useHandles?"[x-sort\\:handle]":null,group:e.group,filter(u){return o.querySelector("[x-sort\\:item]")?!u.target.closest("[x-sort\\:item]"):!1},onSort(u){if(u.from!==u.to&&u.to!==u.target)return;let h=u.item._x_sort_key,f=u.newIndex;(h!==void 0||h!==null)&&r(h,f)},onStart(){document.body.classList.add("sorting"),a=document.querySelector(".sortable-ghost"),e.hideGhost&&a&&(a.style.opacity="0")},onEnd(){document.body.classList.remove("sorting"),e.hideGhost&&a&&(a.style.opacity="1"),a=void 0,fb(o)}};return new ab(o,{...l,...n})}function fb(o){let n=o.firstChild;for(;n.nextSibling;){if(n.textContent.trim()==="[if ENDBLOCK]><![endif]"){o.append(n);break}n=n.nextSibling}}function db(o,n){return o.hasAttribute("x-sort:group")?o.getAttribute("x-sort:group"):n.indexOf("group")!==-1?n[n.indexOf("group")+1]:null}var Sw=lb;/*! Bundled license information:

sortablejs/modular/sortable.esm.js:
  (**!
   * Sortable 1.15.2
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   *)
*/function gb(o){o.directive("intersect",o.skipDuringClone((n,{value:e,expression:r,modifiers:a},{evaluateLater:l,cleanup:u})=>{let h=l(r),f={rootMargin:vb(a),threshold:pb(a)},g=new IntersectionObserver(v=>{v.forEach(y=>{y.isIntersecting!==(e==="leave")&&(h(),a.includes("once")&&g.disconnect())})},f);g.observe(n),u(()=>{g.disconnect()})}))}function pb(o){if(o.includes("full"))return .99;if(o.includes("half"))return .5;if(!o.includes("threshold"))return 0;let n=o[o.indexOf("threshold")+1];return n==="100"?1:n==="0"?0:+`.${n}`}function mb(o){let n=o.match(/^(-?[0-9]+)(px|%)?$/);return n?n[1]+(n[2]||"px"):void 0}function vb(o){const n="margin",e="0px 0px 0px 0px",r=o.indexOf(n);if(r===-1)return e;let a=[];for(let l=1;l<5;l++)a.push(mb(o[r+l]||""));return a=a.filter(l=>l!==void 0),a.length?a.join(" ").trim():e}var Ew=gb;/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Zc(o,n){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);n&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),e.push.apply(e,r)}return e}function ln(o){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?Zc(Object(e),!0).forEach(function(r){yb(o,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):Zc(Object(e)).forEach(function(r){Object.defineProperty(o,r,Object.getOwnPropertyDescriptor(e,r))})}return o}function $o(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$o=function(n){return typeof n}:$o=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$o(o)}function yb(o,n,e){return n in o?Object.defineProperty(o,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[n]=e,o}function je(){return je=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r])}return o},je.apply(this,arguments)}function bb(o,n){if(o==null)return{};var e={},r=Object.keys(o),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(e[a]=o[a]);return e}function wb(o,n){if(o==null)return{};var e=bb(o,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(o);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(o,r)&&(e[r]=o[r])}return e}function _b(o){return Sb(o)||Eb(o)||xb(o)||Cb()}function Sb(o){if(Array.isArray(o))return qa(o)}function Eb(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function xb(o,n){if(o){if(typeof o=="string")return qa(o,n);var e=Object.prototype.toString.call(o).slice(8,-1);if(e==="Object"&&o.constructor&&(e=o.constructor.name),e==="Map"||e==="Set")return Array.from(o);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return qa(o,n)}}function qa(o,n){(n==null||n>o.length)&&(n=o.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=o[e];return r}function Cb(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Tb="1.15.6";function _n(o){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(o)}var xn=_n(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ar=_n(/Edge/i),Qc=_n(/firefox/i),wr=_n(/safari/i)&&!_n(/chrome/i)&&!_n(/android/i),il=_n(/iP(ad|od|hone)/i),xh=_n(/chrome/i)&&_n(/android/i),Ch={capture:!1,passive:!1};function st(o,n,e){o.addEventListener(n,e,!xn&&Ch)}function rt(o,n,e){o.removeEventListener(n,e,!xn&&Ch)}function Vo(o,n){if(n){if(n[0]===">"&&(n=n.substring(1)),o)try{if(o.matches)return o.matches(n);if(o.msMatchesSelector)return o.msMatchesSelector(n);if(o.webkitMatchesSelector)return o.webkitMatchesSelector(n)}catch{return!1}return!1}}function Th(o){return o.host&&o!==document&&o.host.nodeType?o.host:o.parentNode}function Se(o,n,e,r){if(o){e=e||document;do{if(n!=null&&(n[0]===">"?o.parentNode===e&&Vo(o,n):Vo(o,n))||r&&o===e)return o;if(o===e)break}while(o=Th(o))}return null}var Jc=/\s+/g;function Yt(o,n,e){if(o&&n)if(o.classList)o.classList[e?"add":"remove"](n);else{var r=(" "+o.className+" ").replace(Jc," ").replace(" "+n+" "," ");o.className=(r+(e?" "+n:"")).replace(Jc," ")}}function H(o,n,e){var r=o&&o.style;if(r){if(e===void 0)return document.defaultView&&document.defaultView.getComputedStyle?e=document.defaultView.getComputedStyle(o,""):o.currentStyle&&(e=o.currentStyle),n===void 0?e:e[n];!(n in r)&&n.indexOf("webkit")===-1&&(n="-webkit-"+n),r[n]=e+(typeof e=="string"?"":"px")}}function ni(o,n){var e="";if(typeof o=="string")e=o;else do{var r=H(o,"transform");r&&r!=="none"&&(e=r+" "+e)}while(!n&&(o=o.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(e)}function Ah(o,n,e){if(o){var r=o.getElementsByTagName(n),a=0,l=r.length;if(e)for(;a<l;a++)e(r[a],a);return r}return[]}function sn(){var o=document.scrollingElement;return o||document.documentElement}function At(o,n,e,r,a){if(!(!o.getBoundingClientRect&&o!==window)){var l,u,h,f,g,v,y;if(o!==window&&o.parentNode&&o!==sn()?(l=o.getBoundingClientRect(),u=l.top,h=l.left,f=l.bottom,g=l.right,v=l.height,y=l.width):(u=0,h=0,f=window.innerHeight,g=window.innerWidth,v=window.innerHeight,y=window.innerWidth),(n||e)&&o!==window&&(a=a||o.parentNode,!xn))do if(a&&a.getBoundingClientRect&&(H(a,"transform")!=="none"||e&&H(a,"position")!=="static")){var S=a.getBoundingClientRect();u-=S.top+parseInt(H(a,"border-top-width")),h-=S.left+parseInt(H(a,"border-left-width")),f=u+l.height,g=h+l.width;break}while(a=a.parentNode);if(r&&o!==window){var C=ni(a||o),A=C&&C.a,R=C&&C.d;C&&(u/=R,h/=A,y/=A,v/=R,f=u+v,g=h+y)}return{top:u,left:h,bottom:f,right:g,width:y,height:v}}}function jc(o,n,e){for(var r=Bn(o,!0),a=At(o)[n];r;){var l=At(r)[e],u=void 0;if(u=a>=l,!u)return r;if(r===sn())break;r=Bn(r,!1)}return!1}function Oi(o,n,e,r){for(var a=0,l=0,u=o.children;l<u.length;){if(u[l].style.display!=="none"&&u[l]!==Z.ghost&&(r||u[l]!==Z.dragged)&&Se(u[l],e.draggable,o,!1)){if(a===n)return u[l];a++}l++}return null}function rl(o,n){for(var e=o.lastElementChild;e&&(e===Z.ghost||H(e,"display")==="none"||n&&!Vo(e,n));)e=e.previousElementSibling;return e||null}function qt(o,n){var e=0;if(!o||!o.parentNode)return-1;for(;o=o.previousElementSibling;)o.nodeName.toUpperCase()!=="TEMPLATE"&&o!==Z.clone&&(!n||Vo(o,n))&&e++;return e}function th(o){var n=0,e=0,r=sn();if(o)do{var a=ni(o),l=a.a,u=a.d;n+=o.scrollLeft*l,e+=o.scrollTop*u}while(o!==r&&(o=o.parentNode));return[n,e]}function Ab(o,n){for(var e in o)if(o.hasOwnProperty(e)){for(var r in n)if(n.hasOwnProperty(r)&&n[r]===o[e][r])return Number(e)}return-1}function Bn(o,n){if(!o||!o.getBoundingClientRect)return sn();var e=o,r=!1;do if(e.clientWidth<e.scrollWidth||e.clientHeight<e.scrollHeight){var a=H(e);if(e.clientWidth<e.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||e.clientHeight<e.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!e.getBoundingClientRect||e===document.body)return sn();if(r||n)return e;r=!0}}while(e=e.parentNode);return sn()}function Ib(o,n){if(o&&n)for(var e in n)n.hasOwnProperty(e)&&(o[e]=n[e]);return o}function Ra(o,n){return Math.round(o.top)===Math.round(n.top)&&Math.round(o.left)===Math.round(n.left)&&Math.round(o.height)===Math.round(n.height)&&Math.round(o.width)===Math.round(n.width)}var _r;function Ih(o,n){return function(){if(!_r){var e=arguments,r=this;e.length===1?o.call(r,e[0]):o.apply(r,e),_r=setTimeout(function(){_r=void 0},n)}}}function Db(){clearTimeout(_r),_r=void 0}function Dh(o,n,e){o.scrollLeft+=n,o.scrollTop+=e}function ol(o){var n=window.Polymer,e=window.jQuery||window.Zepto;return n&&n.dom?n.dom(o).cloneNode(!0):e?e(o).clone(!0)[0]:o.cloneNode(!0)}function eh(o,n){H(o,"position","absolute"),H(o,"top",n.top),H(o,"left",n.left),H(o,"width",n.width),H(o,"height",n.height)}function Ma(o){H(o,"position",""),H(o,"top",""),H(o,"left",""),H(o,"width",""),H(o,"height","")}function Ph(o,n,e){var r={};return Array.from(o.children).forEach(function(a){var l,u,h,f;if(!(!Se(a,n.draggable,o,!1)||a.animated||a===e)){var g=At(a);r.left=Math.min((l=r.left)!==null&&l!==void 0?l:1/0,g.left),r.top=Math.min((u=r.top)!==null&&u!==void 0?u:1/0,g.top),r.right=Math.max((h=r.right)!==null&&h!==void 0?h:-1/0,g.right),r.bottom=Math.max((f=r.bottom)!==null&&f!==void 0?f:-1/0,g.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var re="Sortable"+new Date().getTime();function Pb(){var o=[],n;return{captureAnimationState:function(){if(o=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(a){if(!(H(a,"display")==="none"||a===Z.ghost)){o.push({target:a,rect:At(a)});var l=ln({},o[o.length-1].rect);if(a.thisAnimationDuration){var u=ni(a,!0);u&&(l.top-=u.f,l.left-=u.e)}a.fromRect=l}})}},addAnimationState:function(r){o.push(r)},removeAnimationState:function(r){o.splice(Ab(o,{target:r}),1)},animateAll:function(r){var a=this;if(!this.options.animation){clearTimeout(n),typeof r=="function"&&r();return}var l=!1,u=0;o.forEach(function(h){var f=0,g=h.target,v=g.fromRect,y=At(g),S=g.prevFromRect,C=g.prevToRect,A=h.rect,R=ni(g,!0);R&&(y.top-=R.f,y.left-=R.e),g.toRect=y,g.thisAnimationDuration&&Ra(S,y)&&!Ra(v,y)&&(A.top-y.top)/(A.left-y.left)===(v.top-y.top)/(v.left-y.left)&&(f=Mb(A,S,C,a.options)),Ra(y,v)||(g.prevFromRect=v,g.prevToRect=y,f||(f=a.options.animation),a.animate(g,A,y,f)),f&&(l=!0,u=Math.max(u,f),clearTimeout(g.animationResetTimer),g.animationResetTimer=setTimeout(function(){g.animationTime=0,g.prevFromRect=null,g.fromRect=null,g.prevToRect=null,g.thisAnimationDuration=null},f),g.thisAnimationDuration=f)}),clearTimeout(n),l?n=setTimeout(function(){typeof r=="function"&&r()},u):typeof r=="function"&&r(),o=[]},animate:function(r,a,l,u){if(u){H(r,"transition",""),H(r,"transform","");var h=ni(this.el),f=h&&h.a,g=h&&h.d,v=(a.left-l.left)/(f||1),y=(a.top-l.top)/(g||1);r.animatingX=!!v,r.animatingY=!!y,H(r,"transform","translate3d("+v+"px,"+y+"px,0)"),this.forRepaintDummy=Rb(r),H(r,"transition","transform "+u+"ms"+(this.options.easing?" "+this.options.easing:"")),H(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){H(r,"transition",""),H(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},u)}}}}function Rb(o){return o.offsetWidth}function Mb(o,n,e,r){return Math.sqrt(Math.pow(n.top-o.top,2)+Math.pow(n.left-o.left,2))/Math.sqrt(Math.pow(n.top-e.top,2)+Math.pow(n.left-e.left,2))*r.animation}var Si=[],Oa={initializeByDefault:!0},Ir={mount:function(n){for(var e in Oa)Oa.hasOwnProperty(e)&&!(e in n)&&(n[e]=Oa[e]);Si.forEach(function(r){if(r.pluginName===n.pluginName)throw"Sortable: Cannot mount plugin ".concat(n.pluginName," more than once")}),Si.push(n)},pluginEvent:function(n,e,r){var a=this;this.eventCanceled=!1,r.cancel=function(){a.eventCanceled=!0};var l=n+"Global";Si.forEach(function(u){e[u.pluginName]&&(e[u.pluginName][l]&&e[u.pluginName][l](ln({sortable:e},r)),e.options[u.pluginName]&&e[u.pluginName][n]&&e[u.pluginName][n](ln({sortable:e},r)))})},initializePlugins:function(n,e,r,a){Si.forEach(function(h){var f=h.pluginName;if(!(!n.options[f]&&!h.initializeByDefault)){var g=new h(n,e,n.options);g.sortable=n,g.options=n.options,n[f]=g,je(r,g.defaults)}});for(var l in n.options)if(n.options.hasOwnProperty(l)){var u=this.modifyOption(n,l,n.options[l]);typeof u<"u"&&(n.options[l]=u)}},getEventProperties:function(n,e){var r={};return Si.forEach(function(a){typeof a.eventProperties=="function"&&je(r,a.eventProperties.call(e[a.pluginName],n))}),r},modifyOption:function(n,e,r){var a;return Si.forEach(function(l){n[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[e]=="function"&&(a=l.optionListeners[e].call(n[l.pluginName],r))}),a}};function cr(o){var n=o.sortable,e=o.rootEl,r=o.name,a=o.targetEl,l=o.cloneEl,u=o.toEl,h=o.fromEl,f=o.oldIndex,g=o.newIndex,v=o.oldDraggableIndex,y=o.newDraggableIndex,S=o.originalEvent,C=o.putSortable,A=o.extraEventProperties;if(n=n||e&&e[re],!!n){var R,M=n.options,z="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!xn&&!Ar?R=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(R=document.createEvent("Event"),R.initEvent(r,!0,!0)),R.to=u||e,R.from=h||e,R.item=a||e,R.clone=l,R.oldIndex=f,R.newIndex=g,R.oldDraggableIndex=v,R.newDraggableIndex=y,R.originalEvent=S,R.pullMode=C?C.lastPutMode:void 0;var N=ln(ln({},A),Ir.getEventProperties(r,n));for(var B in N)R[B]=N[B];e&&e.dispatchEvent(R),M[z]&&M[z].call(n,R)}}var Ob=["evt"],we=function(n,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=r.evt,l=wb(r,Ob);Ir.pluginEvent.bind(Z)(n,e,ln({dragEl:F,parentEl:Bt,ghostEl:tt,rootEl:Mt,nextEl:ti,lastDownEl:Bo,cloneEl:Ft,cloneHidden:kn,dragStarted:hr,putSortable:ie,activeSortable:Z.active,originalEvent:a,oldIndex:Ii,oldDraggableIndex:Sr,newIndex:Me,newDraggableIndex:Ln,hideGhostForTarget:Nh,unhideGhostForTarget:Lh,cloneNowHidden:function(){kn=!0},cloneNowShown:function(){kn=!1},dispatchSortableEvent:function(h){ge({sortable:e,name:h,originalEvent:a})}},l))};function ge(o){cr(ln({putSortable:ie,cloneEl:Ft,targetEl:F,rootEl:Mt,oldIndex:Ii,oldDraggableIndex:Sr,newIndex:Me,newDraggableIndex:Ln},o))}var F,Bt,tt,Mt,ti,Bo,Ft,kn,Ii,Me,Sr,Ln,To,ie,Ti=!1,Ko=!1,Zo=[],Qn,Ze,Na,La,nh,ih,hr,Ei,Er,xr=!1,Ao=!1,zo,ue,Fa=[],Xa=!1,Qo=[],ts=typeof document<"u",Io=il,rh=Ar||xn?"cssFloat":"float",Nb=ts&&!xh&&!il&&"draggable"in document.createElement("div"),Rh=function(){if(ts){if(xn)return!1;var o=document.createElement("x");return o.style.cssText="pointer-events:auto",o.style.pointerEvents==="auto"}}(),Mh=function(n,e){var r=H(n),a=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),l=Oi(n,0,e),u=Oi(n,1,e),h=l&&H(l),f=u&&H(u),g=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+At(l).width,v=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+At(u).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&h.float&&h.float!=="none"){var y=h.float==="left"?"left":"right";return u&&(f.clear==="both"||f.clear===y)?"vertical":"horizontal"}return l&&(h.display==="block"||h.display==="flex"||h.display==="table"||h.display==="grid"||g>=a&&r[rh]==="none"||u&&r[rh]==="none"&&g+v>a)?"vertical":"horizontal"},Lb=function(n,e,r){var a=r?n.left:n.top,l=r?n.right:n.bottom,u=r?n.width:n.height,h=r?e.left:e.top,f=r?e.right:e.bottom,g=r?e.width:e.height;return a===h||l===f||a+u/2===h+g/2},Fb=function(n,e){var r;return Zo.some(function(a){var l=a[re].options.emptyInsertThreshold;if(!(!l||rl(a))){var u=At(a),h=n>=u.left-l&&n<=u.right+l,f=e>=u.top-l&&e<=u.bottom+l;if(h&&f)return r=a}}),r},Oh=function(n){function e(l,u){return function(h,f,g,v){var y=h.options.group.name&&f.options.group.name&&h.options.group.name===f.options.group.name;if(l==null&&(u||y))return!0;if(l==null||l===!1)return!1;if(u&&l==="clone")return l;if(typeof l=="function")return e(l(h,f,g,v),u)(h,f,g,v);var S=(u?h:f).options.group.name;return l===!0||typeof l=="string"&&l===S||l.join&&l.indexOf(S)>-1}}var r={},a=n.group;(!a||$o(a)!="object")&&(a={name:a}),r.name=a.name,r.checkPull=e(a.pull,!0),r.checkPut=e(a.put),r.revertClone=a.revertClone,n.group=r},Nh=function(){!Rh&&tt&&H(tt,"display","none")},Lh=function(){!Rh&&tt&&H(tt,"display","")};ts&&!xh&&document.addEventListener("click",function(o){if(Ko)return o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.stopImmediatePropagation&&o.stopImmediatePropagation(),Ko=!1,!1},!0);var Jn=function(n){if(F){n=n.touches?n.touches[0]:n;var e=Fb(n.clientX,n.clientY);if(e){var r={};for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a]);r.target=r.rootEl=e,r.preventDefault=void 0,r.stopPropagation=void 0,e[re]._onDragOver(r)}}},kb=function(n){F&&F.parentNode[re]._isOutsideThisEl(n.target)};function Z(o,n){if(!(o&&o.nodeType&&o.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(o));this.el=o,this.options=n=je({},n),o[re]=this;var e={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(o.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Mh(o,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(u,h){u.setData("Text",h.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Z.supportPointer!==!1&&"PointerEvent"in window&&(!wr||il),emptyInsertThreshold:5};Ir.initializePlugins(this,o,e);for(var r in e)!(r in n)&&(n[r]=e[r]);Oh(n);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=n.forceFallback?!1:Nb,this.nativeDraggable&&(this.options.touchStartThreshold=1),n.supportPointer?st(o,"pointerdown",this._onTapStart):(st(o,"mousedown",this._onTapStart),st(o,"touchstart",this._onTapStart)),this.nativeDraggable&&(st(o,"dragover",this),st(o,"dragenter",this)),Zo.push(this.el),n.store&&n.store.get&&this.sort(n.store.get(this)||[]),je(this,Pb())}Z.prototype={constructor:Z,_isOutsideThisEl:function(n){!this.el.contains(n)&&n!==this.el&&(Ei=null)},_getDirection:function(n,e){return typeof this.options.direction=="function"?this.options.direction.call(this,n,e,F):this.options.direction},_onTapStart:function(n){if(n.cancelable){var e=this,r=this.el,a=this.options,l=a.preventOnFilter,u=n.type,h=n.touches&&n.touches[0]||n.pointerType&&n.pointerType==="touch"&&n,f=(h||n).target,g=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||f,v=a.filter;if(Yb(r),!F&&!(/mousedown|pointerdown/.test(u)&&n.button!==0||a.disabled)&&!g.isContentEditable&&!(!this.nativeDraggable&&wr&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=Se(f,a.draggable,r,!1),!(f&&f.animated)&&Bo!==f)){if(Ii=qt(f),Sr=qt(f,a.draggable),typeof v=="function"){if(v.call(this,n,f,this)){ge({sortable:e,rootEl:g,name:"filter",targetEl:f,toEl:r,fromEl:r}),we("filter",e,{evt:n}),l&&n.preventDefault();return}}else if(v&&(v=v.split(",").some(function(y){if(y=Se(g,y.trim(),r,!1),y)return ge({sortable:e,rootEl:y,name:"filter",targetEl:f,fromEl:r,toEl:r}),we("filter",e,{evt:n}),!0}),v)){l&&n.preventDefault();return}a.handle&&!Se(g,a.handle,r,!1)||this._prepareDragStart(n,h,f)}}},_prepareDragStart:function(n,e,r){var a=this,l=a.el,u=a.options,h=l.ownerDocument,f;if(r&&!F&&r.parentNode===l){var g=At(r);if(Mt=l,F=r,Bt=F.parentNode,ti=F.nextSibling,Bo=r,To=u.group,Z.dragged=F,Qn={target:F,clientX:(e||n).clientX,clientY:(e||n).clientY},nh=Qn.clientX-g.left,ih=Qn.clientY-g.top,this._lastX=(e||n).clientX,this._lastY=(e||n).clientY,F.style["will-change"]="all",f=function(){if(we("delayEnded",a,{evt:n}),Z.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Qc&&a.nativeDraggable&&(F.draggable=!0),a._triggerDragStart(n,e),ge({sortable:a,name:"choose",originalEvent:n}),Yt(F,u.chosenClass,!0)},u.ignore.split(",").forEach(function(v){Ah(F,v.trim(),ka)}),st(h,"dragover",Jn),st(h,"mousemove",Jn),st(h,"touchmove",Jn),u.supportPointer?(st(h,"pointerup",a._onDrop),!this.nativeDraggable&&st(h,"pointercancel",a._onDrop)):(st(h,"mouseup",a._onDrop),st(h,"touchend",a._onDrop),st(h,"touchcancel",a._onDrop)),Qc&&this.nativeDraggable&&(this.options.touchStartThreshold=4,F.draggable=!0),we("delayStart",this,{evt:n}),u.delay&&(!u.delayOnTouchOnly||e)&&(!this.nativeDraggable||!(Ar||xn))){if(Z.eventCanceled){this._onDrop();return}u.supportPointer?(st(h,"pointerup",a._disableDelayedDrag),st(h,"pointercancel",a._disableDelayedDrag)):(st(h,"mouseup",a._disableDelayedDrag),st(h,"touchend",a._disableDelayedDrag),st(h,"touchcancel",a._disableDelayedDrag)),st(h,"mousemove",a._delayedDragTouchMoveHandler),st(h,"touchmove",a._delayedDragTouchMoveHandler),u.supportPointer&&st(h,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(f,u.delay)}else f()}},_delayedDragTouchMoveHandler:function(n){var e=n.touches?n.touches[0]:n;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){F&&ka(F),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var n=this.el.ownerDocument;rt(n,"mouseup",this._disableDelayedDrag),rt(n,"touchend",this._disableDelayedDrag),rt(n,"touchcancel",this._disableDelayedDrag),rt(n,"pointerup",this._disableDelayedDrag),rt(n,"pointercancel",this._disableDelayedDrag),rt(n,"mousemove",this._delayedDragTouchMoveHandler),rt(n,"touchmove",this._delayedDragTouchMoveHandler),rt(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(n,e){e=e||n.pointerType=="touch"&&n,!this.nativeDraggable||e?this.options.supportPointer?st(document,"pointermove",this._onTouchMove):e?st(document,"touchmove",this._onTouchMove):st(document,"mousemove",this._onTouchMove):(st(F,"dragend",this),st(Mt,"dragstart",this._onDragStart));try{document.selection?Wo(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(n,e){if(Ti=!1,Mt&&F){we("dragStarted",this,{evt:e}),this.nativeDraggable&&st(document,"dragover",kb);var r=this.options;!n&&Yt(F,r.dragClass,!1),Yt(F,r.ghostClass,!0),Z.active=this,n&&this._appendGhost(),ge({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(Ze){this._lastX=Ze.clientX,this._lastY=Ze.clientY,Nh();for(var n=document.elementFromPoint(Ze.clientX,Ze.clientY),e=n;n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(Ze.clientX,Ze.clientY),n!==e);)e=n;if(F.parentNode[re]._isOutsideThisEl(n),e)do{if(e[re]){var r=void 0;if(r=e[re]._onDragOver({clientX:Ze.clientX,clientY:Ze.clientY,target:n,rootEl:e}),r&&!this.options.dragoverBubble)break}n=e}while(e=Th(e));Lh()}},_onTouchMove:function(n){if(Qn){var e=this.options,r=e.fallbackTolerance,a=e.fallbackOffset,l=n.touches?n.touches[0]:n,u=tt&&ni(tt,!0),h=tt&&u&&u.a,f=tt&&u&&u.d,g=Io&&ue&&th(ue),v=(l.clientX-Qn.clientX+a.x)/(h||1)+(g?g[0]-Fa[0]:0)/(h||1),y=(l.clientY-Qn.clientY+a.y)/(f||1)+(g?g[1]-Fa[1]:0)/(f||1);if(!Z.active&&!Ti){if(r&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<r)return;this._onDragStart(n,!0)}if(tt){u?(u.e+=v-(Na||0),u.f+=y-(La||0)):u={a:1,b:0,c:0,d:1,e:v,f:y};var S="matrix(".concat(u.a,",").concat(u.b,",").concat(u.c,",").concat(u.d,",").concat(u.e,",").concat(u.f,")");H(tt,"webkitTransform",S),H(tt,"mozTransform",S),H(tt,"msTransform",S),H(tt,"transform",S),Na=v,La=y,Ze=l}n.cancelable&&n.preventDefault()}},_appendGhost:function(){if(!tt){var n=this.options.fallbackOnBody?document.body:Mt,e=At(F,!0,Io,!0,n),r=this.options;if(Io){for(ue=n;H(ue,"position")==="static"&&H(ue,"transform")==="none"&&ue!==document;)ue=ue.parentNode;ue!==document.body&&ue!==document.documentElement?(ue===document&&(ue=sn()),e.top+=ue.scrollTop,e.left+=ue.scrollLeft):ue=sn(),Fa=th(ue)}tt=F.cloneNode(!0),Yt(tt,r.ghostClass,!1),Yt(tt,r.fallbackClass,!0),Yt(tt,r.dragClass,!0),H(tt,"transition",""),H(tt,"transform",""),H(tt,"box-sizing","border-box"),H(tt,"margin",0),H(tt,"top",e.top),H(tt,"left",e.left),H(tt,"width",e.width),H(tt,"height",e.height),H(tt,"opacity","0.8"),H(tt,"position",Io?"absolute":"fixed"),H(tt,"zIndex","100000"),H(tt,"pointerEvents","none"),Z.ghost=tt,n.appendChild(tt),H(tt,"transform-origin",nh/parseInt(tt.style.width)*100+"% "+ih/parseInt(tt.style.height)*100+"%")}},_onDragStart:function(n,e){var r=this,a=n.dataTransfer,l=r.options;if(we("dragStart",this,{evt:n}),Z.eventCanceled){this._onDrop();return}we("setupClone",this),Z.eventCanceled||(Ft=ol(F),Ft.removeAttribute("id"),Ft.draggable=!1,Ft.style["will-change"]="",this._hideClone(),Yt(Ft,this.options.chosenClass,!1),Z.clone=Ft),r.cloneId=Wo(function(){we("clone",r),!Z.eventCanceled&&(r.options.removeCloneOnHide||Mt.insertBefore(Ft,F),r._hideClone(),ge({sortable:r,name:"clone"}))}),!e&&Yt(F,l.dragClass,!0),e?(Ko=!0,r._loopId=setInterval(r._emulateDragOver,50)):(rt(document,"mouseup",r._onDrop),rt(document,"touchend",r._onDrop),rt(document,"touchcancel",r._onDrop),a&&(a.effectAllowed="move",l.setData&&l.setData.call(r,a,F)),st(document,"drop",r),H(F,"transform","translateZ(0)")),Ti=!0,r._dragStartId=Wo(r._dragStarted.bind(r,e,n)),st(document,"selectstart",r),hr=!0,window.getSelection().removeAllRanges(),wr&&H(document.body,"user-select","none")},_onDragOver:function(n){var e=this.el,r=n.target,a,l,u,h=this.options,f=h.group,g=Z.active,v=To===f,y=h.sort,S=ie||g,C,A=this,R=!1;if(Xa)return;function M(Ht,Ni){we(Ht,A,ln({evt:n,isOwner:v,axis:C?"vertical":"horizontal",revert:u,dragRect:a,targetRect:l,canSort:y,fromSortable:S,target:r,completed:N,onMove:function(oe,Li){return Do(Mt,e,F,a,oe,At(oe),n,Li)},changed:B},Ni))}function z(){M("dragOverAnimationCapture"),A.captureAnimationState(),A!==S&&S.captureAnimationState()}function N(Ht){return M("dragOverCompleted",{insertion:Ht}),Ht&&(v?g._hideClone():g._showClone(A),A!==S&&(Yt(F,ie?ie.options.ghostClass:g.options.ghostClass,!1),Yt(F,h.ghostClass,!0)),ie!==A&&A!==Z.active?ie=A:A===Z.active&&ie&&(ie=null),S===A&&(A._ignoreWhileAnimating=r),A.animateAll(function(){M("dragOverAnimationComplete"),A._ignoreWhileAnimating=null}),A!==S&&(S.animateAll(),S._ignoreWhileAnimating=null)),(r===F&&!F.animated||r===e&&!r.animated)&&(Ei=null),!h.dragoverBubble&&!n.rootEl&&r!==document&&(F.parentNode[re]._isOutsideThisEl(n.target),!Ht&&Jn(n)),!h.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),R=!0}function B(){Me=qt(F),Ln=qt(F,h.draggable),ge({sortable:A,name:"change",toEl:e,newIndex:Me,newDraggableIndex:Ln,originalEvent:n})}if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),r=Se(r,h.draggable,e,!0),M("dragOver"),Z.eventCanceled)return R;if(F.contains(n.target)||r.animated&&r.animatingX&&r.animatingY||A._ignoreWhileAnimating===r)return N(!1);if(Ko=!1,g&&!h.disabled&&(v?y||(u=Bt!==Mt):ie===this||(this.lastPutMode=To.checkPull(this,g,F,n))&&f.checkPut(this,g,F,n))){if(C=this._getDirection(n,r)==="vertical",a=At(F),M("dragOverValid"),Z.eventCanceled)return R;if(u)return Bt=Mt,z(),this._hideClone(),M("revert"),Z.eventCanceled||(ti?Mt.insertBefore(F,ti):Mt.appendChild(F)),N(!0);var G=rl(e,h.draggable);if(!G||Wb(n,C,this)&&!G.animated){if(G===F)return N(!1);if(G&&e===n.target&&(r=G),r&&(l=At(r)),Do(Mt,e,F,a,r,l,n,!!r)!==!1)return z(),G&&G.nextSibling?e.insertBefore(F,G.nextSibling):e.appendChild(F),Bt=e,B(),N(!0)}else if(G&&zb(n,C,this)){var ft=Oi(e,0,h,!0);if(ft===F)return N(!1);if(r=ft,l=At(r),Do(Mt,e,F,a,r,l,n,!1)!==!1)return z(),e.insertBefore(F,ft),Bt=e,B(),N(!0)}else if(r.parentNode===e){l=At(r);var ut=0,dt,xt=F.parentNode!==e,nt=!Lb(F.animated&&F.toRect||a,r.animated&&r.toRect||l,C),Jt=C?"top":"left",It=jc(r,"top","top")||jc(F,"top","top"),Vt=It?It.scrollTop:void 0;Ei!==r&&(dt=l[Jt],xr=!1,Ao=!nt&&h.invertSwap||xt),ut=Hb(n,r,l,C,nt?1:h.swapThreshold,h.invertedSwapThreshold==null?h.swapThreshold:h.invertedSwapThreshold,Ao,Ei===r);var Dt;if(ut!==0){var Ot=qt(F);do Ot-=ut,Dt=Bt.children[Ot];while(Dt&&(H(Dt,"display")==="none"||Dt===tt))}if(ut===0||Dt===r)return N(!1);Ei=r,Er=ut;var jt=r.nextElementSibling,wt=!1;wt=ut===1;var Ct=Do(Mt,e,F,a,r,l,n,wt);if(Ct!==!1)return(Ct===1||Ct===-1)&&(wt=Ct===1),Xa=!0,setTimeout(Bb,30),z(),wt&&!jt?e.appendChild(F):r.parentNode.insertBefore(F,wt?jt:r),It&&Dh(It,0,Vt-It.scrollTop),Bt=F.parentNode,dt!==void 0&&!Ao&&(zo=Math.abs(dt-At(r)[Jt])),B(),N(!0)}if(e.contains(F))return N(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){rt(document,"mousemove",this._onTouchMove),rt(document,"touchmove",this._onTouchMove),rt(document,"pointermove",this._onTouchMove),rt(document,"dragover",Jn),rt(document,"mousemove",Jn),rt(document,"touchmove",Jn)},_offUpEvents:function(){var n=this.el.ownerDocument;rt(n,"mouseup",this._onDrop),rt(n,"touchend",this._onDrop),rt(n,"pointerup",this._onDrop),rt(n,"pointercancel",this._onDrop),rt(n,"touchcancel",this._onDrop),rt(document,"selectstart",this)},_onDrop:function(n){var e=this.el,r=this.options;if(Me=qt(F),Ln=qt(F,r.draggable),we("drop",this,{evt:n}),Bt=F&&F.parentNode,Me=qt(F),Ln=qt(F,r.draggable),Z.eventCanceled){this._nulling();return}Ti=!1,Ao=!1,xr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Va(this.cloneId),Va(this._dragStartId),this.nativeDraggable&&(rt(document,"drop",this),rt(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),wr&&H(document.body,"user-select",""),H(F,"transform",""),n&&(hr&&(n.cancelable&&n.preventDefault(),!r.dropBubble&&n.stopPropagation()),tt&&tt.parentNode&&tt.parentNode.removeChild(tt),(Mt===Bt||ie&&ie.lastPutMode!=="clone")&&Ft&&Ft.parentNode&&Ft.parentNode.removeChild(Ft),F&&(this.nativeDraggable&&rt(F,"dragend",this),ka(F),F.style["will-change"]="",hr&&!Ti&&Yt(F,ie?ie.options.ghostClass:this.options.ghostClass,!1),Yt(F,this.options.chosenClass,!1),ge({sortable:this,name:"unchoose",toEl:Bt,newIndex:null,newDraggableIndex:null,originalEvent:n}),Mt!==Bt?(Me>=0&&(ge({rootEl:Bt,name:"add",toEl:Bt,fromEl:Mt,originalEvent:n}),ge({sortable:this,name:"remove",toEl:Bt,originalEvent:n}),ge({rootEl:Bt,name:"sort",toEl:Bt,fromEl:Mt,originalEvent:n}),ge({sortable:this,name:"sort",toEl:Bt,originalEvent:n})),ie&&ie.save()):Me!==Ii&&Me>=0&&(ge({sortable:this,name:"update",toEl:Bt,originalEvent:n}),ge({sortable:this,name:"sort",toEl:Bt,originalEvent:n})),Z.active&&((Me==null||Me===-1)&&(Me=Ii,Ln=Sr),ge({sortable:this,name:"end",toEl:Bt,originalEvent:n}),this.save()))),this._nulling()},_nulling:function(){we("nulling",this),Mt=F=Bt=tt=ti=Ft=Bo=kn=Qn=Ze=hr=Me=Ln=Ii=Sr=Ei=Er=ie=To=Z.dragged=Z.ghost=Z.clone=Z.active=null,Qo.forEach(function(n){n.checked=!0}),Qo.length=Na=La=0},handleEvent:function(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":F&&(this._onDragOver(n),$b(n));break;case"selectstart":n.preventDefault();break}},toArray:function(){for(var n=[],e,r=this.el.children,a=0,l=r.length,u=this.options;a<l;a++)e=r[a],Se(e,u.draggable,this.el,!1)&&n.push(e.getAttribute(u.dataIdAttr)||Gb(e));return n},sort:function(n,e){var r={},a=this.el;this.toArray().forEach(function(l,u){var h=a.children[u];Se(h,this.options.draggable,a,!1)&&(r[l]=h)},this),e&&this.captureAnimationState(),n.forEach(function(l){r[l]&&(a.removeChild(r[l]),a.appendChild(r[l]))}),e&&this.animateAll()},save:function(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function(n,e){return Se(n,e||this.options.draggable,this.el,!1)},option:function(n,e){var r=this.options;if(e===void 0)return r[n];var a=Ir.modifyOption(this,n,e);typeof a<"u"?r[n]=a:r[n]=e,n==="group"&&Oh(r)},destroy:function(){we("destroy",this);var n=this.el;n[re]=null,rt(n,"mousedown",this._onTapStart),rt(n,"touchstart",this._onTapStart),rt(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(rt(n,"dragover",this),rt(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Zo.splice(Zo.indexOf(this.el),1),this.el=n=null},_hideClone:function(){if(!kn){if(we("hideClone",this),Z.eventCanceled)return;H(Ft,"display","none"),this.options.removeCloneOnHide&&Ft.parentNode&&Ft.parentNode.removeChild(Ft),kn=!0}},_showClone:function(n){if(n.lastPutMode!=="clone"){this._hideClone();return}if(kn){if(we("showClone",this),Z.eventCanceled)return;F.parentNode==Mt&&!this.options.group.revertClone?Mt.insertBefore(Ft,F):ti?Mt.insertBefore(Ft,ti):Mt.appendChild(Ft),this.options.group.revertClone&&this.animate(F,Ft),H(Ft,"display",""),kn=!1}}};function $b(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}function Do(o,n,e,r,a,l,u,h){var f,g=o[re],v=g.options.onMove,y;return window.CustomEvent&&!xn&&!Ar?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=n,f.from=o,f.dragged=e,f.draggedRect=r,f.related=a||n,f.relatedRect=l||At(n),f.willInsertAfter=h,f.originalEvent=u,o.dispatchEvent(f),v&&(y=v.call(g,f,u)),y}function ka(o){o.draggable=!1}function Bb(){Xa=!1}function zb(o,n,e){var r=At(Oi(e.el,0,e.options,!0)),a=Ph(e.el,e.options,tt),l=10;return n?o.clientX<a.left-l||o.clientY<r.top&&o.clientX<r.right:o.clientY<a.top-l||o.clientY<r.bottom&&o.clientX<r.left}function Wb(o,n,e){var r=At(rl(e.el,e.options.draggable)),a=Ph(e.el,e.options,tt),l=10;return n?o.clientX>a.right+l||o.clientY>r.bottom&&o.clientX>r.left:o.clientY>a.bottom+l||o.clientX>r.right&&o.clientY>r.top}function Hb(o,n,e,r,a,l,u,h){var f=r?o.clientY:o.clientX,g=r?e.height:e.width,v=r?e.top:e.left,y=r?e.bottom:e.right,S=!1;if(!u){if(h&&zo<g*a){if(!xr&&(Er===1?f>v+g*l/2:f<y-g*l/2)&&(xr=!0),xr)S=!0;else if(Er===1?f<v+zo:f>y-zo)return-Er}else if(f>v+g*(1-a)/2&&f<y-g*(1-a)/2)return Ub(n)}return S=S||u,S&&(f<v+g*l/2||f>y-g*l/2)?f>v+g/2?1:-1:0}function Ub(o){return qt(F)<qt(o)?1:-1}function Gb(o){for(var n=o.tagName+o.className+o.src+o.href+o.textContent,e=n.length,r=0;e--;)r+=n.charCodeAt(e);return r.toString(36)}function Yb(o){Qo.length=0;for(var n=o.getElementsByTagName("input"),e=n.length;e--;){var r=n[e];r.checked&&Qo.push(r)}}function Wo(o){return setTimeout(o,0)}function Va(o){return clearTimeout(o)}ts&&st(document,"touchmove",function(o){(Z.active||Ti)&&o.cancelable&&o.preventDefault()});Z.utils={on:st,off:rt,css:H,find:Ah,is:function(n,e){return!!Se(n,e,n,!1)},extend:Ib,throttle:Ih,closest:Se,toggleClass:Yt,clone:ol,index:qt,nextTick:Wo,cancelNextTick:Va,detectDirection:Mh,getChild:Oi,expando:re};Z.get=function(o){return o[re]};Z.mount=function(){for(var o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];n[0].constructor===Array&&(n=n[0]),n.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(Z.utils=ln(ln({},Z.utils),r.utils)),Ir.mount(r)})};Z.create=function(o,n){return new Z(o,n)};Z.version=Tb;var Gt=[],fr,Ka,Za=!1,$a,Ba,Jo,dr;function qb(){function o(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this))}return o.prototype={dragStarted:function(e){var r=e.originalEvent;this.sortable.nativeDraggable?st(document,"dragover",this._handleAutoScroll):this.options.supportPointer?st(document,"pointermove",this._handleFallbackAutoScroll):r.touches?st(document,"touchmove",this._handleFallbackAutoScroll):st(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var r=e.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?rt(document,"dragover",this._handleAutoScroll):(rt(document,"pointermove",this._handleFallbackAutoScroll),rt(document,"touchmove",this._handleFallbackAutoScroll),rt(document,"mousemove",this._handleFallbackAutoScroll)),oh(),Ho(),Db()},nulling:function(){Jo=Ka=fr=Za=dr=$a=Ba=null,Gt.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,r){var a=this,l=(e.touches?e.touches[0]:e).clientX,u=(e.touches?e.touches[0]:e).clientY,h=document.elementFromPoint(l,u);if(Jo=e,r||this.options.forceAutoScrollFallback||Ar||xn||wr){za(e,this.options,h,r);var f=Bn(h,!0);Za&&(!dr||l!==$a||u!==Ba)&&(dr&&oh(),dr=setInterval(function(){var g=Bn(document.elementFromPoint(l,u),!0);g!==f&&(f=g,Ho()),za(e,a.options,g,r)},10),$a=l,Ba=u)}else{if(!this.options.bubbleScroll||Bn(h,!0)===sn()){Ho();return}za(e,this.options,Bn(h,!1),!1)}}},je(o,{pluginName:"scroll",initializeByDefault:!0})}function Ho(){Gt.forEach(function(o){clearInterval(o.pid)}),Gt=[]}function oh(){clearInterval(dr)}var za=Ih(function(o,n,e,r){if(n.scroll){var a=(o.touches?o.touches[0]:o).clientX,l=(o.touches?o.touches[0]:o).clientY,u=n.scrollSensitivity,h=n.scrollSpeed,f=sn(),g=!1,v;Ka!==e&&(Ka=e,Ho(),fr=n.scroll,v=n.scrollFn,fr===!0&&(fr=Bn(e,!0)));var y=0,S=fr;do{var C=S,A=At(C),R=A.top,M=A.bottom,z=A.left,N=A.right,B=A.width,G=A.height,ft=void 0,ut=void 0,dt=C.scrollWidth,xt=C.scrollHeight,nt=H(C),Jt=C.scrollLeft,It=C.scrollTop;C===f?(ft=B<dt&&(nt.overflowX==="auto"||nt.overflowX==="scroll"||nt.overflowX==="visible"),ut=G<xt&&(nt.overflowY==="auto"||nt.overflowY==="scroll"||nt.overflowY==="visible")):(ft=B<dt&&(nt.overflowX==="auto"||nt.overflowX==="scroll"),ut=G<xt&&(nt.overflowY==="auto"||nt.overflowY==="scroll"));var Vt=ft&&(Math.abs(N-a)<=u&&Jt+B<dt)-(Math.abs(z-a)<=u&&!!Jt),Dt=ut&&(Math.abs(M-l)<=u&&It+G<xt)-(Math.abs(R-l)<=u&&!!It);if(!Gt[y])for(var Ot=0;Ot<=y;Ot++)Gt[Ot]||(Gt[Ot]={});(Gt[y].vx!=Vt||Gt[y].vy!=Dt||Gt[y].el!==C)&&(Gt[y].el=C,Gt[y].vx=Vt,Gt[y].vy=Dt,clearInterval(Gt[y].pid),(Vt!=0||Dt!=0)&&(g=!0,Gt[y].pid=setInterval((function(){r&&this.layer===0&&Z.active._onTouchMove(Jo);var jt=Gt[this.layer].vy?Gt[this.layer].vy*h:0,wt=Gt[this.layer].vx?Gt[this.layer].vx*h:0;typeof v=="function"&&v.call(Z.dragged.parentNode[re],wt,jt,o,Jo,Gt[this.layer].el)!=="continue"||Dh(Gt[this.layer].el,wt,jt)}).bind({layer:y}),24))),y++}while(n.bubbleScroll&&S!==f&&(S=Bn(S,!1)));Za=g}},30),Fh=function(n){var e=n.originalEvent,r=n.putSortable,a=n.dragEl,l=n.activeSortable,u=n.dispatchSortableEvent,h=n.hideGhostForTarget,f=n.unhideGhostForTarget;if(e){var g=r||l;h();var v=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,y=document.elementFromPoint(v.clientX,v.clientY);f(),g&&!g.el.contains(y)&&(u("spill"),this.onSpill({dragEl:a,putSortable:r}))}};function sl(){}sl.prototype={startIndex:null,dragStart:function(n){var e=n.oldDraggableIndex;this.startIndex=e},onSpill:function(n){var e=n.dragEl,r=n.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var a=Oi(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(e,a):this.sortable.el.appendChild(e),this.sortable.animateAll(),r&&r.animateAll()},drop:Fh};je(sl,{pluginName:"revertOnSpill"});function al(){}al.prototype={onSpill:function(n){var e=n.dragEl,r=n.putSortable,a=r||this.sortable;a.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),a.animateAll()},drop:Fh};je(al,{pluginName:"removeOnSpill"});var J=[],Pe=[],rr,Qe,or=!1,_e=!1,xi=!1,Et,sr,Po;function xw(){function o(n){for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this));n.options.avoidImplicitDeselect||(n.options.supportPointer?st(document,"pointerup",this._deselectMultiDrag):(st(document,"mouseup",this._deselectMultiDrag),st(document,"touchend",this._deselectMultiDrag))),st(document,"keydown",this._checkKeyDown),st(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(a,l){var u="";J.length&&Qe===n?J.forEach(function(h,f){u+=(f?", ":"")+h.textContent}):u=l.textContent,a.setData("Text",u)}}}return o.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var r=e.dragEl;Et=r},delayEnded:function(){this.isMultiDrag=~J.indexOf(Et)},setupClone:function(e){var r=e.sortable,a=e.cancel;if(this.isMultiDrag){for(var l=0;l<J.length;l++)Pe.push(ol(J[l])),Pe[l].sortableIndex=J[l].sortableIndex,Pe[l].draggable=!1,Pe[l].style["will-change"]="",Yt(Pe[l],this.options.selectedClass,!1),J[l]===Et&&Yt(Pe[l],this.options.chosenClass,!1);r._hideClone(),a()}},clone:function(e){var r=e.sortable,a=e.rootEl,l=e.dispatchSortableEvent,u=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||J.length&&Qe===r&&(sh(!0,a),l("clone"),u()))},showClone:function(e){var r=e.cloneNowShown,a=e.rootEl,l=e.cancel;this.isMultiDrag&&(sh(!1,a),Pe.forEach(function(u){H(u,"display","")}),r(),Po=!1,l())},hideClone:function(e){var r=this;e.sortable;var a=e.cloneNowHidden,l=e.cancel;this.isMultiDrag&&(Pe.forEach(function(u){H(u,"display","none"),r.options.removeCloneOnHide&&u.parentNode&&u.parentNode.removeChild(u)}),a(),Po=!0,l())},dragStartGlobal:function(e){e.sortable,!this.isMultiDrag&&Qe&&Qe.multiDrag._deselectMultiDrag(),J.forEach(function(r){r.sortableIndex=qt(r)}),J=J.sort(function(r,a){return r.sortableIndex-a.sortableIndex}),xi=!0},dragStarted:function(e){var r=this,a=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(a.captureAnimationState(),this.options.animation)){J.forEach(function(u){u!==Et&&H(u,"position","absolute")});var l=At(Et,!1,!0,!0);J.forEach(function(u){u!==Et&&eh(u,l)}),_e=!0,or=!0}a.animateAll(function(){_e=!1,or=!1,r.options.animation&&J.forEach(function(u){Ma(u)}),r.options.sort&&Ro()})}},dragOver:function(e){var r=e.target,a=e.completed,l=e.cancel;_e&&~J.indexOf(r)&&(a(!1),l())},revert:function(e){var r=e.fromSortable,a=e.rootEl,l=e.sortable,u=e.dragRect;J.length>1&&(J.forEach(function(h){l.addAnimationState({target:h,rect:_e?At(h):u}),Ma(h),h.fromRect=u,r.removeAnimationState(h)}),_e=!1,Xb(!this.options.removeCloneOnHide,a))},dragOverCompleted:function(e){var r=e.sortable,a=e.isOwner,l=e.insertion,u=e.activeSortable,h=e.parentEl,f=e.putSortable,g=this.options;if(l){if(a&&u._hideClone(),or=!1,g.animation&&J.length>1&&(_e||!a&&!u.options.sort&&!f)){var v=At(Et,!1,!0,!0);J.forEach(function(S){S!==Et&&(eh(S,v),h.appendChild(S))}),_e=!0}if(!a)if(_e||Ro(),J.length>1){var y=Po;u._showClone(r),u.options.animation&&!Po&&y&&Pe.forEach(function(S){u.addAnimationState({target:S,rect:sr}),S.fromRect=sr,S.thisAnimationDuration=null})}else u._showClone(r)}},dragOverAnimationCapture:function(e){var r=e.dragRect,a=e.isOwner,l=e.activeSortable;if(J.forEach(function(h){h.thisAnimationDuration=null}),l.options.animation&&!a&&l.multiDrag.isMultiDrag){sr=je({},r);var u=ni(Et,!0);sr.top-=u.f,sr.left-=u.e}},dragOverAnimationComplete:function(){_e&&(_e=!1,Ro())},drop:function(e){var r=e.originalEvent,a=e.rootEl,l=e.parentEl,u=e.sortable,h=e.dispatchSortableEvent,f=e.oldIndex,g=e.putSortable,v=g||this.sortable;if(r){var y=this.options,S=l.children;if(!xi)if(y.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Yt(Et,y.selectedClass,!~J.indexOf(Et)),~J.indexOf(Et))J.splice(J.indexOf(Et),1),rr=null,cr({sortable:u,rootEl:a,name:"deselect",targetEl:Et,originalEvent:r});else{if(J.push(Et),cr({sortable:u,rootEl:a,name:"select",targetEl:Et,originalEvent:r}),r.shiftKey&&rr&&u.el.contains(rr)){var C=qt(rr),A=qt(Et);~C&&~A&&C!==A&&function(){var N,B;A>C?(B=C,N=A):(B=A,N=C+1);for(var G=y.filter;B<N;B++)if(!~J.indexOf(S[B])&&Se(S[B],y.draggable,l,!1)){var ft=G&&(typeof G=="function"?G.call(u,r,S[B],u):G.split(",").some(function(ut){return Se(S[B],ut.trim(),l,!1)}));ft||(Yt(S[B],y.selectedClass,!0),J.push(S[B]),cr({sortable:u,rootEl:a,name:"select",targetEl:S[B],originalEvent:r}))}}()}else rr=Et;Qe=v}if(xi&&this.isMultiDrag){if(_e=!1,(l[re].options.sort||l!==a)&&J.length>1){var R=At(Et),M=qt(Et,":not(."+this.options.selectedClass+")");if(!or&&y.animation&&(Et.thisAnimationDuration=null),v.captureAnimationState(),!or&&(y.animation&&(Et.fromRect=R,J.forEach(function(N){if(N.thisAnimationDuration=null,N!==Et){var B=_e?At(N):R;N.fromRect=B,v.addAnimationState({target:N,rect:B})}})),Ro(),J.forEach(function(N){S[M]?l.insertBefore(N,S[M]):l.appendChild(N),M++}),f===qt(Et))){var z=!1;J.forEach(function(N){if(N.sortableIndex!==qt(N)){z=!0;return}}),z&&(h("update"),h("sort"))}J.forEach(function(N){Ma(N)}),v.animateAll()}Qe=v}(a===l||g&&g.lastPutMode!=="clone")&&Pe.forEach(function(N){N.parentNode&&N.parentNode.removeChild(N)})}},nullingGlobal:function(){this.isMultiDrag=xi=!1,Pe.length=0},destroyGlobal:function(){this._deselectMultiDrag(),rt(document,"pointerup",this._deselectMultiDrag),rt(document,"mouseup",this._deselectMultiDrag),rt(document,"touchend",this._deselectMultiDrag),rt(document,"keydown",this._checkKeyDown),rt(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!(typeof xi<"u"&&xi)&&Qe===this.sortable&&!(e&&Se(e.target,this.options.draggable,this.sortable.el,!1))&&!(e&&e.button!==0))for(;J.length;){var r=J[0];Yt(r,this.options.selectedClass,!1),J.shift(),cr({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:r,originalEvent:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},je(o,{pluginName:"multiDrag",utils:{select:function(e){var r=e.parentNode[re];!r||!r.options.multiDrag||~J.indexOf(e)||(Qe&&Qe!==r&&(Qe.multiDrag._deselectMultiDrag(),Qe=r),Yt(e,r.options.selectedClass,!0),J.push(e))},deselect:function(e){var r=e.parentNode[re],a=J.indexOf(e);!r||!r.options.multiDrag||!~a||(Yt(e,r.options.selectedClass,!1),J.splice(a,1))}},eventProperties:function(){var e=this,r=[],a=[];return J.forEach(function(l){r.push({multiDragElement:l,index:l.sortableIndex});var u;_e&&l!==Et?u=-1:_e?u=qt(l,":not(."+e.options.selectedClass+")"):u=qt(l),a.push({multiDragElement:l,index:u})}),{items:_b(J),clones:[].concat(Pe),oldIndicies:r,newIndicies:a}},optionListeners:{multiDragKey:function(e){return e=e.toLowerCase(),e==="ctrl"?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}function Xb(o,n){J.forEach(function(e,r){var a=n.children[e.sortableIndex+(o?Number(r):0)];a?n.insertBefore(e,a):n.appendChild(e)})}function sh(o,n){Pe.forEach(function(e,r){var a=n.children[e.sortableIndex+(o?Number(r):0)];a?n.insertBefore(e,a):n.appendChild(e)})}function Ro(){J.forEach(function(o){o!==Et&&o.parentNode&&o.parentNode.removeChild(o)})}Z.mount(new qb);Z.mount(al,sl);function Cw(o={show:!1,focusable:!1}){return{show:o.show,focusable:o.focusable,closeModal(){this.show=!1},openModal(){this.show=!0},focusables(){return[...this.$el.querySelectorAll("a, button, input:not([type='hidden']), textarea, select, details, [tabindex]:not([tabindex='-1'])")].filter(e=>!e.hasAttribute("disabled"))},firstFocusable(){return this.focusables()[0]},lastFocusable(){return this.focusables().slice(-1)[0]},nextFocusable(){return this.focusables()[this.nextFocusableIndex()]||this.firstFocusable()},prevFocusable(){return this.focusables()[this.prevFocusableIndex()]||this.lastFocusable()},nextFocusableIndex(){return(this.focusables().indexOf(document.activeElement)+1)%(this.focusables().length+1)},prevFocusableIndex(){return Math.max(0,this.focusables().indexOf(document.activeElement))-1},init(){this.$watch("show",n=>{n?(document.body.classList.add("overflow-y-hidden"),this.focusable!==!1&&setTimeout(()=>this.firstFocusable().focus(),100)):document.body.classList.remove("overflow-y-hidden")})}}}function Tw(o={}){return{isShared:o.isShared??!1,limits:o.limits??{},init(){},pushToAiEngines(n){this.aiEngines.push(n)}}}class kh{constructor(){this.playbackNode=null}async init(n){this.audioContext=new AudioContext({sampleRate:n}),await this.audioContext.audioWorklet.addModule("/themes/default/assets/js/audio/playback-worklet.js"),this.playbackNode=new AudioWorkletNode(this.audioContext,"playback-worklet"),this.playbackNode.connect(this.audioContext.destination)}play(n){this.playbackNode&&this.playbackNode.port.postMessage(n)}clear(){this.playbackNode&&this.playbackNode.port.postMessage(null)}}function Pi(o,n,e,r){function a(l){return l instanceof e?l:new e(function(u){u(l)})}return new(e||(e=Promise))(function(l,u){function h(v){try{g(r.next(v))}catch(y){u(y)}}function f(v){try{g(r.throw(v))}catch(y){u(y)}}function g(v){v.done?l(v.value):a(v.value).then(h,f)}g((r=r.apply(o,[])).next())})}function ei(o,n){var e={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,a,l,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=h(0),u.throw=h(1),u.return=h(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(g){return function(v){return f([g,v])}}function f(g){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,g[0]&&(e=0)),e;)try{if(r=1,a&&(l=g[0]&2?a.return:g[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,g[1])).done)return l;switch(a=0,l&&(g=[g[0]&2,l.value]),g[0]){case 0:case 1:l=g;break;case 4:return e.label++,{value:g[1],done:!1};case 5:e.label++,a=g[1],g=[0];continue;case 7:g=e.ops.pop(),e.trys.pop();continue;default:if(l=e.trys,!(l=l.length>0&&l[l.length-1])&&(g[0]===6||g[0]===2)){e=0;continue}if(g[0]===3&&(!l||g[1]>l[0]&&g[1]<l[3])){e.label=g[1];break}if(g[0]===6&&e.label<l[1]){e.label=l[1],l=g;break}if(l&&e.label<l[2]){e.label=l[2],e.ops.push(g);break}l[2]&&e.ops.pop(),e.trys.pop();continue}g=n.call(o,e)}catch(v){g=[6,v],a=0}finally{r=l=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function ah(o){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&o[n],r=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wa(o,n){var e=typeof Symbol=="function"&&o[Symbol.iterator];if(!e)return o;var r=e.call(o),a,l=[],u;try{for(;(n===void 0||n-- >0)&&!(a=r.next()).done;)l.push(a.value)}catch(h){u={error:h}}finally{try{a&&!a.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return l}function Ri(o){return this instanceof Ri?(this.v=o,this):new Ri(o)}function Vb(o,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e.apply(o,n||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",u),a[Symbol.asyncIterator]=function(){return this},a;function u(C){return function(A){return Promise.resolve(A).then(C,y)}}function h(C,A){r[C]&&(a[C]=function(R){return new Promise(function(M,z){l.push([C,R,M,z])>1||f(C,R)})},A&&(a[C]=A(a[C])))}function f(C,A){try{g(r[C](A))}catch(R){S(l[0][3],R)}}function g(C){C.value instanceof Ri?Promise.resolve(C.value.v).then(v,y):S(l[0][2],C)}function v(C){f("next",C)}function y(C){f("throw",C)}function S(C,A){C(A),l.shift(),l.length&&f(l[0][0],l[0][1])}}function Kb(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=o[Symbol.asyncIterator],e;return n?n.call(o):(o=typeof ah=="function"?ah(o):o[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(l){e[l]=o[l]&&function(u){return new Promise(function(h,f){u=o[l](u),a(h,f,u.done,u.value)})}}function a(l,u,h,f){Promise.resolve(f).then(function(g){l({value:g,done:h})},u)}}var Zb=function(o){return typeof o=="object"&&o!==null&&"type"in o},Qb=function(o){return Zb(o)&&["error","message","conversation.item.input_audio_transcription.delta","session.created","session.updated","input_audio_buffer.committed","input_audio_buffer.cleared","input_audio_buffer.speech_started","input_audio_buffer.speech_stopped","conversation.item.created","conversation.item.truncated","conversation.item.deleted","conversation.item.input_audio_transcription.completed","conversation.item.input_audio_transcription.failed","response.created","response.done","response.output_item.added","response.output_item.done","response.content_part.added","response.content_part.done","response.text.delta","response.text.done","response.audio_transcript.delta","response.audio_transcript.done","response.audio.delta","response.audio.done","response.function_call_arguments.delta","response.function_call_arguments.done","rate_limits.updated"].includes(o.type)},Jb=WebSocket,jb=function(o,n){return o.readyState!==WebSocket.OPEN?Promise.reject(new Error("Socket is not open")):(o.send(n),Promise.resolve())},tw=function(o){return{success:!0,message:o}},ew=function(o){return{success:!1,error:o}},nw=function(o){return o.success},iw=function(){function o(n,e){var r=this;this.closedPromise=void 0,this.messageQueue=[],this.receiverQueue=[],this.done=!1,this.validate=e.validate,this.serialize=e.serialize,this.connectedPromise=new Promise(function(a,l){return Pi(r,void 0,void 0,function(){var u,h,f,g,v=this;return ei(this,function(y){switch(y.label){case 0:return n.policy!==void 0?[3,1]:(g=n,[3,3]);case 1:return[4,n.policy(n)];case 2:g=y.sent(),y.label=3;case 3:return u=g,h=u.uri,f=u.protocols,this.socket=new Jb(h.toString(),f),this.socket.onopen=function(){v.socket.onmessage=v.getMessageHandler(),v.closedPromise=new Promise(function(S){v.socket.onclose=v.getClosedHandler(S)}),v.socket.onerror=v.handleError,a()},this.socket.onerror=function(S){v.error=S.error,l(S)},[2]}})})})}return o.prototype.handleError=function(n){for(this.error=n.error;this.receiverQueue.length>0;){var e=Wa(this.receiverQueue.shift(),2);e[0];var r=e[1];r(n.error)}},o.prototype.getClosedHandler=function(n){var e=this;return function(r){for(e.done=!0;e.receiverQueue.length>0;){var a=Wa(e.receiverQueue.shift(),2),l=a[0],u=a[1];e.error?u(e.error):l({value:void 0,done:!0})}n()}},o.prototype.getMessageHandler=function(){var n=this;return function(e){var r=n.validate(e);if(nw(r)){var a=r.message;if(n.receiverQueue.length>0){var l=Wa(n.receiverQueue.shift(),2),u=l[0];l[1],u({value:a,done:!1})}else n.messageQueue.push(a)}else n.error=r.error,n.socket.close(1e3,"Unexpected message received")}},o.prototype[Symbol.asyncIterator]=function(){var n=this;return{next:function(){if(n.error)return Promise.reject(n.error);if(n.done)return Promise.resolve({value:void 0,done:!0});if(n.messageQueue.length>0){var e=n.messageQueue.shift();return Promise.resolve({value:e,done:!1})}else return new Promise(function(r,a){n.receiverQueue.push([r,a])})}}},o.prototype.send=function(n){return Pi(this,void 0,void 0,function(){var e;return ei(this,function(r){switch(r.label){case 0:return[4,this.connectedPromise];case 1:if(r.sent(),this.error)throw this.error;return e=this.serialize(n),[2,jb(this.socket,e)]}})})},o.prototype.close=function(){return Pi(this,void 0,void 0,function(){return ei(this,function(n){switch(n.label){case 0:return[4,this.connectedPromise];case 1:return n.sent(),this.done?[2]:(this.socket.close(),[4,this.closedPromise]);case 2:return n.sent(),[2]}})})},o}();function Qa(o){return typeof o=="object"&&o!==null&&"key"in o&&typeof o.key=="string"}function rw(o){return typeof o=="object"&&o!==null&&"getToken"in o&&typeof o.getToken=="function"}var ow=function(o){return Qa(o)||rw(o)},sw=function(o){return typeof o=="object"&&o!==null&&"model"in o&&typeof o.model=="string"},aw=function(o){return typeof o=="object"&&o!==null&&"deployment"in o&&typeof o.deployment=="string"},lw=function(){function o(n,e,r){var a=this,l=function(){if(Qa(n)&&sw(e))return a.openAISettings(n,e);if(ow(e)&&aw(r))return a.azureOpenAISettings(n,e,r);throw new Error("Invalid combination of arguments to initialize the Realtime client")}();this.client=this.getWebsocket(l)}return o.prototype.azureOpenAISettings=function(n,e,r){var a=this,l=["https://cognitiveservices.azure.com/.default"];return this.requestId=crypto.randomUUID(),n.searchParams.set("api-version","2024-10-01-preview"),n.searchParams.set("x-ms-client-request-id",this.requestId),n.searchParams.set("deployment",r.deployment),n.pathname="openai/realtime",{uri:n,policy:function(u){return Pi(a,void 0,void 0,function(){var h;return ei(this,function(f){switch(f.label){case 0:return Qa(e)?(u.uri.searchParams.set("api-key",e.key),[3,3]):[3,1];case 1:return[4,e.getToken(l)];case 2:h=f.sent(),u.uri.searchParams.set("Authorization","Bearer ".concat(h.token)),f.label=3;case 3:return[2,u]}})})}}},o.prototype.openAISettings=function(n,e){var r=new URL("wss://api.openai.com/v1/realtime");return r.searchParams.set("model",e.model),{uri:r,protocols:["realtime","openai-insecure-api-key.".concat(n.key),"openai-beta.realtime-v1"]}},o.prototype.getWebsocket=function(n){var e={validate:function(r){r.data;try{var a=JSON.parse(r.data);if(Qb(a))return tw(a)}catch{return ew(new Error("Invalid JSON message"))}},serialize:function(r){return JSON.stringify(r)}};return new iw(n,e)},o.prototype.messages=function(){return Vb(this,arguments,function(){var e,r,a,l,u,h,f,g,v;return ei(this,function(y){switch(y.label){case 0:y.trys.push([0,7,8,13]),e=!0,r=Kb(this.client),y.label=1;case 1:return[4,Ri(r.next())];case 2:return a=y.sent(),h=a.done,!h?(v=a.value,e=!1,l=v,[4,Ri(l)]):[3,6];case 3:return[4,y.sent()];case 4:y.sent(),y.label=5;case 5:return e=!0,[3,1];case 6:return[3,13];case 7:return u=y.sent(),f={error:u},[3,13];case 8:return y.trys.push([8,,11,12]),!e&&!h&&(g=r.return)?[4,Ri(g.call(r))]:[3,10];case 9:y.sent(),y.label=10;case 10:return[3,12];case 11:if(f)throw f.error;return[7];case 12:return[7];case 13:return[2]}})})},o.prototype.send=function(n){return Pi(this,void 0,void 0,function(){return ei(this,function(e){switch(e.label){case 0:return[4,this.client.send(n)];case 1:return e.sent(),[2]}})})},o.prototype.close=function(){return Pi(this,void 0,void 0,function(){return ei(this,function(n){switch(n.label){case 0:return[4,this.client.close()];case 1:return n.sent(),[2]}})})},o}();rn.store("realtimeChatStatus",{active:!1,conversationStarted:!1,setActive(o){this.active=o,this.onActiveChange()},setConversationStarted(o){this.conversationStarted=o,this.onConversationStartedChange()},onActiveChange(){var o,n;document.querySelectorAll(".lqd-realtime-chat-button").forEach(e=>e.classList.toggle("active",this.active)),(n=(o=document.querySelector(".lqd-audio-vis-wrap"))==null?void 0:o.classList)==null||n.toggle("active",this.active)},onConversationStartedChange(){const o=document.querySelector(".chats-wrap");o.classList.toggle("conversation-started",this.conversationStarted),o.classList.toggle("conversation-not-started",!this.conversationStarted),document.querySelectorAll(".lqd-realtime-chat-button").forEach(n=>{n.classList.toggle("conversation-started",this.conversationStarted),n.classList.toggle("conversation-not-started",!this.conversationStarted)})}});const Aw=(o,n,e)=>({apiKey:"",recordingActive:!1,buffer:new Uint8Array,wsConnection:null,audioRecorder:null,audioPlayer:null,activeVisulaizer:"idle",audioVisWrap:null,audioVisBars:null,audioVisDotWrap:null,audioVisLoader:null,conversationArea:document.querySelector(".conversation-area"),chatsContainer:document.querySelector(".chats-container"),userBubbleTemplate:document.querySelector("#chat_user_bubble"),aiBubbleTemplate:document.querySelector("#chat_ai_bubble"),lastAiBubble:null,lastUserBubble:null,lastUserQuestion:"",lastAiResponse:"",lastResponseSaved:!1,init(){var r,a,l;this.audioVisWrap=document.querySelector(".lqd-audio-vis-wrap"),this.audioVisBars=(r=this.audioVisWrap)==null?void 0:r.querySelectorAll(".lqd-audio-vis-bar"),this.audioVisDotWrap=(a=this.audioVisWrap)==null?void 0:a.querySelector(".lqd-audio-vis-dot-wrap"),this.audioVisLoader=(l=this.audioVisWrap)==null?void 0:l.querySelector(".lqd-audio-vis-loader"),this.processAudioRecordingBuffer=this.processAudioRecordingBuffer.bind(this)},async start(){if(this.checkBalanceRealtime(!0).then(r=>{r.shouldStop&&(toastr.error(r.errorMsg),this.stop())}),!rn.store("realtimeChatStatus").isActive){rn.store("realtimeChatStatus").setActive(!0),this.switchVisualizers("waiting"),this.wsConnection=new lw({key:atob(o)+atob(n)+atob(e)},{model:"gpt-4o-realtime-preview-2024-12-17"});try{await this.wsConnection.send(this.createConfigMessage())}catch(r){this.stop(),console.error("Error sending initial config message:",r),this.appendToChatBubble("ai","[Connection error]: Unable to send initial config message. Please check your endpoint and authentication details.");return}await Promise.all([this.startRecorder(),this.startPlayer()]).then(()=>{this.handleRealtimeMessages(),this.startBarsVisualizer(),this.startDotVisualizer(),this.switchVisualizers("idle")}).catch(r=>{this.stop(),console.error("Error starting recorder and player:",r),this.appendToChatBubble("ai","[Error]: Unable to start audio recorder and player. Please check your microphone permissions and refresh the page.")})}},stop(){!this.lastResponseSaved&&"saveResponseAsync"in window&&this.lastUserQuestion.trim()!==""&&this.lastAiResponse.trim()!==""&&saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","gpt-4o-realtime-preview-2024-12-17"),this.resetPlayers(),this.wsConnection&&this.wsConnection.close(),this.switchVisualizers(""),rn.store("realtimeChatStatus").setActive(!1)},async startPlayer(){try{this.audioPlayer=new kh,await this.audioPlayer.init(24e3)}catch(r){console.error("Error starting audio player:",r)}},async startRecorder(){try{this.audioRecorder=new uh(this.processAudioRecordingBuffer);const r=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});await this.audioRecorder.start(r),this.recordingActive=!0}catch(r){console.error("Error starting audio recorder:",r)}},createConfigMessage(){let r={type:"session.update",session:{turn_detection:{type:"server_vad",silence_duration_ms:500},input_audio_transcription:{model:"whisper-1"}}};const a=this.getSystemMessage(),l=this.getTemperature(),u=this.getVoice();return a&&(r.session.instructions=a),isNaN(l)||(r.session.temperature=l),u&&(r.session.voice=u),r},async handleRealtimeMessages(){for await(const r of this.wsConnection.messages())switch(""+r.type,r.type){case"session.created":this.switchVisualizers("idle");break;case"response.content_part.added":this.checkBalanceRealtime().then(a=>{a.shouldStop&&(toastr.error(a.errorMsg),this.stop())}),this.lastAiResponse="",rn.store("realtimeChatStatus").setConversationStarted(!0),this.createChatBubble("ai");break;case"response.audio_transcript.delta":this.lastAiResponse+=r.delta,this.appendToChatBubble("ai",r.delta);break;case"response.audio.delta":{this.switchVisualizers("playing");const a=atob(r.delta),l=Uint8Array.from(a,h=>h.charCodeAt(0)),u=new Int16Array(l.buffer);this.audioPlayer.play(u);break}case"input_audio_buffer.speech_started":{this.createChatBubble("user"),this.switchVisualizers("recording"),this.audioPlayer.clear(),this.lastResponseSaved=!1,setTimeout(()=>{this.lastUserQuestion=""},0);break}case"conversation.item.input_audio_transcription.completed":this.lastUserQuestion+=r.transcript,this.appendToChatBubble("user",r.transcript);break;case"response.output_item.done":break;case"conversation.item.truncated":this.appendToChatBubble("ai","...");break;case"conversation.item.deleted":break;case"response.done":"saveResponseAsync"in window&&(saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","gpt-4o-realtime-preview-2024-12-17"),this.lastResponseSaved=!0),"formatString"in window&&this.lastAiBubble&&(this.lastAiBubble.innerHTML=formatString(this.lastAiResponse));break;default:JSON.stringify(r,null,2);break}this.resetPlayers()},combineArray(r){const a=new Uint8Array(this.buffer.length+r.length);a.set(this.buffer),a.set(r,this.buffer.length),this.buffer=a},processAudioRecordingBuffer(r){const a=new Uint8Array(r);if(this.combineArray(a),this.buffer.length>=4800){const l=new Uint8Array(this.buffer.slice(0,4800));this.buffer=new Uint8Array(this.buffer.slice(4800));const u=String.fromCharCode(...l),h=btoa(u);this.recordingActive&&this.wsConnection.send({type:"input_audio_buffer.append",audio:h})}},async resetPlayers(){var r,a;this.recordingActive=!1,(r=this.audioRecorder)==null||r.stop(),(a=this.audioPlayer)==null||a.clear()},getSystemMessage(){return""},getTemperature(){return parseFloat(.8)},getVoice(){return"alloy"},switchVisualizers(r){var a;this.activeVisulaizer=r,(a=this.audioVisWrap)==null||a.setAttribute("data-state",this.activeVisulaizer)},createChatBubble(r){const l=(r==="user"?this.userBubbleTemplate:this.aiBubbleTemplate).content.cloneNode(!0),u=l.querySelector(".chat-content");this.chatsContainer.appendChild(l),r==="user"?this.lastUserBubble=u:this.lastAiBubble=u,this.scrollConversationAreaToBottom()},appendToChatBubble(r,a){const l=r==="user"?this.lastUserBubble:this.lastAiBubble;l?(l.textContent+=a,this.scrollConversationAreaToBottom()):(this.createChatBubble(r),this.appendToChatBubble(r,a))},scrollConversationAreaToBottom(){this.conversationArea.scrollTo({top:this.conversationArea.scrollHeight+200,left:0})},startBarsVisualizer(){var g;if(!((g=this.audioVisBars)!=null&&g.length))return;const r=this.audioPlayer.audioContext.createAnalyser();r.fftSize=4096;const a=r.frequencyBinCount,l=new Uint8Array(a),u=this.audioVisBars.length;this.audioPlayer.playbackNode.connect(r);const h=[[85,150],[150,250],[250,400],[400,600],[600,1e3]];this.barHeights=this.barHeights||new Array(u).fill(0);const f=()=>{r.getByteFrequencyData(l),this.audioVisBars.forEach((v,y)=>{const[S,C]=h[y],A=Math.floor(S/(this.audioPlayer.audioContext.sampleRate/r.fftSize)),R=Math.ceil(C/(this.audioPlayer.audioContext.sampleRate/r.fftSize));let M=0;for(let N=A;N<=R&&N<l.length;N++)l[N]>M&&(M=l[N]);let z=M/255*80;this.barHeights[y]+=(z-this.barHeights[y])*.4,this.barHeights[y]+=(Math.random()-.5)*2,this.barHeights[y]=Math.max(5,Math.min(100,this.barHeights[y])),v.animate([{height:v.style.height},{height:`${this.barHeights[y]}%`}],{duration:30,fill:"forwards",easing:"linear"})}),requestAnimationFrame(f)};f()},startDotVisualizer(){if(!this.audioRecorder||!this.audioVisDotWrap)return;const r=this.audioRecorder.audioContext.createAnalyser();r.fftSize=256;const a=r.frequencyBinCount,l=new Uint8Array(a);this.audioRecorder.getMediaStreamSource().connect(r);const u=this.audioVisDotWrap.querySelector(".lqd-audio-vis-dot");if(!u)return;const h=()=>{r.getByteFrequencyData(l);let f=0;for(let S=0;S<a;S++)f+=l[S];const v=1+f/a/256*1.5,y=Math.max(.2,1-(v-1)/1.5);u.style.transform=`scale(${v})`,u.style.opacity=y.toFixed(2),requestAnimationFrame(h)};h()},checkBalanceRealtime(r=!1){return new Promise(a=>{$.ajax({url:"/dashboard/user/realtime/chat/checkBalance",type:"POST",data:{onStart:r},dataType:"json",success:l=>{const u=l.status!=="success",h=l.message||"";console.log("Try Count:",l.tryCount),a({shouldStop:u,errorMsg:h})},error:()=>{a({shouldStop:!0,errorMsg:"An error occurred."})}})})}}),Iw=(o={})=>({prevViews:[],task:!1,currentView:"home",sidebarCollapsed:!1,toolbarCollapsed:!1,modalShow:!1,activeModal:null,activeModalId:null,activeModalIdPrefix:null,currentToolsCat:"primary",tools:o.tools||[],primaryToolKeys:o.primaryToolKeys||[],showImageDetails:!1,zoomLevel:1,reachedMinZoom:!1,reachedMaxZoom:!1,newItems:[],showNotif:!1,editingImageDimensions:{width:0,height:0},painting:!1,brushSize:40,canvasCtx:null,lastUploadingImages:[],uploadingImages:[],promptLibraryShow:!1,promptFilter:"all",searchPromptStr:"",supportMultipleImageTools:["reimagine"],_busy:!1,_template:"",_prompt:"",_selectedTemplateDescription:"",_selectedPromptDescription:"",_selectedTool:"",aiModel:"",_prevEditingImage:{},_editingImage:{},get busy(){return this._busy},set busy(n){this._busy=n},get selectedTemplate(){return this._template.trim()},set selectedTemplate(n){var e;this._template=n,(e=this.$refs.promptInput)==null||e.focus()},get prompt(){return this._prompt},set prompt(n){var e;this._prompt=n.trim(),(e=this.$refs.promptInput)==null||e.focus()},get selectedTemplateDescription(){return this._selectedTemplateDescription},set selectedTemplateDescription(n){this._selectedTemplateDescription!==n&&(this._selectedTemplateDescription=n)},get selectedPromptDescription(){return this._selectedPromptDescription},set selectedPromptDescription(n){this._selectedPromptDescription!==n&&(this._selectedPromptDescription=n)},get selectedTool(){return this._selectedTool},set selectedTool(n){this.aiModel=AIModelsforTool[n],this._selectedTool!==n&&(this._selectedTool=n,this.makeCanvasEditable(this._selectedTool==="sketch_to_image"?{width:1024,height:1024}:{}),!this.selectedToolSupportMultiImagesUpload()&&this.$refs.editorFileInput.files.length&&this.clearImageInputs())},get prevEditingImage(){return this._prevEditingImage},get editingImage(){return this._editingImage},set editingImage(n){this._prevEditingImage=this._editingImage,this._editingImage=n,this.showImageDetails=!1,this.zoomLevel=1,n!=null&&n.output&&fetch(n.output).then(e=>e.blob()).then(e=>{var l,u;const r=new File([e],((u=(l=n.title)==null?void 0:l.split("."))==null?void 0:u.at(0))||"image",{type:e.type}),a=new DataTransfer;a.items.add(r),this.$refs.uploadedImageInput.files=a.files}).catch(e=>{toastr.error("Failed to load image"),console.error("Error creating file from URL:",e)})},init(){this.onViewChange=this.onViewChange.bind(this),this.onZoomLevelChange=this.onZoomLevelChange.bind(this),this.onCreativeSuiteStageInitiated=this.onCreativeSuiteStageInitiated.bind(this),this.makeCanvasEditable=this.makeCanvasEditable.bind(this),this.startPainting=this.startPainting.bind(this),this.stopPainting=this.stopPainting.bind(this),this.paint=this.paint.bind(this),document.documentElement.style.scrollbarGutter="stable",this.$watch("currentView",this.onViewChange),this.$watch("zoomLevel",this.onZoomLevelChange),this.creativeSuite&&this.$watch("creativeSuite.stageInitiated",this.onCreativeSuiteStageInitiated);const n=new URLSearchParams(window.location.search);if(n.has("action")){const e=n.get("action");["merge_face","uncrop","reimagine","remove_background","cleanup","upscale","replace_background","sketch_to_image","remove_text","inpainting","style_transfer","image_relight"].includes(e)&&(this.currentView="editor",this.switchToolsCat({toolKey:e}),this.selectedTool=e)}},switchView(n){var e;if(!((e=this.creativeSuite)!=null&&e.editingTextNode)){if(n==="<"){this.currentView=this.prevViews.pop()||"home";return}this.prevViews.push(this.currentView),this.currentView=n||"home"}},switchSidebarCollapsed(n){if(n!=null){this.sidebarCollapsed=n;return}this.sidebarCollapsed=!this.sidebarCollapsed,this.$nextTick(()=>{this.zoomLevel>1&&this.fitToScreen()}),this.$refs.imageEditorSidebar.addEventListener("transitionend",e=>{e.target!==this.$refs.imageEditorSidebar&&e.propertyName!=="transform"||this.reachedMaxZoom&&this.fitToScreen()})},onViewChange(n){const e=n==="editor";document.documentElement.style.overflow=e?"hidden":""},setActiveModal(n,e="modal"){this.activeModal=n,this.activeModalId=n.id,this.activeModalIdPrefix=e},prevImageModal(){const n=document.querySelector(`.image-result[data-id='${this.activeModalId}'][data-id-prefix=${this.activeModalIdPrefix}]`),e=n==null?void 0:n.previousElementSibling;if(!e)return;const r=JSON.parse(e.getAttribute("data-payload")||{});this.setActiveModal(r,n.getAttribute("data-id-prefix"))},nextImageModal(){const n=document.querySelector(`.image-result[data-id='${this.activeModalId}'][data-id-prefix=${this.activeModalIdPrefix}]`),e=n==null?void 0:n.nextElementSibling;if(!e)return;const r=JSON.parse(e.getAttribute("data-payload")||{});this.setActiveModal(r,n.getAttribute("data-id-prefix"))},getSelectedToolCat(){return this.getToolCat(this.selectedTool)},switchToolsCat(n={}){if(n.cat)return this.currentToolsCat=n.cat;if(n.toolKey)return this.currentToolsCat=this.getToolCat(n.toolKey);if(!n.cat&&!n.toolKey)return this.currentToolsCat=this.currentToolsCat==="primary"?"secondary":"primary"},getToolCat(n){return this.primaryToolKeys.findIndex(e=>e===n)>=0?"primary":"secondary"},selectedToolSupportMultiImagesUpload(){return this.supportMultipleImageTools.includes(this.selectedTool)&&this.aiModel==="openai"},handleDragOver(){this.$refs.dropArea.classList.add("drag-over")},handleDragLeave(){this.$refs.dropArea.classList.remove("drag-over")},handleUploadingMultiImages(n){if(!this.selectedToolSupportMultiImagesUpload())return;const e=Array.from(n),r=Array.from(this.lastUploadingImages),a=new DataTransfer;return r.forEach(l=>{a.items.add(l)}),e.forEach(l=>{if(!l.type.startsWith("image/")){toastr.error("Please upload a valid image file."),this.clearImageInputs();return}r.findIndex(u=>u.name===l.name&&u.size===l.size)===-1&&a.items.add(l)}),this.$refs.editorFileInput.files=a.files,this.$refs.uploadedImageInput.files=a.files,this.lastUploadingImages=a.files,this.uploadingImages=Array.from(a.files).map(l=>({src:URL.createObjectURL(l),name:l.name})),a.files},handleFileChange(n){var r;let e=n.dataTransfer?n.dataTransfer.files:(r=n.target)==null?void 0:r.files;if(this.$refs.dropArea.classList.remove("drag-over"),!!e){if(n.dataTransfer&&(this.$refs.editorFileInput.files=e),e&&!e.length){this.handleUploadingMultiImages(this.lastUploadingImages);return}this.selectedToolSupportMultiImagesUpload()&&(e=this.handleUploadingMultiImages(e)),this.handleFiles(e)}},handleFiles(n){if(!n[0])return;this.selectedToolSupportMultiImagesUpload()||(this.editingImage={output:URL.createObjectURL(n[0]),name:n[0].name});const e=new FormData;e.append("image",n[0]),e.append("reimagine",n[0]),["reimagine"].includes(this.selectedTool)&&(this.$refs.promptInput&&(this.$refs.promptInput.disabled=!0,this.$refs.promptInput.placeholder="Analyzing image... Please wait..."),fetch("/dashboard/user/image-to-prompt",{method:"POST",headers:{"X-CSRF-TOKEN":"{{ csrf_token() }}"},body:e}).then(r=>r.json()).then(r=>{r.status==="success"?this.prompt=r.prompt:toastr.error(r.prompt)}).catch(r=>{console.log("Error:",r)}).finally(()=>{this.$refs.promptInput&&(this.$refs.promptInput.disabled=!1,this.$refs.promptInput.placeholder="Describe your idea or select a pre-defined prompt")}))},resetUploadedImageInput(){this.zoomLevel=1,this.clearImageInputs(),this.selectedTool==="sketch_to_image"&&this.makeCanvasEditable({width:1024,height:1024})},clearImageInputs(){this.lastUploadingImages=[],this.uploadingImages=[],this.editingImage={},this.$refs.editorFileInput.value="",this.$refs.uploadedImageInput.value=""},downloadImage(n,e){const r=document.createElement("a");r.href=n,r.download=e?e.replaceAll(" ","-"):"image",r.click(),r.remove()},getMaxZoom(){const n=this.$refs.editorCanvas,e=n.offsetWidth,r=window.getComputedStyle(n);return 1+(parseFloat(r.marginLeft)+parseFloat(r.marginRight)-20)/e},setZoomLevel(n){const e=this.getMaxZoom();this.zoomLevel=Math.max(.1,Math.min(e,n)),this.reachedMinZoom=this.zoomLevel===.1,this.reachedMaxZoom=this.zoomLevel>=e},zoomIn(){this.setZoomLevel(this.zoomLevel+.1)},zoomOut(){this.setZoomLevel(this.zoomLevel-.1)},fitToScreen(){const n=this.getMaxZoom();this.setZoomLevel(n)},onZoomLevelChange(){const n=this.$refs.editorCanvas;n.style.setProperty("--zoom-level",this.zoomLevel.toFixed(3)),n.style.setProperty("--zoom-offset","0px");const e=window.getComputedStyle(n),r=parseFloat(e.getPropertyValue("--header-h")),l=n.getBoundingClientRect().top+this.$refs.editorCanvasWrap.scrollTop;l<r&&n.style.setProperty("--zoom-offset",`${(l>=0?r-l:r+Math.abs(l)).toFixed(0)}px`)},submitEditorForm(n){this.busy=!0;const e=new FormData(n.target);fetch(n.target.action,{method:"POST",body:e,headers:{Accept:"application/json"}}).then(r=>r.ok?r.json():r.json().then(a=>{throw new Error(a.message||"An unknown error occurred")})).then(r=>{var a,l;if(r.type==="error"){toastr.error(r.message);return}if(((a=r==null?void 0:r.data)==null?void 0:a.status)==="CREATED"||((l=r==null?void 0:r.data)==null?void 0:l.status)==="IN_PROGRESS")this.task=!0,this.getStatus(r.data);else{this.editingImage=r.data,this.newItems.push(r.data),this.showNotif=!0,this.uploadingImages=[],this.selectedTool==="sketch_to_image"&&(this.switchToolsCat({toolKey:this.primaryToolKeys[0]}),this.selectedTool=this.primaryToolKeys[0]);const u=setTimeout(()=>{this.showNotif=!1,clearTimeout(u)},3e3)}}).catch(r=>{console.log(r),toastr.error((r==null?void 0:r.message)||r)}).finally(()=>{this.task||(this.busy=!1)})},async getStatus(n={}){this.busy=!0,fetch("/dashboard/user/advanced-image/editor/"+n.id+"/status",{method:"GET",headers:{Accept:"application/json"}}).then(e=>e.ok?e.json():e.json().then(r=>{throw new Error(r.message||"An unknown error occurred")})).then(e=>{if(e.status==="error")throw new Error(e.message);if(e.data.status==="COMPLETED"){this.task=!1,this.editingImage=e.data,this.newItems.push(e.data),this.showNotif=!0;const r=setTimeout(()=>{this.showNotif=!1,clearTimeout(r)},3e3);this.busy=!1}else setTimeout(()=>{this.getStatus(e.data)},1e3)}).catch(e=>{toastr.error((e==null?void 0:e.message)||e)})},async makeCanvasEditable(n={}){var r;this.editingImageDimensions={width:n.width||this.$refs.editorImagePreview.naturalWidth,height:n.height||this.$refs.editorImagePreview.naturalHeight},await this.$nextTick();const e=this.$refs.editorMaskCanvas;(r=this.canvasCtx)==null||r.reset(),this.canvasCtx=e.getContext("2d"),this.canvasCtx.fillStyle="black",this.canvasCtx.fillRect(0,0,e.width,e.height)},startPainting(n){this.painting=!0,this.painted=!1,this.paint(n)},stopPainting(){if(!this.painted)return;this.painting=!1,this.canvasCtx.beginPath();const n=this.$refs.editorMaskCanvas,e=document.createElement("canvas");e.width=this.editingImageDimensions.width,e.height=this.editingImageDimensions.height,e.getContext("2d").drawImage(n,0,0,e.width,e.height),e.toBlob(a=>{const l=new File([a],"mask.png",{type:"image/png"}),u=new DataTransfer;u.items.add(l),this.$refs[this.selectedTool==="sketch_to_image"?"sketchFileInput":"maskFileInput"].files=u.files,e.remove()},"image/png"),this.painted=!1},paint(n){if(!this.painting)return;const e=this.$refs.editorMaskCanvas,r=e.getBoundingClientRect(),a=(n.clientX-r.left)*(e.width/r.width),l=(n.clientY-r.top)*(e.height/r.height);this.canvasCtx.lineWidth=this.brushSize,this.canvasCtx.opacityTo=7,this.canvasCtx.lineCap="round",this.canvasCtx.strokeStyle="yellow",this.canvasCtx.lineTo(a,l),this.canvasCtx.stroke(),this.canvasCtx.beginPath(),this.canvasCtx.moveTo(a,l),this.painted=!0},setBrushSize(n){n==="-"?n=Math.max(this.brushSize-10,10):n==="+"&&(n=Math.min(this.brushSize+10,100)),this.brushSize=parseInt(n,10)},togglePromptLibraryShow(){this.promptLibraryShow=!this.promptLibraryShow},changePromptFilter(n){n!==this.promptFilter&&(this.promptFilter=n)},setSearchPromptStr(n){this.searchPromptStr=n.trim().toLowerCase()},setPrompt(n){this.prompt=n},focusOnPrompt(){this.$nextTick(()=>this.$refs.promptInput.focus())},onCreativeSuiteStageInitiated(n){n&&_.defer(()=>{this.toolbarCollapsed=!0})}});var Mo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dw(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var gr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var uw=gr.exports,lh;function cw(){return lh||(lh=1,function(o,n){(function(){var e,r="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",h="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",g=500,v="__lodash_placeholder__",y=1,S=2,C=4,A=1,R=2,M=1,z=2,N=4,B=8,G=16,ft=32,ut=64,dt=128,xt=256,nt=512,Jt=30,It="...",Vt=800,Dt=16,Ot=1,jt=2,wt=3,Ct=1/0,Ht=9007199254740991,Ni=17976931348623157e292,ii=NaN,oe=4294967295,Li=oe-1,Gh=oe>>>1,Yh=[["ary",dt],["bind",M],["bindKey",z],["curry",B],["curryRight",G],["flip",nt],["partial",ft],["partialRight",ut],["rearg",xt]],ri="[object Arguments]",Dr="[object Array]",qh="[object AsyncFunction]",Fi="[object Boolean]",ki="[object Date]",Xh="[object DOMException]",Pr="[object Error]",Rr="[object Function]",ll="[object GeneratorFunction]",Ue="[object Map]",$i="[object Number]",Vh="[object Null]",un="[object Object]",ul="[object Promise]",Kh="[object Proxy]",Bi="[object RegExp]",Ge="[object Set]",zi="[object String]",Mr="[object Symbol]",Zh="[object Undefined]",Wi="[object WeakMap]",Qh="[object WeakSet]",Hi="[object ArrayBuffer]",oi="[object DataView]",es="[object Float32Array]",ns="[object Float64Array]",is="[object Int8Array]",rs="[object Int16Array]",os="[object Int32Array]",ss="[object Uint8Array]",as="[object Uint8ClampedArray]",ls="[object Uint16Array]",us="[object Uint32Array]",Jh=/\b__p \+= '';/g,jh=/\b(__p \+=) '' \+/g,tf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,cl=/&(?:amp|lt|gt|quot|#39);/g,hl=/[&<>"']/g,ef=RegExp(cl.source),nf=RegExp(hl.source),rf=/<%-([\s\S]+?)%>/g,of=/<%([\s\S]+?)%>/g,fl=/<%=([\s\S]+?)%>/g,sf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,af=/^\w*$/,lf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cs=/[\\^$.*+?()[\]{}|]/g,uf=RegExp(cs.source),hs=/^\s+/,cf=/\s/,hf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ff=/\{\n\/\* \[wrapped with (.+)\] \*/,df=/,? & /,gf=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pf=/[()=,{}\[\]\/\s]/,mf=/\\(\\)?/g,vf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dl=/\w*$/,yf=/^[-+]0x[0-9a-f]+$/i,bf=/^0b[01]+$/i,wf=/^\[object .+?Constructor\]$/,_f=/^0o[0-7]+$/i,Sf=/^(?:0|[1-9]\d*)$/,Ef=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Or=/($^)/,xf=/['\n\r\u2028\u2029\\]/g,Nr="\\ud800-\\udfff",Cf="\\u0300-\\u036f",Tf="\\ufe20-\\ufe2f",Af="\\u20d0-\\u20ff",gl=Cf+Tf+Af,pl="\\u2700-\\u27bf",ml="a-z\\xdf-\\xf6\\xf8-\\xff",If="\\xac\\xb1\\xd7\\xf7",Df="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Pf="\\u2000-\\u206f",Rf=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vl="A-Z\\xc0-\\xd6\\xd8-\\xde",yl="\\ufe0e\\ufe0f",bl=If+Df+Pf+Rf,fs="[']",Mf="["+Nr+"]",wl="["+bl+"]",Lr="["+gl+"]",_l="\\d+",Of="["+pl+"]",Sl="["+ml+"]",El="[^"+Nr+bl+_l+pl+ml+vl+"]",ds="\\ud83c[\\udffb-\\udfff]",Nf="(?:"+Lr+"|"+ds+")",xl="[^"+Nr+"]",gs="(?:\\ud83c[\\udde6-\\uddff]){2}",ps="[\\ud800-\\udbff][\\udc00-\\udfff]",si="["+vl+"]",Cl="\\u200d",Tl="(?:"+Sl+"|"+El+")",Lf="(?:"+si+"|"+El+")",Al="(?:"+fs+"(?:d|ll|m|re|s|t|ve))?",Il="(?:"+fs+"(?:D|LL|M|RE|S|T|VE))?",Dl=Nf+"?",Pl="["+yl+"]?",Ff="(?:"+Cl+"(?:"+[xl,gs,ps].join("|")+")"+Pl+Dl+")*",kf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$f="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rl=Pl+Dl+Ff,Bf="(?:"+[Of,gs,ps].join("|")+")"+Rl,zf="(?:"+[xl+Lr+"?",Lr,gs,ps,Mf].join("|")+")",Wf=RegExp(fs,"g"),Hf=RegExp(Lr,"g"),ms=RegExp(ds+"(?="+ds+")|"+zf+Rl,"g"),Uf=RegExp([si+"?"+Sl+"+"+Al+"(?="+[wl,si,"$"].join("|")+")",Lf+"+"+Il+"(?="+[wl,si+Tl,"$"].join("|")+")",si+"?"+Tl+"+"+Al,si+"+"+Il,$f,kf,_l,Bf].join("|"),"g"),Gf=RegExp("["+Cl+Nr+gl+yl+"]"),Yf=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qf=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xf=-1,Tt={};Tt[es]=Tt[ns]=Tt[is]=Tt[rs]=Tt[os]=Tt[ss]=Tt[as]=Tt[ls]=Tt[us]=!0,Tt[ri]=Tt[Dr]=Tt[Hi]=Tt[Fi]=Tt[oi]=Tt[ki]=Tt[Pr]=Tt[Rr]=Tt[Ue]=Tt[$i]=Tt[un]=Tt[Bi]=Tt[Ge]=Tt[zi]=Tt[Wi]=!1;var St={};St[ri]=St[Dr]=St[Hi]=St[oi]=St[Fi]=St[ki]=St[es]=St[ns]=St[is]=St[rs]=St[os]=St[Ue]=St[$i]=St[un]=St[Bi]=St[Ge]=St[zi]=St[Mr]=St[ss]=St[as]=St[ls]=St[us]=!0,St[Pr]=St[Rr]=St[Wi]=!1;var Vf={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Kf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zf={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Qf={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Jf=parseFloat,jf=parseInt,Ml=typeof Mo=="object"&&Mo&&Mo.Object===Object&&Mo,td=typeof self=="object"&&self&&self.Object===Object&&self,te=Ml||td||Function("return this")(),vs=n&&!n.nodeType&&n,zn=vs&&!0&&o&&!o.nodeType&&o,Ol=zn&&zn.exports===vs,ys=Ol&&Ml.process,Ne=function(){try{var E=zn&&zn.require&&zn.require("util").types;return E||ys&&ys.binding&&ys.binding("util")}catch{}}(),Nl=Ne&&Ne.isArrayBuffer,Ll=Ne&&Ne.isDate,Fl=Ne&&Ne.isMap,kl=Ne&&Ne.isRegExp,$l=Ne&&Ne.isSet,Bl=Ne&&Ne.isTypedArray;function Ee(E,I,T){switch(T.length){case 0:return E.call(I);case 1:return E.call(I,T[0]);case 2:return E.call(I,T[0],T[1]);case 3:return E.call(I,T[0],T[1],T[2])}return E.apply(I,T)}function ed(E,I,T,W){for(var Q=-1,pt=E==null?0:E.length;++Q<pt;){var Kt=E[Q];I(W,Kt,T(Kt),E)}return W}function Le(E,I){for(var T=-1,W=E==null?0:E.length;++T<W&&I(E[T],T,E)!==!1;);return E}function nd(E,I){for(var T=E==null?0:E.length;T--&&I(E[T],T,E)!==!1;);return E}function zl(E,I){for(var T=-1,W=E==null?0:E.length;++T<W;)if(!I(E[T],T,E))return!1;return!0}function Cn(E,I){for(var T=-1,W=E==null?0:E.length,Q=0,pt=[];++T<W;){var Kt=E[T];I(Kt,T,E)&&(pt[Q++]=Kt)}return pt}function Fr(E,I){var T=E==null?0:E.length;return!!T&&ai(E,I,0)>-1}function bs(E,I,T){for(var W=-1,Q=E==null?0:E.length;++W<Q;)if(T(I,E[W]))return!0;return!1}function Pt(E,I){for(var T=-1,W=E==null?0:E.length,Q=Array(W);++T<W;)Q[T]=I(E[T],T,E);return Q}function Tn(E,I){for(var T=-1,W=I.length,Q=E.length;++T<W;)E[Q+T]=I[T];return E}function ws(E,I,T,W){var Q=-1,pt=E==null?0:E.length;for(W&&pt&&(T=E[++Q]);++Q<pt;)T=I(T,E[Q],Q,E);return T}function id(E,I,T,W){var Q=E==null?0:E.length;for(W&&Q&&(T=E[--Q]);Q--;)T=I(T,E[Q],Q,E);return T}function _s(E,I){for(var T=-1,W=E==null?0:E.length;++T<W;)if(I(E[T],T,E))return!0;return!1}var rd=Ss("length");function od(E){return E.split("")}function sd(E){return E.match(gf)||[]}function Wl(E,I,T){var W;return T(E,function(Q,pt,Kt){if(I(Q,pt,Kt))return W=pt,!1}),W}function kr(E,I,T,W){for(var Q=E.length,pt=T+(W?1:-1);W?pt--:++pt<Q;)if(I(E[pt],pt,E))return pt;return-1}function ai(E,I,T){return I===I?yd(E,I,T):kr(E,Hl,T)}function ad(E,I,T,W){for(var Q=T-1,pt=E.length;++Q<pt;)if(W(E[Q],I))return Q;return-1}function Hl(E){return E!==E}function Ul(E,I){var T=E==null?0:E.length;return T?xs(E,I)/T:ii}function Ss(E){return function(I){return I==null?e:I[E]}}function Es(E){return function(I){return E==null?e:E[I]}}function Gl(E,I,T,W,Q){return Q(E,function(pt,Kt,_t){T=W?(W=!1,pt):I(T,pt,Kt,_t)}),T}function ld(E,I){var T=E.length;for(E.sort(I);T--;)E[T]=E[T].value;return E}function xs(E,I){for(var T,W=-1,Q=E.length;++W<Q;){var pt=I(E[W]);pt!==e&&(T=T===e?pt:T+pt)}return T}function Cs(E,I){for(var T=-1,W=Array(E);++T<E;)W[T]=I(T);return W}function ud(E,I){return Pt(I,function(T){return[T,E[T]]})}function Yl(E){return E&&E.slice(0,Kl(E)+1).replace(hs,"")}function xe(E){return function(I){return E(I)}}function Ts(E,I){return Pt(I,function(T){return E[T]})}function Ui(E,I){return E.has(I)}function ql(E,I){for(var T=-1,W=E.length;++T<W&&ai(I,E[T],0)>-1;);return T}function Xl(E,I){for(var T=E.length;T--&&ai(I,E[T],0)>-1;);return T}function cd(E,I){for(var T=E.length,W=0;T--;)E[T]===I&&++W;return W}var hd=Es(Vf),fd=Es(Kf);function dd(E){return"\\"+Qf[E]}function gd(E,I){return E==null?e:E[I]}function li(E){return Gf.test(E)}function pd(E){return Yf.test(E)}function md(E){for(var I,T=[];!(I=E.next()).done;)T.push(I.value);return T}function As(E){var I=-1,T=Array(E.size);return E.forEach(function(W,Q){T[++I]=[Q,W]}),T}function Vl(E,I){return function(T){return E(I(T))}}function An(E,I){for(var T=-1,W=E.length,Q=0,pt=[];++T<W;){var Kt=E[T];(Kt===I||Kt===v)&&(E[T]=v,pt[Q++]=T)}return pt}function $r(E){var I=-1,T=Array(E.size);return E.forEach(function(W){T[++I]=W}),T}function vd(E){var I=-1,T=Array(E.size);return E.forEach(function(W){T[++I]=[W,W]}),T}function yd(E,I,T){for(var W=T-1,Q=E.length;++W<Q;)if(E[W]===I)return W;return-1}function bd(E,I,T){for(var W=T+1;W--;)if(E[W]===I)return W;return W}function ui(E){return li(E)?_d(E):rd(E)}function Ye(E){return li(E)?Sd(E):od(E)}function Kl(E){for(var I=E.length;I--&&cf.test(E.charAt(I)););return I}var wd=Es(Zf);function _d(E){for(var I=ms.lastIndex=0;ms.test(E);)++I;return I}function Sd(E){return E.match(ms)||[]}function Ed(E){return E.match(Uf)||[]}var xd=function E(I){I=I==null?te:ci.defaults(te.Object(),I,ci.pick(te,qf));var T=I.Array,W=I.Date,Q=I.Error,pt=I.Function,Kt=I.Math,_t=I.Object,Is=I.RegExp,Cd=I.String,Fe=I.TypeError,Br=T.prototype,Td=pt.prototype,hi=_t.prototype,zr=I["__core-js_shared__"],Wr=Td.toString,bt=hi.hasOwnProperty,Ad=0,Zl=function(){var t=/[^.]+$/.exec(zr&&zr.keys&&zr.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Hr=hi.toString,Id=Wr.call(_t),Dd=te._,Pd=Is("^"+Wr.call(bt).replace(cs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ur=Ol?I.Buffer:e,In=I.Symbol,Gr=I.Uint8Array,Ql=Ur?Ur.allocUnsafe:e,Yr=Vl(_t.getPrototypeOf,_t),Jl=_t.create,jl=hi.propertyIsEnumerable,qr=Br.splice,tu=In?In.isConcatSpreadable:e,Gi=In?In.iterator:e,Wn=In?In.toStringTag:e,Xr=function(){try{var t=qn(_t,"defineProperty");return t({},"",{}),t}catch{}}(),Rd=I.clearTimeout!==te.clearTimeout&&I.clearTimeout,Md=W&&W.now!==te.Date.now&&W.now,Od=I.setTimeout!==te.setTimeout&&I.setTimeout,Vr=Kt.ceil,Kr=Kt.floor,Ds=_t.getOwnPropertySymbols,Nd=Ur?Ur.isBuffer:e,eu=I.isFinite,Ld=Br.join,Fd=Vl(_t.keys,_t),Zt=Kt.max,se=Kt.min,kd=W.now,$d=I.parseInt,nu=Kt.random,Bd=Br.reverse,Ps=qn(I,"DataView"),Yi=qn(I,"Map"),Rs=qn(I,"Promise"),fi=qn(I,"Set"),qi=qn(I,"WeakMap"),Xi=qn(_t,"create"),Zr=qi&&new qi,di={},zd=Xn(Ps),Wd=Xn(Yi),Hd=Xn(Rs),Ud=Xn(fi),Gd=Xn(qi),Qr=In?In.prototype:e,Vi=Qr?Qr.valueOf:e,iu=Qr?Qr.toString:e;function p(t){if(kt(t)&&!et(t)&&!(t instanceof ct)){if(t instanceof ke)return t;if(bt.call(t,"__wrapped__"))return rc(t)}return new ke(t)}var gi=function(){function t(){}return function(i){if(!Nt(i))return{};if(Jl)return Jl(i);t.prototype=i;var s=new t;return t.prototype=e,s}}();function Jr(){}function ke(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=e}p.templateSettings={escape:rf,evaluate:of,interpolate:fl,variable:"",imports:{_:p}},p.prototype=Jr.prototype,p.prototype.constructor=p,ke.prototype=gi(Jr.prototype),ke.prototype.constructor=ke;function ct(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=oe,this.__views__=[]}function Yd(){var t=new ct(this.__wrapped__);return t.__actions__=pe(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=pe(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=pe(this.__views__),t}function qd(){if(this.__filtered__){var t=new ct(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Xd(){var t=this.__wrapped__.value(),i=this.__dir__,s=et(t),c=i<0,d=s?t.length:0,m=op(0,d,this.__views__),b=m.start,w=m.end,x=w-b,D=c?w:b-1,P=this.__iteratees__,O=P.length,k=0,U=se(x,this.__takeCount__);if(!s||!c&&d==x&&U==x)return Au(t,this.__actions__);var q=[];t:for(;x--&&k<U;){D+=i;for(var ot=-1,X=t[D];++ot<O;){var lt=P[ot],ht=lt.iteratee,Ae=lt.type,fe=ht(X);if(Ae==jt)X=fe;else if(!fe){if(Ae==Ot)continue t;break t}}q[k++]=X}return q}ct.prototype=gi(Jr.prototype),ct.prototype.constructor=ct;function Hn(t){var i=-1,s=t==null?0:t.length;for(this.clear();++i<s;){var c=t[i];this.set(c[0],c[1])}}function Vd(){this.__data__=Xi?Xi(null):{},this.size=0}function Kd(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i}function Zd(t){var i=this.__data__;if(Xi){var s=i[t];return s===f?e:s}return bt.call(i,t)?i[t]:e}function Qd(t){var i=this.__data__;return Xi?i[t]!==e:bt.call(i,t)}function Jd(t,i){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=Xi&&i===e?f:i,this}Hn.prototype.clear=Vd,Hn.prototype.delete=Kd,Hn.prototype.get=Zd,Hn.prototype.has=Qd,Hn.prototype.set=Jd;function cn(t){var i=-1,s=t==null?0:t.length;for(this.clear();++i<s;){var c=t[i];this.set(c[0],c[1])}}function jd(){this.__data__=[],this.size=0}function tg(t){var i=this.__data__,s=jr(i,t);if(s<0)return!1;var c=i.length-1;return s==c?i.pop():qr.call(i,s,1),--this.size,!0}function eg(t){var i=this.__data__,s=jr(i,t);return s<0?e:i[s][1]}function ng(t){return jr(this.__data__,t)>-1}function ig(t,i){var s=this.__data__,c=jr(s,t);return c<0?(++this.size,s.push([t,i])):s[c][1]=i,this}cn.prototype.clear=jd,cn.prototype.delete=tg,cn.prototype.get=eg,cn.prototype.has=ng,cn.prototype.set=ig;function hn(t){var i=-1,s=t==null?0:t.length;for(this.clear();++i<s;){var c=t[i];this.set(c[0],c[1])}}function rg(){this.size=0,this.__data__={hash:new Hn,map:new(Yi||cn),string:new Hn}}function og(t){var i=ho(this,t).delete(t);return this.size-=i?1:0,i}function sg(t){return ho(this,t).get(t)}function ag(t){return ho(this,t).has(t)}function lg(t,i){var s=ho(this,t),c=s.size;return s.set(t,i),this.size+=s.size==c?0:1,this}hn.prototype.clear=rg,hn.prototype.delete=og,hn.prototype.get=sg,hn.prototype.has=ag,hn.prototype.set=lg;function Un(t){var i=-1,s=t==null?0:t.length;for(this.__data__=new hn;++i<s;)this.add(t[i])}function ug(t){return this.__data__.set(t,f),this}function cg(t){return this.__data__.has(t)}Un.prototype.add=Un.prototype.push=ug,Un.prototype.has=cg;function qe(t){var i=this.__data__=new cn(t);this.size=i.size}function hg(){this.__data__=new cn,this.size=0}function fg(t){var i=this.__data__,s=i.delete(t);return this.size=i.size,s}function dg(t){return this.__data__.get(t)}function gg(t){return this.__data__.has(t)}function pg(t,i){var s=this.__data__;if(s instanceof cn){var c=s.__data__;if(!Yi||c.length<a-1)return c.push([t,i]),this.size=++s.size,this;s=this.__data__=new hn(c)}return s.set(t,i),this.size=s.size,this}qe.prototype.clear=hg,qe.prototype.delete=fg,qe.prototype.get=dg,qe.prototype.has=gg,qe.prototype.set=pg;function ru(t,i){var s=et(t),c=!s&&Vn(t),d=!s&&!c&&On(t),m=!s&&!c&&!d&&yi(t),b=s||c||d||m,w=b?Cs(t.length,Cd):[],x=w.length;for(var D in t)(i||bt.call(t,D))&&!(b&&(D=="length"||d&&(D=="offset"||D=="parent")||m&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||pn(D,x)))&&w.push(D);return w}function ou(t){var i=t.length;return i?t[Hs(0,i-1)]:e}function mg(t,i){return fo(pe(t),Gn(i,0,t.length))}function vg(t){return fo(pe(t))}function Ms(t,i,s){(s!==e&&!Xe(t[i],s)||s===e&&!(i in t))&&fn(t,i,s)}function Ki(t,i,s){var c=t[i];(!(bt.call(t,i)&&Xe(c,s))||s===e&&!(i in t))&&fn(t,i,s)}function jr(t,i){for(var s=t.length;s--;)if(Xe(t[s][0],i))return s;return-1}function yg(t,i,s,c){return Dn(t,function(d,m,b){i(c,d,s(d),b)}),c}function su(t,i){return t&&en(i,Qt(i),t)}function bg(t,i){return t&&en(i,ve(i),t)}function fn(t,i,s){i=="__proto__"&&Xr?Xr(t,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[i]=s}function Os(t,i){for(var s=-1,c=i.length,d=T(c),m=t==null;++s<c;)d[s]=m?e:da(t,i[s]);return d}function Gn(t,i,s){return t===t&&(s!==e&&(t=t<=s?t:s),i!==e&&(t=t>=i?t:i)),t}function $e(t,i,s,c,d,m){var b,w=i&y,x=i&S,D=i&C;if(s&&(b=d?s(t,c,d,m):s(t)),b!==e)return b;if(!Nt(t))return t;var P=et(t);if(P){if(b=ap(t),!w)return pe(t,b)}else{var O=ae(t),k=O==Rr||O==ll;if(On(t))return Pu(t,w);if(O==un||O==ri||k&&!d){if(b=x||k?{}:Ku(t),!w)return x?Zg(t,bg(b,t)):Kg(t,su(b,t))}else{if(!St[O])return d?t:{};b=lp(t,O,w)}}m||(m=new qe);var U=m.get(t);if(U)return U;m.set(t,b),xc(t)?t.forEach(function(X){b.add($e(X,i,s,X,t,m))}):Sc(t)&&t.forEach(function(X,lt){b.set(lt,$e(X,i,s,lt,t,m))});var q=D?x?js:Js:x?ve:Qt,ot=P?e:q(t);return Le(ot||t,function(X,lt){ot&&(lt=X,X=t[lt]),Ki(b,lt,$e(X,i,s,lt,t,m))}),b}function wg(t){var i=Qt(t);return function(s){return au(s,t,i)}}function au(t,i,s){var c=s.length;if(t==null)return!c;for(t=_t(t);c--;){var d=s[c],m=i[d],b=t[d];if(b===e&&!(d in t)||!m(b))return!1}return!0}function lu(t,i,s){if(typeof t!="function")throw new Fe(u);return nr(function(){t.apply(e,s)},i)}function Zi(t,i,s,c){var d=-1,m=Fr,b=!0,w=t.length,x=[],D=i.length;if(!w)return x;s&&(i=Pt(i,xe(s))),c?(m=bs,b=!1):i.length>=a&&(m=Ui,b=!1,i=new Un(i));t:for(;++d<w;){var P=t[d],O=s==null?P:s(P);if(P=c||P!==0?P:0,b&&O===O){for(var k=D;k--;)if(i[k]===O)continue t;x.push(P)}else m(i,O,c)||x.push(P)}return x}var Dn=Lu(tn),uu=Lu(Ls,!0);function _g(t,i){var s=!0;return Dn(t,function(c,d,m){return s=!!i(c,d,m),s}),s}function to(t,i,s){for(var c=-1,d=t.length;++c<d;){var m=t[c],b=i(m);if(b!=null&&(w===e?b===b&&!Te(b):s(b,w)))var w=b,x=m}return x}function Sg(t,i,s,c){var d=t.length;for(s=it(s),s<0&&(s=-s>d?0:d+s),c=c===e||c>d?d:it(c),c<0&&(c+=d),c=s>c?0:Tc(c);s<c;)t[s++]=i;return t}function cu(t,i){var s=[];return Dn(t,function(c,d,m){i(c,d,m)&&s.push(c)}),s}function ee(t,i,s,c,d){var m=-1,b=t.length;for(s||(s=cp),d||(d=[]);++m<b;){var w=t[m];i>0&&s(w)?i>1?ee(w,i-1,s,c,d):Tn(d,w):c||(d[d.length]=w)}return d}var Ns=Fu(),hu=Fu(!0);function tn(t,i){return t&&Ns(t,i,Qt)}function Ls(t,i){return t&&hu(t,i,Qt)}function eo(t,i){return Cn(i,function(s){return mn(t[s])})}function Yn(t,i){i=Rn(i,t);for(var s=0,c=i.length;t!=null&&s<c;)t=t[nn(i[s++])];return s&&s==c?t:e}function fu(t,i,s){var c=i(t);return et(t)?c:Tn(c,s(t))}function ce(t){return t==null?t===e?Zh:Vh:Wn&&Wn in _t(t)?rp(t):vp(t)}function Fs(t,i){return t>i}function Eg(t,i){return t!=null&&bt.call(t,i)}function xg(t,i){return t!=null&&i in _t(t)}function Cg(t,i,s){return t>=se(i,s)&&t<Zt(i,s)}function ks(t,i,s){for(var c=s?bs:Fr,d=t[0].length,m=t.length,b=m,w=T(m),x=1/0,D=[];b--;){var P=t[b];b&&i&&(P=Pt(P,xe(i))),x=se(P.length,x),w[b]=!s&&(i||d>=120&&P.length>=120)?new Un(b&&P):e}P=t[0];var O=-1,k=w[0];t:for(;++O<d&&D.length<x;){var U=P[O],q=i?i(U):U;if(U=s||U!==0?U:0,!(k?Ui(k,q):c(D,q,s))){for(b=m;--b;){var ot=w[b];if(!(ot?Ui(ot,q):c(t[b],q,s)))continue t}k&&k.push(q),D.push(U)}}return D}function Tg(t,i,s,c){return tn(t,function(d,m,b){i(c,s(d),m,b)}),c}function Qi(t,i,s){i=Rn(i,t),t=ju(t,i);var c=t==null?t:t[nn(ze(i))];return c==null?e:Ee(c,t,s)}function du(t){return kt(t)&&ce(t)==ri}function Ag(t){return kt(t)&&ce(t)==Hi}function Ig(t){return kt(t)&&ce(t)==ki}function Ji(t,i,s,c,d){return t===i?!0:t==null||i==null||!kt(t)&&!kt(i)?t!==t&&i!==i:Dg(t,i,s,c,Ji,d)}function Dg(t,i,s,c,d,m){var b=et(t),w=et(i),x=b?Dr:ae(t),D=w?Dr:ae(i);x=x==ri?un:x,D=D==ri?un:D;var P=x==un,O=D==un,k=x==D;if(k&&On(t)){if(!On(i))return!1;b=!0,P=!1}if(k&&!P)return m||(m=new qe),b||yi(t)?qu(t,i,s,c,d,m):np(t,i,x,s,c,d,m);if(!(s&A)){var U=P&&bt.call(t,"__wrapped__"),q=O&&bt.call(i,"__wrapped__");if(U||q){var ot=U?t.value():t,X=q?i.value():i;return m||(m=new qe),d(ot,X,s,c,m)}}return k?(m||(m=new qe),ip(t,i,s,c,d,m)):!1}function Pg(t){return kt(t)&&ae(t)==Ue}function $s(t,i,s,c){var d=s.length,m=d,b=!c;if(t==null)return!m;for(t=_t(t);d--;){var w=s[d];if(b&&w[2]?w[1]!==t[w[0]]:!(w[0]in t))return!1}for(;++d<m;){w=s[d];var x=w[0],D=t[x],P=w[1];if(b&&w[2]){if(D===e&&!(x in t))return!1}else{var O=new qe;if(c)var k=c(D,P,x,t,i,O);if(!(k===e?Ji(P,D,A|R,c,O):k))return!1}}return!0}function gu(t){if(!Nt(t)||fp(t))return!1;var i=mn(t)?Pd:wf;return i.test(Xn(t))}function Rg(t){return kt(t)&&ce(t)==Bi}function Mg(t){return kt(t)&&ae(t)==Ge}function Og(t){return kt(t)&&bo(t.length)&&!!Tt[ce(t)]}function pu(t){return typeof t=="function"?t:t==null?ye:typeof t=="object"?et(t)?yu(t[0],t[1]):vu(t):kc(t)}function Bs(t){if(!er(t))return Fd(t);var i=[];for(var s in _t(t))bt.call(t,s)&&s!="constructor"&&i.push(s);return i}function Ng(t){if(!Nt(t))return mp(t);var i=er(t),s=[];for(var c in t)c=="constructor"&&(i||!bt.call(t,c))||s.push(c);return s}function zs(t,i){return t<i}function mu(t,i){var s=-1,c=me(t)?T(t.length):[];return Dn(t,function(d,m,b){c[++s]=i(d,m,b)}),c}function vu(t){var i=ea(t);return i.length==1&&i[0][2]?Qu(i[0][0],i[0][1]):function(s){return s===t||$s(s,t,i)}}function yu(t,i){return ia(t)&&Zu(i)?Qu(nn(t),i):function(s){var c=da(s,t);return c===e&&c===i?ga(s,t):Ji(i,c,A|R)}}function no(t,i,s,c,d){t!==i&&Ns(i,function(m,b){if(d||(d=new qe),Nt(m))Lg(t,i,b,s,no,c,d);else{var w=c?c(oa(t,b),m,b+"",t,i,d):e;w===e&&(w=m),Ms(t,b,w)}},ve)}function Lg(t,i,s,c,d,m,b){var w=oa(t,s),x=oa(i,s),D=b.get(x);if(D){Ms(t,s,D);return}var P=m?m(w,x,s+"",t,i,b):e,O=P===e;if(O){var k=et(x),U=!k&&On(x),q=!k&&!U&&yi(x);P=x,k||U||q?et(w)?P=w:zt(w)?P=pe(w):U?(O=!1,P=Pu(x,!0)):q?(O=!1,P=Ru(x,!0)):P=[]:ir(x)||Vn(x)?(P=w,Vn(w)?P=Ac(w):(!Nt(w)||mn(w))&&(P=Ku(x))):O=!1}O&&(b.set(x,P),d(P,x,c,m,b),b.delete(x)),Ms(t,s,P)}function bu(t,i){var s=t.length;if(s)return i+=i<0?s:0,pn(i,s)?t[i]:e}function wu(t,i,s){i.length?i=Pt(i,function(m){return et(m)?function(b){return Yn(b,m.length===1?m[0]:m)}:m}):i=[ye];var c=-1;i=Pt(i,xe(Y()));var d=mu(t,function(m,b,w){var x=Pt(i,function(D){return D(m)});return{criteria:x,index:++c,value:m}});return ld(d,function(m,b){return Vg(m,b,s)})}function Fg(t,i){return _u(t,i,function(s,c){return ga(t,c)})}function _u(t,i,s){for(var c=-1,d=i.length,m={};++c<d;){var b=i[c],w=Yn(t,b);s(w,b)&&ji(m,Rn(b,t),w)}return m}function kg(t){return function(i){return Yn(i,t)}}function Ws(t,i,s,c){var d=c?ad:ai,m=-1,b=i.length,w=t;for(t===i&&(i=pe(i)),s&&(w=Pt(t,xe(s)));++m<b;)for(var x=0,D=i[m],P=s?s(D):D;(x=d(w,P,x,c))>-1;)w!==t&&qr.call(w,x,1),qr.call(t,x,1);return t}function Su(t,i){for(var s=t?i.length:0,c=s-1;s--;){var d=i[s];if(s==c||d!==m){var m=d;pn(d)?qr.call(t,d,1):Ys(t,d)}}return t}function Hs(t,i){return t+Kr(nu()*(i-t+1))}function $g(t,i,s,c){for(var d=-1,m=Zt(Vr((i-t)/(s||1)),0),b=T(m);m--;)b[c?m:++d]=t,t+=s;return b}function Us(t,i){var s="";if(!t||i<1||i>Ht)return s;do i%2&&(s+=t),i=Kr(i/2),i&&(t+=t);while(i);return s}function at(t,i){return sa(Ju(t,i,ye),t+"")}function Bg(t){return ou(bi(t))}function zg(t,i){var s=bi(t);return fo(s,Gn(i,0,s.length))}function ji(t,i,s,c){if(!Nt(t))return t;i=Rn(i,t);for(var d=-1,m=i.length,b=m-1,w=t;w!=null&&++d<m;){var x=nn(i[d]),D=s;if(x==="__proto__"||x==="constructor"||x==="prototype")return t;if(d!=b){var P=w[x];D=c?c(P,x,w):e,D===e&&(D=Nt(P)?P:pn(i[d+1])?[]:{})}Ki(w,x,D),w=w[x]}return t}var Eu=Zr?function(t,i){return Zr.set(t,i),t}:ye,Wg=Xr?function(t,i){return Xr(t,"toString",{configurable:!0,enumerable:!1,value:ma(i),writable:!0})}:ye;function Hg(t){return fo(bi(t))}function Be(t,i,s){var c=-1,d=t.length;i<0&&(i=-i>d?0:d+i),s=s>d?d:s,s<0&&(s+=d),d=i>s?0:s-i>>>0,i>>>=0;for(var m=T(d);++c<d;)m[c]=t[c+i];return m}function Ug(t,i){var s;return Dn(t,function(c,d,m){return s=i(c,d,m),!s}),!!s}function io(t,i,s){var c=0,d=t==null?c:t.length;if(typeof i=="number"&&i===i&&d<=Gh){for(;c<d;){var m=c+d>>>1,b=t[m];b!==null&&!Te(b)&&(s?b<=i:b<i)?c=m+1:d=m}return d}return Gs(t,i,ye,s)}function Gs(t,i,s,c){var d=0,m=t==null?0:t.length;if(m===0)return 0;i=s(i);for(var b=i!==i,w=i===null,x=Te(i),D=i===e;d<m;){var P=Kr((d+m)/2),O=s(t[P]),k=O!==e,U=O===null,q=O===O,ot=Te(O);if(b)var X=c||q;else D?X=q&&(c||k):w?X=q&&k&&(c||!U):x?X=q&&k&&!U&&(c||!ot):U||ot?X=!1:X=c?O<=i:O<i;X?d=P+1:m=P}return se(m,Li)}function xu(t,i){for(var s=-1,c=t.length,d=0,m=[];++s<c;){var b=t[s],w=i?i(b):b;if(!s||!Xe(w,x)){var x=w;m[d++]=b===0?0:b}}return m}function Cu(t){return typeof t=="number"?t:Te(t)?ii:+t}function Ce(t){if(typeof t=="string")return t;if(et(t))return Pt(t,Ce)+"";if(Te(t))return iu?iu.call(t):"";var i=t+"";return i=="0"&&1/t==-1/0?"-0":i}function Pn(t,i,s){var c=-1,d=Fr,m=t.length,b=!0,w=[],x=w;if(s)b=!1,d=bs;else if(m>=a){var D=i?null:tp(t);if(D)return $r(D);b=!1,d=Ui,x=new Un}else x=i?[]:w;t:for(;++c<m;){var P=t[c],O=i?i(P):P;if(P=s||P!==0?P:0,b&&O===O){for(var k=x.length;k--;)if(x[k]===O)continue t;i&&x.push(O),w.push(P)}else d(x,O,s)||(x!==w&&x.push(O),w.push(P))}return w}function Ys(t,i){return i=Rn(i,t),t=ju(t,i),t==null||delete t[nn(ze(i))]}function Tu(t,i,s,c){return ji(t,i,s(Yn(t,i)),c)}function ro(t,i,s,c){for(var d=t.length,m=c?d:-1;(c?m--:++m<d)&&i(t[m],m,t););return s?Be(t,c?0:m,c?m+1:d):Be(t,c?m+1:0,c?d:m)}function Au(t,i){var s=t;return s instanceof ct&&(s=s.value()),ws(i,function(c,d){return d.func.apply(d.thisArg,Tn([c],d.args))},s)}function qs(t,i,s){var c=t.length;if(c<2)return c?Pn(t[0]):[];for(var d=-1,m=T(c);++d<c;)for(var b=t[d],w=-1;++w<c;)w!=d&&(m[d]=Zi(m[d]||b,t[w],i,s));return Pn(ee(m,1),i,s)}function Iu(t,i,s){for(var c=-1,d=t.length,m=i.length,b={};++c<d;){var w=c<m?i[c]:e;s(b,t[c],w)}return b}function Xs(t){return zt(t)?t:[]}function Vs(t){return typeof t=="function"?t:ye}function Rn(t,i){return et(t)?t:ia(t,i)?[t]:ic(yt(t))}var Gg=at;function Mn(t,i,s){var c=t.length;return s=s===e?c:s,!i&&s>=c?t:Be(t,i,s)}var Du=Rd||function(t){return te.clearTimeout(t)};function Pu(t,i){if(i)return t.slice();var s=t.length,c=Ql?Ql(s):new t.constructor(s);return t.copy(c),c}function Ks(t){var i=new t.constructor(t.byteLength);return new Gr(i).set(new Gr(t)),i}function Yg(t,i){var s=i?Ks(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.byteLength)}function qg(t){var i=new t.constructor(t.source,dl.exec(t));return i.lastIndex=t.lastIndex,i}function Xg(t){return Vi?_t(Vi.call(t)):{}}function Ru(t,i){var s=i?Ks(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.length)}function Mu(t,i){if(t!==i){var s=t!==e,c=t===null,d=t===t,m=Te(t),b=i!==e,w=i===null,x=i===i,D=Te(i);if(!w&&!D&&!m&&t>i||m&&b&&x&&!w&&!D||c&&b&&x||!s&&x||!d)return 1;if(!c&&!m&&!D&&t<i||D&&s&&d&&!c&&!m||w&&s&&d||!b&&d||!x)return-1}return 0}function Vg(t,i,s){for(var c=-1,d=t.criteria,m=i.criteria,b=d.length,w=s.length;++c<b;){var x=Mu(d[c],m[c]);if(x){if(c>=w)return x;var D=s[c];return x*(D=="desc"?-1:1)}}return t.index-i.index}function Ou(t,i,s,c){for(var d=-1,m=t.length,b=s.length,w=-1,x=i.length,D=Zt(m-b,0),P=T(x+D),O=!c;++w<x;)P[w]=i[w];for(;++d<b;)(O||d<m)&&(P[s[d]]=t[d]);for(;D--;)P[w++]=t[d++];return P}function Nu(t,i,s,c){for(var d=-1,m=t.length,b=-1,w=s.length,x=-1,D=i.length,P=Zt(m-w,0),O=T(P+D),k=!c;++d<P;)O[d]=t[d];for(var U=d;++x<D;)O[U+x]=i[x];for(;++b<w;)(k||d<m)&&(O[U+s[b]]=t[d++]);return O}function pe(t,i){var s=-1,c=t.length;for(i||(i=T(c));++s<c;)i[s]=t[s];return i}function en(t,i,s,c){var d=!s;s||(s={});for(var m=-1,b=i.length;++m<b;){var w=i[m],x=c?c(s[w],t[w],w,s,t):e;x===e&&(x=t[w]),d?fn(s,w,x):Ki(s,w,x)}return s}function Kg(t,i){return en(t,na(t),i)}function Zg(t,i){return en(t,Xu(t),i)}function oo(t,i){return function(s,c){var d=et(s)?ed:yg,m=i?i():{};return d(s,t,Y(c,2),m)}}function pi(t){return at(function(i,s){var c=-1,d=s.length,m=d>1?s[d-1]:e,b=d>2?s[2]:e;for(m=t.length>3&&typeof m=="function"?(d--,m):e,b&&he(s[0],s[1],b)&&(m=d<3?e:m,d=1),i=_t(i);++c<d;){var w=s[c];w&&t(i,w,c,m)}return i})}function Lu(t,i){return function(s,c){if(s==null)return s;if(!me(s))return t(s,c);for(var d=s.length,m=i?d:-1,b=_t(s);(i?m--:++m<d)&&c(b[m],m,b)!==!1;);return s}}function Fu(t){return function(i,s,c){for(var d=-1,m=_t(i),b=c(i),w=b.length;w--;){var x=b[t?w:++d];if(s(m[x],x,m)===!1)break}return i}}function Qg(t,i,s){var c=i&M,d=tr(t);function m(){var b=this&&this!==te&&this instanceof m?d:t;return b.apply(c?s:this,arguments)}return m}function ku(t){return function(i){i=yt(i);var s=li(i)?Ye(i):e,c=s?s[0]:i.charAt(0),d=s?Mn(s,1).join(""):i.slice(1);return c[t]()+d}}function mi(t){return function(i){return ws(Lc(Nc(i).replace(Wf,"")),t,"")}}function tr(t){return function(){var i=arguments;switch(i.length){case 0:return new t;case 1:return new t(i[0]);case 2:return new t(i[0],i[1]);case 3:return new t(i[0],i[1],i[2]);case 4:return new t(i[0],i[1],i[2],i[3]);case 5:return new t(i[0],i[1],i[2],i[3],i[4]);case 6:return new t(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=gi(t.prototype),c=t.apply(s,i);return Nt(c)?c:s}}function Jg(t,i,s){var c=tr(t);function d(){for(var m=arguments.length,b=T(m),w=m,x=vi(d);w--;)b[w]=arguments[w];var D=m<3&&b[0]!==x&&b[m-1]!==x?[]:An(b,x);if(m-=D.length,m<s)return Hu(t,i,so,d.placeholder,e,b,D,e,e,s-m);var P=this&&this!==te&&this instanceof d?c:t;return Ee(P,this,b)}return d}function $u(t){return function(i,s,c){var d=_t(i);if(!me(i)){var m=Y(s,3);i=Qt(i),s=function(w){return m(d[w],w,d)}}var b=t(i,s,c);return b>-1?d[m?i[b]:b]:e}}function Bu(t){return gn(function(i){var s=i.length,c=s,d=ke.prototype.thru;for(t&&i.reverse();c--;){var m=i[c];if(typeof m!="function")throw new Fe(u);if(d&&!b&&co(m)=="wrapper")var b=new ke([],!0)}for(c=b?c:s;++c<s;){m=i[c];var w=co(m),x=w=="wrapper"?ta(m):e;x&&ra(x[0])&&x[1]==(dt|B|ft|xt)&&!x[4].length&&x[9]==1?b=b[co(x[0])].apply(b,x[3]):b=m.length==1&&ra(m)?b[w]():b.thru(m)}return function(){var D=arguments,P=D[0];if(b&&D.length==1&&et(P))return b.plant(P).value();for(var O=0,k=s?i[O].apply(this,D):P;++O<s;)k=i[O].call(this,k);return k}})}function so(t,i,s,c,d,m,b,w,x,D){var P=i&dt,O=i&M,k=i&z,U=i&(B|G),q=i&nt,ot=k?e:tr(t);function X(){for(var lt=arguments.length,ht=T(lt),Ae=lt;Ae--;)ht[Ae]=arguments[Ae];if(U)var fe=vi(X),Ie=cd(ht,fe);if(c&&(ht=Ou(ht,c,d,U)),m&&(ht=Nu(ht,m,b,U)),lt-=Ie,U&&lt<D){var Wt=An(ht,fe);return Hu(t,i,so,X.placeholder,s,ht,Wt,w,x,D-lt)}var Ve=O?s:this,yn=k?Ve[t]:t;return lt=ht.length,w?ht=yp(ht,w):q&&lt>1&&ht.reverse(),P&&x<lt&&(ht.length=x),this&&this!==te&&this instanceof X&&(yn=ot||tr(yn)),yn.apply(Ve,ht)}return X}function zu(t,i){return function(s,c){return Tg(s,t,i(c),{})}}function ao(t,i){return function(s,c){var d;if(s===e&&c===e)return i;if(s!==e&&(d=s),c!==e){if(d===e)return c;typeof s=="string"||typeof c=="string"?(s=Ce(s),c=Ce(c)):(s=Cu(s),c=Cu(c)),d=t(s,c)}return d}}function Zs(t){return gn(function(i){return i=Pt(i,xe(Y())),at(function(s){var c=this;return t(i,function(d){return Ee(d,c,s)})})})}function lo(t,i){i=i===e?" ":Ce(i);var s=i.length;if(s<2)return s?Us(i,t):i;var c=Us(i,Vr(t/ui(i)));return li(i)?Mn(Ye(c),0,t).join(""):c.slice(0,t)}function jg(t,i,s,c){var d=i&M,m=tr(t);function b(){for(var w=-1,x=arguments.length,D=-1,P=c.length,O=T(P+x),k=this&&this!==te&&this instanceof b?m:t;++D<P;)O[D]=c[D];for(;x--;)O[D++]=arguments[++w];return Ee(k,d?s:this,O)}return b}function Wu(t){return function(i,s,c){return c&&typeof c!="number"&&he(i,s,c)&&(s=c=e),i=vn(i),s===e?(s=i,i=0):s=vn(s),c=c===e?i<s?1:-1:vn(c),$g(i,s,c,t)}}function uo(t){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=We(i),s=We(s)),t(i,s)}}function Hu(t,i,s,c,d,m,b,w,x,D){var P=i&B,O=P?b:e,k=P?e:b,U=P?m:e,q=P?e:m;i|=P?ft:ut,i&=~(P?ut:ft),i&N||(i&=-4);var ot=[t,i,d,U,O,q,k,w,x,D],X=s.apply(e,ot);return ra(t)&&tc(X,ot),X.placeholder=c,ec(X,t,i)}function Qs(t){var i=Kt[t];return function(s,c){if(s=We(s),c=c==null?0:se(it(c),292),c&&eu(s)){var d=(yt(s)+"e").split("e"),m=i(d[0]+"e"+(+d[1]+c));return d=(yt(m)+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return i(s)}}var tp=fi&&1/$r(new fi([,-0]))[1]==Ct?function(t){return new fi(t)}:ba;function Uu(t){return function(i){var s=ae(i);return s==Ue?As(i):s==Ge?vd(i):ud(i,t(i))}}function dn(t,i,s,c,d,m,b,w){var x=i&z;if(!x&&typeof t!="function")throw new Fe(u);var D=c?c.length:0;if(D||(i&=-97,c=d=e),b=b===e?b:Zt(it(b),0),w=w===e?w:it(w),D-=d?d.length:0,i&ut){var P=c,O=d;c=d=e}var k=x?e:ta(t),U=[t,i,s,c,d,P,O,m,b,w];if(k&&pp(U,k),t=U[0],i=U[1],s=U[2],c=U[3],d=U[4],w=U[9]=U[9]===e?x?0:t.length:Zt(U[9]-D,0),!w&&i&(B|G)&&(i&=-25),!i||i==M)var q=Qg(t,i,s);else i==B||i==G?q=Jg(t,i,w):(i==ft||i==(M|ft))&&!d.length?q=jg(t,i,s,c):q=so.apply(e,U);var ot=k?Eu:tc;return ec(ot(q,U),t,i)}function Gu(t,i,s,c){return t===e||Xe(t,hi[s])&&!bt.call(c,s)?i:t}function Yu(t,i,s,c,d,m){return Nt(t)&&Nt(i)&&(m.set(i,t),no(t,i,e,Yu,m),m.delete(i)),t}function ep(t){return ir(t)?e:t}function qu(t,i,s,c,d,m){var b=s&A,w=t.length,x=i.length;if(w!=x&&!(b&&x>w))return!1;var D=m.get(t),P=m.get(i);if(D&&P)return D==i&&P==t;var O=-1,k=!0,U=s&R?new Un:e;for(m.set(t,i),m.set(i,t);++O<w;){var q=t[O],ot=i[O];if(c)var X=b?c(ot,q,O,i,t,m):c(q,ot,O,t,i,m);if(X!==e){if(X)continue;k=!1;break}if(U){if(!_s(i,function(lt,ht){if(!Ui(U,ht)&&(q===lt||d(q,lt,s,c,m)))return U.push(ht)})){k=!1;break}}else if(!(q===ot||d(q,ot,s,c,m))){k=!1;break}}return m.delete(t),m.delete(i),k}function np(t,i,s,c,d,m,b){switch(s){case oi:if(t.byteLength!=i.byteLength||t.byteOffset!=i.byteOffset)return!1;t=t.buffer,i=i.buffer;case Hi:return!(t.byteLength!=i.byteLength||!m(new Gr(t),new Gr(i)));case Fi:case ki:case $i:return Xe(+t,+i);case Pr:return t.name==i.name&&t.message==i.message;case Bi:case zi:return t==i+"";case Ue:var w=As;case Ge:var x=c&A;if(w||(w=$r),t.size!=i.size&&!x)return!1;var D=b.get(t);if(D)return D==i;c|=R,b.set(t,i);var P=qu(w(t),w(i),c,d,m,b);return b.delete(t),P;case Mr:if(Vi)return Vi.call(t)==Vi.call(i)}return!1}function ip(t,i,s,c,d,m){var b=s&A,w=Js(t),x=w.length,D=Js(i),P=D.length;if(x!=P&&!b)return!1;for(var O=x;O--;){var k=w[O];if(!(b?k in i:bt.call(i,k)))return!1}var U=m.get(t),q=m.get(i);if(U&&q)return U==i&&q==t;var ot=!0;m.set(t,i),m.set(i,t);for(var X=b;++O<x;){k=w[O];var lt=t[k],ht=i[k];if(c)var Ae=b?c(ht,lt,k,i,t,m):c(lt,ht,k,t,i,m);if(!(Ae===e?lt===ht||d(lt,ht,s,c,m):Ae)){ot=!1;break}X||(X=k=="constructor")}if(ot&&!X){var fe=t.constructor,Ie=i.constructor;fe!=Ie&&"constructor"in t&&"constructor"in i&&!(typeof fe=="function"&&fe instanceof fe&&typeof Ie=="function"&&Ie instanceof Ie)&&(ot=!1)}return m.delete(t),m.delete(i),ot}function gn(t){return sa(Ju(t,e,ac),t+"")}function Js(t){return fu(t,Qt,na)}function js(t){return fu(t,ve,Xu)}var ta=Zr?function(t){return Zr.get(t)}:ba;function co(t){for(var i=t.name+"",s=di[i],c=bt.call(di,i)?s.length:0;c--;){var d=s[c],m=d.func;if(m==null||m==t)return d.name}return i}function vi(t){var i=bt.call(p,"placeholder")?p:t;return i.placeholder}function Y(){var t=p.iteratee||va;return t=t===va?pu:t,arguments.length?t(arguments[0],arguments[1]):t}function ho(t,i){var s=t.__data__;return hp(i)?s[typeof i=="string"?"string":"hash"]:s.map}function ea(t){for(var i=Qt(t),s=i.length;s--;){var c=i[s],d=t[c];i[s]=[c,d,Zu(d)]}return i}function qn(t,i){var s=gd(t,i);return gu(s)?s:e}function rp(t){var i=bt.call(t,Wn),s=t[Wn];try{t[Wn]=e;var c=!0}catch{}var d=Hr.call(t);return c&&(i?t[Wn]=s:delete t[Wn]),d}var na=Ds?function(t){return t==null?[]:(t=_t(t),Cn(Ds(t),function(i){return jl.call(t,i)}))}:wa,Xu=Ds?function(t){for(var i=[];t;)Tn(i,na(t)),t=Yr(t);return i}:wa,ae=ce;(Ps&&ae(new Ps(new ArrayBuffer(1)))!=oi||Yi&&ae(new Yi)!=Ue||Rs&&ae(Rs.resolve())!=ul||fi&&ae(new fi)!=Ge||qi&&ae(new qi)!=Wi)&&(ae=function(t){var i=ce(t),s=i==un?t.constructor:e,c=s?Xn(s):"";if(c)switch(c){case zd:return oi;case Wd:return Ue;case Hd:return ul;case Ud:return Ge;case Gd:return Wi}return i});function op(t,i,s){for(var c=-1,d=s.length;++c<d;){var m=s[c],b=m.size;switch(m.type){case"drop":t+=b;break;case"dropRight":i-=b;break;case"take":i=se(i,t+b);break;case"takeRight":t=Zt(t,i-b);break}}return{start:t,end:i}}function sp(t){var i=t.match(ff);return i?i[1].split(df):[]}function Vu(t,i,s){i=Rn(i,t);for(var c=-1,d=i.length,m=!1;++c<d;){var b=nn(i[c]);if(!(m=t!=null&&s(t,b)))break;t=t[b]}return m||++c!=d?m:(d=t==null?0:t.length,!!d&&bo(d)&&pn(b,d)&&(et(t)||Vn(t)))}function ap(t){var i=t.length,s=new t.constructor(i);return i&&typeof t[0]=="string"&&bt.call(t,"index")&&(s.index=t.index,s.input=t.input),s}function Ku(t){return typeof t.constructor=="function"&&!er(t)?gi(Yr(t)):{}}function lp(t,i,s){var c=t.constructor;switch(i){case Hi:return Ks(t);case Fi:case ki:return new c(+t);case oi:return Yg(t,s);case es:case ns:case is:case rs:case os:case ss:case as:case ls:case us:return Ru(t,s);case Ue:return new c;case $i:case zi:return new c(t);case Bi:return qg(t);case Ge:return new c;case Mr:return Xg(t)}}function up(t,i){var s=i.length;if(!s)return t;var c=s-1;return i[c]=(s>1?"& ":"")+i[c],i=i.join(s>2?", ":" "),t.replace(hf,`{
/* [wrapped with `+i+`] */
`)}function cp(t){return et(t)||Vn(t)||!!(tu&&t&&t[tu])}function pn(t,i){var s=typeof t;return i=i??Ht,!!i&&(s=="number"||s!="symbol"&&Sf.test(t))&&t>-1&&t%1==0&&t<i}function he(t,i,s){if(!Nt(s))return!1;var c=typeof i;return(c=="number"?me(s)&&pn(i,s.length):c=="string"&&i in s)?Xe(s[i],t):!1}function ia(t,i){if(et(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||Te(t)?!0:af.test(t)||!sf.test(t)||i!=null&&t in _t(i)}function hp(t){var i=typeof t;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?t!=="__proto__":t===null}function ra(t){var i=co(t),s=p[i];if(typeof s!="function"||!(i in ct.prototype))return!1;if(t===s)return!0;var c=ta(s);return!!c&&t===c[0]}function fp(t){return!!Zl&&Zl in t}var dp=zr?mn:_a;function er(t){var i=t&&t.constructor,s=typeof i=="function"&&i.prototype||hi;return t===s}function Zu(t){return t===t&&!Nt(t)}function Qu(t,i){return function(s){return s==null?!1:s[t]===i&&(i!==e||t in _t(s))}}function gp(t){var i=vo(t,function(c){return s.size===g&&s.clear(),c}),s=i.cache;return i}function pp(t,i){var s=t[1],c=i[1],d=s|c,m=d<(M|z|dt),b=c==dt&&s==B||c==dt&&s==xt&&t[7].length<=i[8]||c==(dt|xt)&&i[7].length<=i[8]&&s==B;if(!(m||b))return t;c&M&&(t[2]=i[2],d|=s&M?0:N);var w=i[3];if(w){var x=t[3];t[3]=x?Ou(x,w,i[4]):w,t[4]=x?An(t[3],v):i[4]}return w=i[5],w&&(x=t[5],t[5]=x?Nu(x,w,i[6]):w,t[6]=x?An(t[5],v):i[6]),w=i[7],w&&(t[7]=w),c&dt&&(t[8]=t[8]==null?i[8]:se(t[8],i[8])),t[9]==null&&(t[9]=i[9]),t[0]=i[0],t[1]=d,t}function mp(t){var i=[];if(t!=null)for(var s in _t(t))i.push(s);return i}function vp(t){return Hr.call(t)}function Ju(t,i,s){return i=Zt(i===e?t.length-1:i,0),function(){for(var c=arguments,d=-1,m=Zt(c.length-i,0),b=T(m);++d<m;)b[d]=c[i+d];d=-1;for(var w=T(i+1);++d<i;)w[d]=c[d];return w[i]=s(b),Ee(t,this,w)}}function ju(t,i){return i.length<2?t:Yn(t,Be(i,0,-1))}function yp(t,i){for(var s=t.length,c=se(i.length,s),d=pe(t);c--;){var m=i[c];t[c]=pn(m,s)?d[m]:e}return t}function oa(t,i){if(!(i==="constructor"&&typeof t[i]=="function")&&i!="__proto__")return t[i]}var tc=nc(Eu),nr=Od||function(t,i){return te.setTimeout(t,i)},sa=nc(Wg);function ec(t,i,s){var c=i+"";return sa(t,up(c,bp(sp(c),s)))}function nc(t){var i=0,s=0;return function(){var c=kd(),d=Dt-(c-s);if(s=c,d>0){if(++i>=Vt)return arguments[0]}else i=0;return t.apply(e,arguments)}}function fo(t,i){var s=-1,c=t.length,d=c-1;for(i=i===e?c:i;++s<i;){var m=Hs(s,d),b=t[m];t[m]=t[s],t[s]=b}return t.length=i,t}var ic=gp(function(t){var i=[];return t.charCodeAt(0)===46&&i.push(""),t.replace(lf,function(s,c,d,m){i.push(d?m.replace(mf,"$1"):c||s)}),i});function nn(t){if(typeof t=="string"||Te(t))return t;var i=t+"";return i=="0"&&1/t==-1/0?"-0":i}function Xn(t){if(t!=null){try{return Wr.call(t)}catch{}try{return t+""}catch{}}return""}function bp(t,i){return Le(Yh,function(s){var c="_."+s[0];i&s[1]&&!Fr(t,c)&&t.push(c)}),t.sort()}function rc(t){if(t instanceof ct)return t.clone();var i=new ke(t.__wrapped__,t.__chain__);return i.__actions__=pe(t.__actions__),i.__index__=t.__index__,i.__values__=t.__values__,i}function wp(t,i,s){(s?he(t,i,s):i===e)?i=1:i=Zt(it(i),0);var c=t==null?0:t.length;if(!c||i<1)return[];for(var d=0,m=0,b=T(Vr(c/i));d<c;)b[m++]=Be(t,d,d+=i);return b}function _p(t){for(var i=-1,s=t==null?0:t.length,c=0,d=[];++i<s;){var m=t[i];m&&(d[c++]=m)}return d}function Sp(){var t=arguments.length;if(!t)return[];for(var i=T(t-1),s=arguments[0],c=t;c--;)i[c-1]=arguments[c];return Tn(et(s)?pe(s):[s],ee(i,1))}var Ep=at(function(t,i){return zt(t)?Zi(t,ee(i,1,zt,!0)):[]}),xp=at(function(t,i){var s=ze(i);return zt(s)&&(s=e),zt(t)?Zi(t,ee(i,1,zt,!0),Y(s,2)):[]}),Cp=at(function(t,i){var s=ze(i);return zt(s)&&(s=e),zt(t)?Zi(t,ee(i,1,zt,!0),e,s):[]});function Tp(t,i,s){var c=t==null?0:t.length;return c?(i=s||i===e?1:it(i),Be(t,i<0?0:i,c)):[]}function Ap(t,i,s){var c=t==null?0:t.length;return c?(i=s||i===e?1:it(i),i=c-i,Be(t,0,i<0?0:i)):[]}function Ip(t,i){return t&&t.length?ro(t,Y(i,3),!0,!0):[]}function Dp(t,i){return t&&t.length?ro(t,Y(i,3),!0):[]}function Pp(t,i,s,c){var d=t==null?0:t.length;return d?(s&&typeof s!="number"&&he(t,i,s)&&(s=0,c=d),Sg(t,i,s,c)):[]}function oc(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=s==null?0:it(s);return d<0&&(d=Zt(c+d,0)),kr(t,Y(i,3),d)}function sc(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=c-1;return s!==e&&(d=it(s),d=s<0?Zt(c+d,0):se(d,c-1)),kr(t,Y(i,3),d,!0)}function ac(t){var i=t==null?0:t.length;return i?ee(t,1):[]}function Rp(t){var i=t==null?0:t.length;return i?ee(t,Ct):[]}function Mp(t,i){var s=t==null?0:t.length;return s?(i=i===e?1:it(i),ee(t,i)):[]}function Op(t){for(var i=-1,s=t==null?0:t.length,c={};++i<s;){var d=t[i];c[d[0]]=d[1]}return c}function lc(t){return t&&t.length?t[0]:e}function Np(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=s==null?0:it(s);return d<0&&(d=Zt(c+d,0)),ai(t,i,d)}function Lp(t){var i=t==null?0:t.length;return i?Be(t,0,-1):[]}var Fp=at(function(t){var i=Pt(t,Xs);return i.length&&i[0]===t[0]?ks(i):[]}),kp=at(function(t){var i=ze(t),s=Pt(t,Xs);return i===ze(s)?i=e:s.pop(),s.length&&s[0]===t[0]?ks(s,Y(i,2)):[]}),$p=at(function(t){var i=ze(t),s=Pt(t,Xs);return i=typeof i=="function"?i:e,i&&s.pop(),s.length&&s[0]===t[0]?ks(s,e,i):[]});function Bp(t,i){return t==null?"":Ld.call(t,i)}function ze(t){var i=t==null?0:t.length;return i?t[i-1]:e}function zp(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=c;return s!==e&&(d=it(s),d=d<0?Zt(c+d,0):se(d,c-1)),i===i?bd(t,i,d):kr(t,Hl,d,!0)}function Wp(t,i){return t&&t.length?bu(t,it(i)):e}var Hp=at(uc);function uc(t,i){return t&&t.length&&i&&i.length?Ws(t,i):t}function Up(t,i,s){return t&&t.length&&i&&i.length?Ws(t,i,Y(s,2)):t}function Gp(t,i,s){return t&&t.length&&i&&i.length?Ws(t,i,e,s):t}var Yp=gn(function(t,i){var s=t==null?0:t.length,c=Os(t,i);return Su(t,Pt(i,function(d){return pn(d,s)?+d:d}).sort(Mu)),c});function qp(t,i){var s=[];if(!(t&&t.length))return s;var c=-1,d=[],m=t.length;for(i=Y(i,3);++c<m;){var b=t[c];i(b,c,t)&&(s.push(b),d.push(c))}return Su(t,d),s}function aa(t){return t==null?t:Bd.call(t)}function Xp(t,i,s){var c=t==null?0:t.length;return c?(s&&typeof s!="number"&&he(t,i,s)?(i=0,s=c):(i=i==null?0:it(i),s=s===e?c:it(s)),Be(t,i,s)):[]}function Vp(t,i){return io(t,i)}function Kp(t,i,s){return Gs(t,i,Y(s,2))}function Zp(t,i){var s=t==null?0:t.length;if(s){var c=io(t,i);if(c<s&&Xe(t[c],i))return c}return-1}function Qp(t,i){return io(t,i,!0)}function Jp(t,i,s){return Gs(t,i,Y(s,2),!0)}function jp(t,i){var s=t==null?0:t.length;if(s){var c=io(t,i,!0)-1;if(Xe(t[c],i))return c}return-1}function tm(t){return t&&t.length?xu(t):[]}function em(t,i){return t&&t.length?xu(t,Y(i,2)):[]}function nm(t){var i=t==null?0:t.length;return i?Be(t,1,i):[]}function im(t,i,s){return t&&t.length?(i=s||i===e?1:it(i),Be(t,0,i<0?0:i)):[]}function rm(t,i,s){var c=t==null?0:t.length;return c?(i=s||i===e?1:it(i),i=c-i,Be(t,i<0?0:i,c)):[]}function om(t,i){return t&&t.length?ro(t,Y(i,3),!1,!0):[]}function sm(t,i){return t&&t.length?ro(t,Y(i,3)):[]}var am=at(function(t){return Pn(ee(t,1,zt,!0))}),lm=at(function(t){var i=ze(t);return zt(i)&&(i=e),Pn(ee(t,1,zt,!0),Y(i,2))}),um=at(function(t){var i=ze(t);return i=typeof i=="function"?i:e,Pn(ee(t,1,zt,!0),e,i)});function cm(t){return t&&t.length?Pn(t):[]}function hm(t,i){return t&&t.length?Pn(t,Y(i,2)):[]}function fm(t,i){return i=typeof i=="function"?i:e,t&&t.length?Pn(t,e,i):[]}function la(t){if(!(t&&t.length))return[];var i=0;return t=Cn(t,function(s){if(zt(s))return i=Zt(s.length,i),!0}),Cs(i,function(s){return Pt(t,Ss(s))})}function cc(t,i){if(!(t&&t.length))return[];var s=la(t);return i==null?s:Pt(s,function(c){return Ee(i,e,c)})}var dm=at(function(t,i){return zt(t)?Zi(t,i):[]}),gm=at(function(t){return qs(Cn(t,zt))}),pm=at(function(t){var i=ze(t);return zt(i)&&(i=e),qs(Cn(t,zt),Y(i,2))}),mm=at(function(t){var i=ze(t);return i=typeof i=="function"?i:e,qs(Cn(t,zt),e,i)}),vm=at(la);function ym(t,i){return Iu(t||[],i||[],Ki)}function bm(t,i){return Iu(t||[],i||[],ji)}var wm=at(function(t){var i=t.length,s=i>1?t[i-1]:e;return s=typeof s=="function"?(t.pop(),s):e,cc(t,s)});function hc(t){var i=p(t);return i.__chain__=!0,i}function _m(t,i){return i(t),t}function go(t,i){return i(t)}var Sm=gn(function(t){var i=t.length,s=i?t[0]:0,c=this.__wrapped__,d=function(m){return Os(m,t)};return i>1||this.__actions__.length||!(c instanceof ct)||!pn(s)?this.thru(d):(c=c.slice(s,+s+(i?1:0)),c.__actions__.push({func:go,args:[d],thisArg:e}),new ke(c,this.__chain__).thru(function(m){return i&&!m.length&&m.push(e),m}))});function Em(){return hc(this)}function xm(){return new ke(this.value(),this.__chain__)}function Cm(){this.__values__===e&&(this.__values__=Cc(this.value()));var t=this.__index__>=this.__values__.length,i=t?e:this.__values__[this.__index__++];return{done:t,value:i}}function Tm(){return this}function Am(t){for(var i,s=this;s instanceof Jr;){var c=rc(s);c.__index__=0,c.__values__=e,i?d.__wrapped__=c:i=c;var d=c;s=s.__wrapped__}return d.__wrapped__=t,i}function Im(){var t=this.__wrapped__;if(t instanceof ct){var i=t;return this.__actions__.length&&(i=new ct(this)),i=i.reverse(),i.__actions__.push({func:go,args:[aa],thisArg:e}),new ke(i,this.__chain__)}return this.thru(aa)}function Dm(){return Au(this.__wrapped__,this.__actions__)}var Pm=oo(function(t,i,s){bt.call(t,s)?++t[s]:fn(t,s,1)});function Rm(t,i,s){var c=et(t)?zl:_g;return s&&he(t,i,s)&&(i=e),c(t,Y(i,3))}function Mm(t,i){var s=et(t)?Cn:cu;return s(t,Y(i,3))}var Om=$u(oc),Nm=$u(sc);function Lm(t,i){return ee(po(t,i),1)}function Fm(t,i){return ee(po(t,i),Ct)}function km(t,i,s){return s=s===e?1:it(s),ee(po(t,i),s)}function fc(t,i){var s=et(t)?Le:Dn;return s(t,Y(i,3))}function dc(t,i){var s=et(t)?nd:uu;return s(t,Y(i,3))}var $m=oo(function(t,i,s){bt.call(t,s)?t[s].push(i):fn(t,s,[i])});function Bm(t,i,s,c){t=me(t)?t:bi(t),s=s&&!c?it(s):0;var d=t.length;return s<0&&(s=Zt(d+s,0)),wo(t)?s<=d&&t.indexOf(i,s)>-1:!!d&&ai(t,i,s)>-1}var zm=at(function(t,i,s){var c=-1,d=typeof i=="function",m=me(t)?T(t.length):[];return Dn(t,function(b){m[++c]=d?Ee(i,b,s):Qi(b,i,s)}),m}),Wm=oo(function(t,i,s){fn(t,s,i)});function po(t,i){var s=et(t)?Pt:mu;return s(t,Y(i,3))}function Hm(t,i,s,c){return t==null?[]:(et(i)||(i=i==null?[]:[i]),s=c?e:s,et(s)||(s=s==null?[]:[s]),wu(t,i,s))}var Um=oo(function(t,i,s){t[s?0:1].push(i)},function(){return[[],[]]});function Gm(t,i,s){var c=et(t)?ws:Gl,d=arguments.length<3;return c(t,Y(i,4),s,d,Dn)}function Ym(t,i,s){var c=et(t)?id:Gl,d=arguments.length<3;return c(t,Y(i,4),s,d,uu)}function qm(t,i){var s=et(t)?Cn:cu;return s(t,yo(Y(i,3)))}function Xm(t){var i=et(t)?ou:Bg;return i(t)}function Vm(t,i,s){(s?he(t,i,s):i===e)?i=1:i=it(i);var c=et(t)?mg:zg;return c(t,i)}function Km(t){var i=et(t)?vg:Hg;return i(t)}function Zm(t){if(t==null)return 0;if(me(t))return wo(t)?ui(t):t.length;var i=ae(t);return i==Ue||i==Ge?t.size:Bs(t).length}function Qm(t,i,s){var c=et(t)?_s:Ug;return s&&he(t,i,s)&&(i=e),c(t,Y(i,3))}var Jm=at(function(t,i){if(t==null)return[];var s=i.length;return s>1&&he(t,i[0],i[1])?i=[]:s>2&&he(i[0],i[1],i[2])&&(i=[i[0]]),wu(t,ee(i,1),[])}),mo=Md||function(){return te.Date.now()};function jm(t,i){if(typeof i!="function")throw new Fe(u);return t=it(t),function(){if(--t<1)return i.apply(this,arguments)}}function gc(t,i,s){return i=s?e:i,i=t&&i==null?t.length:i,dn(t,dt,e,e,e,e,i)}function pc(t,i){var s;if(typeof i!="function")throw new Fe(u);return t=it(t),function(){return--t>0&&(s=i.apply(this,arguments)),t<=1&&(i=e),s}}var ua=at(function(t,i,s){var c=M;if(s.length){var d=An(s,vi(ua));c|=ft}return dn(t,c,i,s,d)}),mc=at(function(t,i,s){var c=M|z;if(s.length){var d=An(s,vi(mc));c|=ft}return dn(i,c,t,s,d)});function vc(t,i,s){i=s?e:i;var c=dn(t,B,e,e,e,e,e,i);return c.placeholder=vc.placeholder,c}function yc(t,i,s){i=s?e:i;var c=dn(t,G,e,e,e,e,e,i);return c.placeholder=yc.placeholder,c}function bc(t,i,s){var c,d,m,b,w,x,D=0,P=!1,O=!1,k=!0;if(typeof t!="function")throw new Fe(u);i=We(i)||0,Nt(s)&&(P=!!s.leading,O="maxWait"in s,m=O?Zt(We(s.maxWait)||0,i):m,k="trailing"in s?!!s.trailing:k);function U(Wt){var Ve=c,yn=d;return c=d=e,D=Wt,b=t.apply(yn,Ve),b}function q(Wt){return D=Wt,w=nr(lt,i),P?U(Wt):b}function ot(Wt){var Ve=Wt-x,yn=Wt-D,$c=i-Ve;return O?se($c,m-yn):$c}function X(Wt){var Ve=Wt-x,yn=Wt-D;return x===e||Ve>=i||Ve<0||O&&yn>=m}function lt(){var Wt=mo();if(X(Wt))return ht(Wt);w=nr(lt,ot(Wt))}function ht(Wt){return w=e,k&&c?U(Wt):(c=d=e,b)}function Ae(){w!==e&&Du(w),D=0,c=x=d=w=e}function fe(){return w===e?b:ht(mo())}function Ie(){var Wt=mo(),Ve=X(Wt);if(c=arguments,d=this,x=Wt,Ve){if(w===e)return q(x);if(O)return Du(w),w=nr(lt,i),U(x)}return w===e&&(w=nr(lt,i)),b}return Ie.cancel=Ae,Ie.flush=fe,Ie}var tv=at(function(t,i){return lu(t,1,i)}),ev=at(function(t,i,s){return lu(t,We(i)||0,s)});function nv(t){return dn(t,nt)}function vo(t,i){if(typeof t!="function"||i!=null&&typeof i!="function")throw new Fe(u);var s=function(){var c=arguments,d=i?i.apply(this,c):c[0],m=s.cache;if(m.has(d))return m.get(d);var b=t.apply(this,c);return s.cache=m.set(d,b)||m,b};return s.cache=new(vo.Cache||hn),s}vo.Cache=hn;function yo(t){if(typeof t!="function")throw new Fe(u);return function(){var i=arguments;switch(i.length){case 0:return!t.call(this);case 1:return!t.call(this,i[0]);case 2:return!t.call(this,i[0],i[1]);case 3:return!t.call(this,i[0],i[1],i[2])}return!t.apply(this,i)}}function iv(t){return pc(2,t)}var rv=Gg(function(t,i){i=i.length==1&&et(i[0])?Pt(i[0],xe(Y())):Pt(ee(i,1),xe(Y()));var s=i.length;return at(function(c){for(var d=-1,m=se(c.length,s);++d<m;)c[d]=i[d].call(this,c[d]);return Ee(t,this,c)})}),ca=at(function(t,i){var s=An(i,vi(ca));return dn(t,ft,e,i,s)}),wc=at(function(t,i){var s=An(i,vi(wc));return dn(t,ut,e,i,s)}),ov=gn(function(t,i){return dn(t,xt,e,e,e,i)});function sv(t,i){if(typeof t!="function")throw new Fe(u);return i=i===e?i:it(i),at(t,i)}function av(t,i){if(typeof t!="function")throw new Fe(u);return i=i==null?0:Zt(it(i),0),at(function(s){var c=s[i],d=Mn(s,0,i);return c&&Tn(d,c),Ee(t,this,d)})}function lv(t,i,s){var c=!0,d=!0;if(typeof t!="function")throw new Fe(u);return Nt(s)&&(c="leading"in s?!!s.leading:c,d="trailing"in s?!!s.trailing:d),bc(t,i,{leading:c,maxWait:i,trailing:d})}function uv(t){return gc(t,1)}function cv(t,i){return ca(Vs(i),t)}function hv(){if(!arguments.length)return[];var t=arguments[0];return et(t)?t:[t]}function fv(t){return $e(t,C)}function dv(t,i){return i=typeof i=="function"?i:e,$e(t,C,i)}function gv(t){return $e(t,y|C)}function pv(t,i){return i=typeof i=="function"?i:e,$e(t,y|C,i)}function mv(t,i){return i==null||au(t,i,Qt(i))}function Xe(t,i){return t===i||t!==t&&i!==i}var vv=uo(Fs),yv=uo(function(t,i){return t>=i}),Vn=du(function(){return arguments}())?du:function(t){return kt(t)&&bt.call(t,"callee")&&!jl.call(t,"callee")},et=T.isArray,bv=Nl?xe(Nl):Ag;function me(t){return t!=null&&bo(t.length)&&!mn(t)}function zt(t){return kt(t)&&me(t)}function wv(t){return t===!0||t===!1||kt(t)&&ce(t)==Fi}var On=Nd||_a,_v=Ll?xe(Ll):Ig;function Sv(t){return kt(t)&&t.nodeType===1&&!ir(t)}function Ev(t){if(t==null)return!0;if(me(t)&&(et(t)||typeof t=="string"||typeof t.splice=="function"||On(t)||yi(t)||Vn(t)))return!t.length;var i=ae(t);if(i==Ue||i==Ge)return!t.size;if(er(t))return!Bs(t).length;for(var s in t)if(bt.call(t,s))return!1;return!0}function xv(t,i){return Ji(t,i)}function Cv(t,i,s){s=typeof s=="function"?s:e;var c=s?s(t,i):e;return c===e?Ji(t,i,e,s):!!c}function ha(t){if(!kt(t))return!1;var i=ce(t);return i==Pr||i==Xh||typeof t.message=="string"&&typeof t.name=="string"&&!ir(t)}function Tv(t){return typeof t=="number"&&eu(t)}function mn(t){if(!Nt(t))return!1;var i=ce(t);return i==Rr||i==ll||i==qh||i==Kh}function _c(t){return typeof t=="number"&&t==it(t)}function bo(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ht}function Nt(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}function kt(t){return t!=null&&typeof t=="object"}var Sc=Fl?xe(Fl):Pg;function Av(t,i){return t===i||$s(t,i,ea(i))}function Iv(t,i,s){return s=typeof s=="function"?s:e,$s(t,i,ea(i),s)}function Dv(t){return Ec(t)&&t!=+t}function Pv(t){if(dp(t))throw new Q(l);return gu(t)}function Rv(t){return t===null}function Mv(t){return t==null}function Ec(t){return typeof t=="number"||kt(t)&&ce(t)==$i}function ir(t){if(!kt(t)||ce(t)!=un)return!1;var i=Yr(t);if(i===null)return!0;var s=bt.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&Wr.call(s)==Id}var fa=kl?xe(kl):Rg;function Ov(t){return _c(t)&&t>=-9007199254740991&&t<=Ht}var xc=$l?xe($l):Mg;function wo(t){return typeof t=="string"||!et(t)&&kt(t)&&ce(t)==zi}function Te(t){return typeof t=="symbol"||kt(t)&&ce(t)==Mr}var yi=Bl?xe(Bl):Og;function Nv(t){return t===e}function Lv(t){return kt(t)&&ae(t)==Wi}function Fv(t){return kt(t)&&ce(t)==Qh}var kv=uo(zs),$v=uo(function(t,i){return t<=i});function Cc(t){if(!t)return[];if(me(t))return wo(t)?Ye(t):pe(t);if(Gi&&t[Gi])return md(t[Gi]());var i=ae(t),s=i==Ue?As:i==Ge?$r:bi;return s(t)}function vn(t){if(!t)return t===0?t:0;if(t=We(t),t===Ct||t===-1/0){var i=t<0?-1:1;return i*Ni}return t===t?t:0}function it(t){var i=vn(t),s=i%1;return i===i?s?i-s:i:0}function Tc(t){return t?Gn(it(t),0,oe):0}function We(t){if(typeof t=="number")return t;if(Te(t))return ii;if(Nt(t)){var i=typeof t.valueOf=="function"?t.valueOf():t;t=Nt(i)?i+"":i}if(typeof t!="string")return t===0?t:+t;t=Yl(t);var s=bf.test(t);return s||_f.test(t)?jf(t.slice(2),s?2:8):yf.test(t)?ii:+t}function Ac(t){return en(t,ve(t))}function Bv(t){return t?Gn(it(t),-9007199254740991,Ht):t===0?t:0}function yt(t){return t==null?"":Ce(t)}var zv=pi(function(t,i){if(er(i)||me(i)){en(i,Qt(i),t);return}for(var s in i)bt.call(i,s)&&Ki(t,s,i[s])}),Ic=pi(function(t,i){en(i,ve(i),t)}),_o=pi(function(t,i,s,c){en(i,ve(i),t,c)}),Wv=pi(function(t,i,s,c){en(i,Qt(i),t,c)}),Hv=gn(Os);function Uv(t,i){var s=gi(t);return i==null?s:su(s,i)}var Gv=at(function(t,i){t=_t(t);var s=-1,c=i.length,d=c>2?i[2]:e;for(d&&he(i[0],i[1],d)&&(c=1);++s<c;)for(var m=i[s],b=ve(m),w=-1,x=b.length;++w<x;){var D=b[w],P=t[D];(P===e||Xe(P,hi[D])&&!bt.call(t,D))&&(t[D]=m[D])}return t}),Yv=at(function(t){return t.push(e,Yu),Ee(Dc,e,t)});function qv(t,i){return Wl(t,Y(i,3),tn)}function Xv(t,i){return Wl(t,Y(i,3),Ls)}function Vv(t,i){return t==null?t:Ns(t,Y(i,3),ve)}function Kv(t,i){return t==null?t:hu(t,Y(i,3),ve)}function Zv(t,i){return t&&tn(t,Y(i,3))}function Qv(t,i){return t&&Ls(t,Y(i,3))}function Jv(t){return t==null?[]:eo(t,Qt(t))}function jv(t){return t==null?[]:eo(t,ve(t))}function da(t,i,s){var c=t==null?e:Yn(t,i);return c===e?s:c}function ty(t,i){return t!=null&&Vu(t,i,Eg)}function ga(t,i){return t!=null&&Vu(t,i,xg)}var ey=zu(function(t,i,s){i!=null&&typeof i.toString!="function"&&(i=Hr.call(i)),t[i]=s},ma(ye)),ny=zu(function(t,i,s){i!=null&&typeof i.toString!="function"&&(i=Hr.call(i)),bt.call(t,i)?t[i].push(s):t[i]=[s]},Y),iy=at(Qi);function Qt(t){return me(t)?ru(t):Bs(t)}function ve(t){return me(t)?ru(t,!0):Ng(t)}function ry(t,i){var s={};return i=Y(i,3),tn(t,function(c,d,m){fn(s,i(c,d,m),c)}),s}function oy(t,i){var s={};return i=Y(i,3),tn(t,function(c,d,m){fn(s,d,i(c,d,m))}),s}var sy=pi(function(t,i,s){no(t,i,s)}),Dc=pi(function(t,i,s,c){no(t,i,s,c)}),ay=gn(function(t,i){var s={};if(t==null)return s;var c=!1;i=Pt(i,function(m){return m=Rn(m,t),c||(c=m.length>1),m}),en(t,js(t),s),c&&(s=$e(s,y|S|C,ep));for(var d=i.length;d--;)Ys(s,i[d]);return s});function ly(t,i){return Pc(t,yo(Y(i)))}var uy=gn(function(t,i){return t==null?{}:Fg(t,i)});function Pc(t,i){if(t==null)return{};var s=Pt(js(t),function(c){return[c]});return i=Y(i),_u(t,s,function(c,d){return i(c,d[0])})}function cy(t,i,s){i=Rn(i,t);var c=-1,d=i.length;for(d||(d=1,t=e);++c<d;){var m=t==null?e:t[nn(i[c])];m===e&&(c=d,m=s),t=mn(m)?m.call(t):m}return t}function hy(t,i,s){return t==null?t:ji(t,i,s)}function fy(t,i,s,c){return c=typeof c=="function"?c:e,t==null?t:ji(t,i,s,c)}var Rc=Uu(Qt),Mc=Uu(ve);function dy(t,i,s){var c=et(t),d=c||On(t)||yi(t);if(i=Y(i,4),s==null){var m=t&&t.constructor;d?s=c?new m:[]:Nt(t)?s=mn(m)?gi(Yr(t)):{}:s={}}return(d?Le:tn)(t,function(b,w,x){return i(s,b,w,x)}),s}function gy(t,i){return t==null?!0:Ys(t,i)}function py(t,i,s){return t==null?t:Tu(t,i,Vs(s))}function my(t,i,s,c){return c=typeof c=="function"?c:e,t==null?t:Tu(t,i,Vs(s),c)}function bi(t){return t==null?[]:Ts(t,Qt(t))}function vy(t){return t==null?[]:Ts(t,ve(t))}function yy(t,i,s){return s===e&&(s=i,i=e),s!==e&&(s=We(s),s=s===s?s:0),i!==e&&(i=We(i),i=i===i?i:0),Gn(We(t),i,s)}function by(t,i,s){return i=vn(i),s===e?(s=i,i=0):s=vn(s),t=We(t),Cg(t,i,s)}function wy(t,i,s){if(s&&typeof s!="boolean"&&he(t,i,s)&&(i=s=e),s===e&&(typeof i=="boolean"?(s=i,i=e):typeof t=="boolean"&&(s=t,t=e)),t===e&&i===e?(t=0,i=1):(t=vn(t),i===e?(i=t,t=0):i=vn(i)),t>i){var c=t;t=i,i=c}if(s||t%1||i%1){var d=nu();return se(t+d*(i-t+Jf("1e-"+((d+"").length-1))),i)}return Hs(t,i)}var _y=mi(function(t,i,s){return i=i.toLowerCase(),t+(s?Oc(i):i)});function Oc(t){return pa(yt(t).toLowerCase())}function Nc(t){return t=yt(t),t&&t.replace(Ef,hd).replace(Hf,"")}function Sy(t,i,s){t=yt(t),i=Ce(i);var c=t.length;s=s===e?c:Gn(it(s),0,c);var d=s;return s-=i.length,s>=0&&t.slice(s,d)==i}function Ey(t){return t=yt(t),t&&nf.test(t)?t.replace(hl,fd):t}function xy(t){return t=yt(t),t&&uf.test(t)?t.replace(cs,"\\$&"):t}var Cy=mi(function(t,i,s){return t+(s?"-":"")+i.toLowerCase()}),Ty=mi(function(t,i,s){return t+(s?" ":"")+i.toLowerCase()}),Ay=ku("toLowerCase");function Iy(t,i,s){t=yt(t),i=it(i);var c=i?ui(t):0;if(!i||c>=i)return t;var d=(i-c)/2;return lo(Kr(d),s)+t+lo(Vr(d),s)}function Dy(t,i,s){t=yt(t),i=it(i);var c=i?ui(t):0;return i&&c<i?t+lo(i-c,s):t}function Py(t,i,s){t=yt(t),i=it(i);var c=i?ui(t):0;return i&&c<i?lo(i-c,s)+t:t}function Ry(t,i,s){return s||i==null?i=0:i&&(i=+i),$d(yt(t).replace(hs,""),i||0)}function My(t,i,s){return(s?he(t,i,s):i===e)?i=1:i=it(i),Us(yt(t),i)}function Oy(){var t=arguments,i=yt(t[0]);return t.length<3?i:i.replace(t[1],t[2])}var Ny=mi(function(t,i,s){return t+(s?"_":"")+i.toLowerCase()});function Ly(t,i,s){return s&&typeof s!="number"&&he(t,i,s)&&(i=s=e),s=s===e?oe:s>>>0,s?(t=yt(t),t&&(typeof i=="string"||i!=null&&!fa(i))&&(i=Ce(i),!i&&li(t))?Mn(Ye(t),0,s):t.split(i,s)):[]}var Fy=mi(function(t,i,s){return t+(s?" ":"")+pa(i)});function ky(t,i,s){return t=yt(t),s=s==null?0:Gn(it(s),0,t.length),i=Ce(i),t.slice(s,s+i.length)==i}function $y(t,i,s){var c=p.templateSettings;s&&he(t,i,s)&&(i=e),t=yt(t),i=_o({},i,c,Gu);var d=_o({},i.imports,c.imports,Gu),m=Qt(d),b=Ts(d,m),w,x,D=0,P=i.interpolate||Or,O="__p += '",k=Is((i.escape||Or).source+"|"+P.source+"|"+(P===fl?vf:Or).source+"|"+(i.evaluate||Or).source+"|$","g"),U="//# sourceURL="+(bt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xf+"]")+`
`;t.replace(k,function(X,lt,ht,Ae,fe,Ie){return ht||(ht=Ae),O+=t.slice(D,Ie).replace(xf,dd),lt&&(w=!0,O+=`' +
__e(`+lt+`) +
'`),fe&&(x=!0,O+=`';
`+fe+`;
__p += '`),ht&&(O+=`' +
((__t = (`+ht+`)) == null ? '' : __t) +
'`),D=Ie+X.length,X}),O+=`';
`;var q=bt.call(i,"variable")&&i.variable;if(!q)O=`with (obj) {
`+O+`
}
`;else if(pf.test(q))throw new Q(h);O=(x?O.replace(Jh,""):O).replace(jh,"$1").replace(tf,"$1;"),O="function("+(q||"obj")+`) {
`+(q?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(x?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+O+`return __p
}`;var ot=Fc(function(){return pt(m,U+"return "+O).apply(e,b)});if(ot.source=O,ha(ot))throw ot;return ot}function By(t){return yt(t).toLowerCase()}function zy(t){return yt(t).toUpperCase()}function Wy(t,i,s){if(t=yt(t),t&&(s||i===e))return Yl(t);if(!t||!(i=Ce(i)))return t;var c=Ye(t),d=Ye(i),m=ql(c,d),b=Xl(c,d)+1;return Mn(c,m,b).join("")}function Hy(t,i,s){if(t=yt(t),t&&(s||i===e))return t.slice(0,Kl(t)+1);if(!t||!(i=Ce(i)))return t;var c=Ye(t),d=Xl(c,Ye(i))+1;return Mn(c,0,d).join("")}function Uy(t,i,s){if(t=yt(t),t&&(s||i===e))return t.replace(hs,"");if(!t||!(i=Ce(i)))return t;var c=Ye(t),d=ql(c,Ye(i));return Mn(c,d).join("")}function Gy(t,i){var s=Jt,c=It;if(Nt(i)){var d="separator"in i?i.separator:d;s="length"in i?it(i.length):s,c="omission"in i?Ce(i.omission):c}t=yt(t);var m=t.length;if(li(t)){var b=Ye(t);m=b.length}if(s>=m)return t;var w=s-ui(c);if(w<1)return c;var x=b?Mn(b,0,w).join(""):t.slice(0,w);if(d===e)return x+c;if(b&&(w+=x.length-w),fa(d)){if(t.slice(w).search(d)){var D,P=x;for(d.global||(d=Is(d.source,yt(dl.exec(d))+"g")),d.lastIndex=0;D=d.exec(P);)var O=D.index;x=x.slice(0,O===e?w:O)}}else if(t.indexOf(Ce(d),w)!=w){var k=x.lastIndexOf(d);k>-1&&(x=x.slice(0,k))}return x+c}function Yy(t){return t=yt(t),t&&ef.test(t)?t.replace(cl,wd):t}var qy=mi(function(t,i,s){return t+(s?" ":"")+i.toUpperCase()}),pa=ku("toUpperCase");function Lc(t,i,s){return t=yt(t),i=s?e:i,i===e?pd(t)?Ed(t):sd(t):t.match(i)||[]}var Fc=at(function(t,i){try{return Ee(t,e,i)}catch(s){return ha(s)?s:new Q(s)}}),Xy=gn(function(t,i){return Le(i,function(s){s=nn(s),fn(t,s,ua(t[s],t))}),t});function Vy(t){var i=t==null?0:t.length,s=Y();return t=i?Pt(t,function(c){if(typeof c[1]!="function")throw new Fe(u);return[s(c[0]),c[1]]}):[],at(function(c){for(var d=-1;++d<i;){var m=t[d];if(Ee(m[0],this,c))return Ee(m[1],this,c)}})}function Ky(t){return wg($e(t,y))}function ma(t){return function(){return t}}function Zy(t,i){return t==null||t!==t?i:t}var Qy=Bu(),Jy=Bu(!0);function ye(t){return t}function va(t){return pu(typeof t=="function"?t:$e(t,y))}function jy(t){return vu($e(t,y))}function t0(t,i){return yu(t,$e(i,y))}var e0=at(function(t,i){return function(s){return Qi(s,t,i)}}),n0=at(function(t,i){return function(s){return Qi(t,s,i)}});function ya(t,i,s){var c=Qt(i),d=eo(i,c);s==null&&!(Nt(i)&&(d.length||!c.length))&&(s=i,i=t,t=this,d=eo(i,Qt(i)));var m=!(Nt(s)&&"chain"in s)||!!s.chain,b=mn(t);return Le(d,function(w){var x=i[w];t[w]=x,b&&(t.prototype[w]=function(){var D=this.__chain__;if(m||D){var P=t(this.__wrapped__),O=P.__actions__=pe(this.__actions__);return O.push({func:x,args:arguments,thisArg:t}),P.__chain__=D,P}return x.apply(t,Tn([this.value()],arguments))})}),t}function i0(){return te._===this&&(te._=Dd),this}function ba(){}function r0(t){return t=it(t),at(function(i){return bu(i,t)})}var o0=Zs(Pt),s0=Zs(zl),a0=Zs(_s);function kc(t){return ia(t)?Ss(nn(t)):kg(t)}function l0(t){return function(i){return t==null?e:Yn(t,i)}}var u0=Wu(),c0=Wu(!0);function wa(){return[]}function _a(){return!1}function h0(){return{}}function f0(){return""}function d0(){return!0}function g0(t,i){if(t=it(t),t<1||t>Ht)return[];var s=oe,c=se(t,oe);i=Y(i),t-=oe;for(var d=Cs(c,i);++s<t;)i(s);return d}function p0(t){return et(t)?Pt(t,nn):Te(t)?[t]:pe(ic(yt(t)))}function m0(t){var i=++Ad;return yt(t)+i}var v0=ao(function(t,i){return t+i},0),y0=Qs("ceil"),b0=ao(function(t,i){return t/i},1),w0=Qs("floor");function _0(t){return t&&t.length?to(t,ye,Fs):e}function S0(t,i){return t&&t.length?to(t,Y(i,2),Fs):e}function E0(t){return Ul(t,ye)}function x0(t,i){return Ul(t,Y(i,2))}function C0(t){return t&&t.length?to(t,ye,zs):e}function T0(t,i){return t&&t.length?to(t,Y(i,2),zs):e}var A0=ao(function(t,i){return t*i},1),I0=Qs("round"),D0=ao(function(t,i){return t-i},0);function P0(t){return t&&t.length?xs(t,ye):0}function R0(t,i){return t&&t.length?xs(t,Y(i,2)):0}return p.after=jm,p.ary=gc,p.assign=zv,p.assignIn=Ic,p.assignInWith=_o,p.assignWith=Wv,p.at=Hv,p.before=pc,p.bind=ua,p.bindAll=Xy,p.bindKey=mc,p.castArray=hv,p.chain=hc,p.chunk=wp,p.compact=_p,p.concat=Sp,p.cond=Vy,p.conforms=Ky,p.constant=ma,p.countBy=Pm,p.create=Uv,p.curry=vc,p.curryRight=yc,p.debounce=bc,p.defaults=Gv,p.defaultsDeep=Yv,p.defer=tv,p.delay=ev,p.difference=Ep,p.differenceBy=xp,p.differenceWith=Cp,p.drop=Tp,p.dropRight=Ap,p.dropRightWhile=Ip,p.dropWhile=Dp,p.fill=Pp,p.filter=Mm,p.flatMap=Lm,p.flatMapDeep=Fm,p.flatMapDepth=km,p.flatten=ac,p.flattenDeep=Rp,p.flattenDepth=Mp,p.flip=nv,p.flow=Qy,p.flowRight=Jy,p.fromPairs=Op,p.functions=Jv,p.functionsIn=jv,p.groupBy=$m,p.initial=Lp,p.intersection=Fp,p.intersectionBy=kp,p.intersectionWith=$p,p.invert=ey,p.invertBy=ny,p.invokeMap=zm,p.iteratee=va,p.keyBy=Wm,p.keys=Qt,p.keysIn=ve,p.map=po,p.mapKeys=ry,p.mapValues=oy,p.matches=jy,p.matchesProperty=t0,p.memoize=vo,p.merge=sy,p.mergeWith=Dc,p.method=e0,p.methodOf=n0,p.mixin=ya,p.negate=yo,p.nthArg=r0,p.omit=ay,p.omitBy=ly,p.once=iv,p.orderBy=Hm,p.over=o0,p.overArgs=rv,p.overEvery=s0,p.overSome=a0,p.partial=ca,p.partialRight=wc,p.partition=Um,p.pick=uy,p.pickBy=Pc,p.property=kc,p.propertyOf=l0,p.pull=Hp,p.pullAll=uc,p.pullAllBy=Up,p.pullAllWith=Gp,p.pullAt=Yp,p.range=u0,p.rangeRight=c0,p.rearg=ov,p.reject=qm,p.remove=qp,p.rest=sv,p.reverse=aa,p.sampleSize=Vm,p.set=hy,p.setWith=fy,p.shuffle=Km,p.slice=Xp,p.sortBy=Jm,p.sortedUniq=tm,p.sortedUniqBy=em,p.split=Ly,p.spread=av,p.tail=nm,p.take=im,p.takeRight=rm,p.takeRightWhile=om,p.takeWhile=sm,p.tap=_m,p.throttle=lv,p.thru=go,p.toArray=Cc,p.toPairs=Rc,p.toPairsIn=Mc,p.toPath=p0,p.toPlainObject=Ac,p.transform=dy,p.unary=uv,p.union=am,p.unionBy=lm,p.unionWith=um,p.uniq=cm,p.uniqBy=hm,p.uniqWith=fm,p.unset=gy,p.unzip=la,p.unzipWith=cc,p.update=py,p.updateWith=my,p.values=bi,p.valuesIn=vy,p.without=dm,p.words=Lc,p.wrap=cv,p.xor=gm,p.xorBy=pm,p.xorWith=mm,p.zip=vm,p.zipObject=ym,p.zipObjectDeep=bm,p.zipWith=wm,p.entries=Rc,p.entriesIn=Mc,p.extend=Ic,p.extendWith=_o,ya(p,p),p.add=v0,p.attempt=Fc,p.camelCase=_y,p.capitalize=Oc,p.ceil=y0,p.clamp=yy,p.clone=fv,p.cloneDeep=gv,p.cloneDeepWith=pv,p.cloneWith=dv,p.conformsTo=mv,p.deburr=Nc,p.defaultTo=Zy,p.divide=b0,p.endsWith=Sy,p.eq=Xe,p.escape=Ey,p.escapeRegExp=xy,p.every=Rm,p.find=Om,p.findIndex=oc,p.findKey=qv,p.findLast=Nm,p.findLastIndex=sc,p.findLastKey=Xv,p.floor=w0,p.forEach=fc,p.forEachRight=dc,p.forIn=Vv,p.forInRight=Kv,p.forOwn=Zv,p.forOwnRight=Qv,p.get=da,p.gt=vv,p.gte=yv,p.has=ty,p.hasIn=ga,p.head=lc,p.identity=ye,p.includes=Bm,p.indexOf=Np,p.inRange=by,p.invoke=iy,p.isArguments=Vn,p.isArray=et,p.isArrayBuffer=bv,p.isArrayLike=me,p.isArrayLikeObject=zt,p.isBoolean=wv,p.isBuffer=On,p.isDate=_v,p.isElement=Sv,p.isEmpty=Ev,p.isEqual=xv,p.isEqualWith=Cv,p.isError=ha,p.isFinite=Tv,p.isFunction=mn,p.isInteger=_c,p.isLength=bo,p.isMap=Sc,p.isMatch=Av,p.isMatchWith=Iv,p.isNaN=Dv,p.isNative=Pv,p.isNil=Mv,p.isNull=Rv,p.isNumber=Ec,p.isObject=Nt,p.isObjectLike=kt,p.isPlainObject=ir,p.isRegExp=fa,p.isSafeInteger=Ov,p.isSet=xc,p.isString=wo,p.isSymbol=Te,p.isTypedArray=yi,p.isUndefined=Nv,p.isWeakMap=Lv,p.isWeakSet=Fv,p.join=Bp,p.kebabCase=Cy,p.last=ze,p.lastIndexOf=zp,p.lowerCase=Ty,p.lowerFirst=Ay,p.lt=kv,p.lte=$v,p.max=_0,p.maxBy=S0,p.mean=E0,p.meanBy=x0,p.min=C0,p.minBy=T0,p.stubArray=wa,p.stubFalse=_a,p.stubObject=h0,p.stubString=f0,p.stubTrue=d0,p.multiply=A0,p.nth=Wp,p.noConflict=i0,p.noop=ba,p.now=mo,p.pad=Iy,p.padEnd=Dy,p.padStart=Py,p.parseInt=Ry,p.random=wy,p.reduce=Gm,p.reduceRight=Ym,p.repeat=My,p.replace=Oy,p.result=cy,p.round=I0,p.runInContext=E,p.sample=Xm,p.size=Zm,p.snakeCase=Ny,p.some=Qm,p.sortedIndex=Vp,p.sortedIndexBy=Kp,p.sortedIndexOf=Zp,p.sortedLastIndex=Qp,p.sortedLastIndexBy=Jp,p.sortedLastIndexOf=jp,p.startCase=Fy,p.startsWith=ky,p.subtract=D0,p.sum=P0,p.sumBy=R0,p.template=$y,p.times=g0,p.toFinite=vn,p.toInteger=it,p.toLength=Tc,p.toLower=By,p.toNumber=We,p.toSafeInteger=Bv,p.toString=yt,p.toUpper=zy,p.trim=Wy,p.trimEnd=Hy,p.trimStart=Uy,p.truncate=Gy,p.unescape=Yy,p.uniqueId=m0,p.upperCase=qy,p.upperFirst=pa,p.each=fc,p.eachRight=dc,p.first=lc,ya(p,function(){var t={};return tn(p,function(i,s){bt.call(p.prototype,s)||(t[s]=i)}),t}(),{chain:!1}),p.VERSION=r,Le(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){p[t].placeholder=p}),Le(["drop","take"],function(t,i){ct.prototype[t]=function(s){s=s===e?1:Zt(it(s),0);var c=this.__filtered__&&!i?new ct(this):this.clone();return c.__filtered__?c.__takeCount__=se(s,c.__takeCount__):c.__views__.push({size:se(s,oe),type:t+(c.__dir__<0?"Right":"")}),c},ct.prototype[t+"Right"]=function(s){return this.reverse()[t](s).reverse()}}),Le(["filter","map","takeWhile"],function(t,i){var s=i+1,c=s==Ot||s==wt;ct.prototype[t]=function(d){var m=this.clone();return m.__iteratees__.push({iteratee:Y(d,3),type:s}),m.__filtered__=m.__filtered__||c,m}}),Le(["head","last"],function(t,i){var s="take"+(i?"Right":"");ct.prototype[t]=function(){return this[s](1).value()[0]}}),Le(["initial","tail"],function(t,i){var s="drop"+(i?"":"Right");ct.prototype[t]=function(){return this.__filtered__?new ct(this):this[s](1)}}),ct.prototype.compact=function(){return this.filter(ye)},ct.prototype.find=function(t){return this.filter(t).head()},ct.prototype.findLast=function(t){return this.reverse().find(t)},ct.prototype.invokeMap=at(function(t,i){return typeof t=="function"?new ct(this):this.map(function(s){return Qi(s,t,i)})}),ct.prototype.reject=function(t){return this.filter(yo(Y(t)))},ct.prototype.slice=function(t,i){t=it(t);var s=this;return s.__filtered__&&(t>0||i<0)?new ct(s):(t<0?s=s.takeRight(-t):t&&(s=s.drop(t)),i!==e&&(i=it(i),s=i<0?s.dropRight(-i):s.take(i-t)),s)},ct.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},ct.prototype.toArray=function(){return this.take(oe)},tn(ct.prototype,function(t,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),d=p[c?"take"+(i=="last"?"Right":""):i],m=c||/^find/.test(i);d&&(p.prototype[i]=function(){var b=this.__wrapped__,w=c?[1]:arguments,x=b instanceof ct,D=w[0],P=x||et(b),O=function(lt){var ht=d.apply(p,Tn([lt],w));return c&&k?ht[0]:ht};P&&s&&typeof D=="function"&&D.length!=1&&(x=P=!1);var k=this.__chain__,U=!!this.__actions__.length,q=m&&!k,ot=x&&!U;if(!m&&P){b=ot?b:new ct(this);var X=t.apply(b,w);return X.__actions__.push({func:go,args:[O],thisArg:e}),new ke(X,k)}return q&&ot?t.apply(this,w):(X=this.thru(O),q?c?X.value()[0]:X.value():X)})}),Le(["pop","push","shift","sort","splice","unshift"],function(t){var i=Br[t],s=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",c=/^(?:pop|shift)$/.test(t);p.prototype[t]=function(){var d=arguments;if(c&&!this.__chain__){var m=this.value();return i.apply(et(m)?m:[],d)}return this[s](function(b){return i.apply(et(b)?b:[],d)})}}),tn(ct.prototype,function(t,i){var s=p[i];if(s){var c=s.name+"";bt.call(di,c)||(di[c]=[]),di[c].push({name:i,func:s})}}),di[so(e,z).name]=[{name:"wrapper",func:e}],ct.prototype.clone=Yd,ct.prototype.reverse=qd,ct.prototype.value=Xd,p.prototype.at=Sm,p.prototype.chain=Em,p.prototype.commit=xm,p.prototype.next=Cm,p.prototype.plant=Am,p.prototype.reverse=Im,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Dm,p.prototype.first=p.prototype.head,Gi&&(p.prototype[Gi]=Tm),p},ci=xd();zn?((zn.exports=ci)._=ci,vs._=ci):te._=ci}).call(uw)}(gr,gr.exports)),gr.exports}var bn=cw();const Pw=({assetsUrl:o=""})=>({stage:null,layer:null,selectionTransformer:null,stageInitiated:!1,activePanel:null,showWelcomeScreen:!0,layersSearchString:"",layersSortable:null,selectedGroupChildNodes:[],selectionColors:{fill:"hsla(205,90%,48%,0.15)",stroke:"hsl(205,90%,48%)"},fetchedAssets:[],prevViews:[],currentView:"home",currentDocId:null,currentDocName:null,updatingName:null,aiTasksQueue:[],activeTool:null,activeFillTab:"color",editingTextNode:null,editingTextarea:null,container:null,konvajsContent:null,containerDimensions:{x:0,y:0,width:0,height:0},konvajsContentDimensions:{x:0,y:0,width:0,height:0},selectedFont:"",fontsSearchString:"",newItems:[],lqdFontPreview:[],googleFontsList:[],showingGoogleFonts:[],fontsPaginationCurrent:20,fontsPaginationLimit:20,loadingFontPreviewQueue:[],adaptiveResize:!0,prevStageWidth:null,prevStageHeight:null,busy:!1,maxZoom:200,minZoom:20,zoomOffsetX:0,zoomOffsetY:0,zoomLevel:100,isSpacePressed:!1,isPanning:!1,reachedMinZoom:!1,reachedMaxZoom:!1,activeTooltipDropdown:null,guidelineOffset:5,placeholderImage:`${o}/img/misc/placeholder-1.jpg`,templatesList:[],templatesCategories:[],templatesPagination:{},loadingTemplates:!0,loadingTemplatesFailed:!1,promptLibraryShow:!1,promptFilter:"all",searchPromptStr:"",prompt:"",history:[],historyPointer:-1,maxHistoryLength:30,historyListeners:["fill","fillLinearGradientStartPoint","fillLinearGradientStartPointX","fillLinearGradientStartPointY","fillLinearGradientEndPoint","fillLinearGradientEndPointX","fillLinearGradientEndPointY","fillLinearGradientColorStops","fillRadialGradientStartPoint","fillRadialGradientStartPointX","fillRadialGradientStartPointY","fillRadialGradientEndPoint","fillRadialGradientEndPointX","fillRadialGradientEndPointY","fillRadialGradientStartRadius","fillRadialGradientEndRadius","fillRadialGradientColorStops","stroke","strokeWidth","lineJoin","lineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","dash","x","y","width","height","opacity","scale","scaleX","scaleY","rotation","offset","offsetX","offsetY","fontFamily","fontSize","fontStyle","fontVariant","textDecoration","text","align","verticalAlign","padding","lineHeight","wrap","ellipsis","image","crop","blurRadius","skew","skewX","skewY","sides","numPoints","innerRadius","outerRadius","angle"],get creativeSuite(){return this.$data},get nodes(){var n;return((n=this.layer)==null?void 0:n.getChildren(e=>{const r=e.name(),a=e.getType();return(a==="Shape"||a==="Group")&&!["lqd-cs-guide-line","lqd-cs-highlighter","lqd-cs-selection-transformer","lqd-cs-selection-rectangle"].includes(r)}))??[]},get selectedNodes(){var n;return((n=this.selectionTransformer)==null?void 0:n.nodes())??[]},set selectedNodes(n={nodes:[],ids:[],event:{}}){let e=n.nodes||[],r=n.ids||[],a=n.event||{},l=a.metaKey||a.ctrlKey,u=a.shiftKey;if(r.length&&!e.length&&(e=this.nodes.filter(h=>r.includes(h.id()))),e==="all"&&(e=this.nodes),u){let h=[...this.selectedNodes];e.forEach(f=>{const g=h.findIndex(v=>v.id()===f.id());g!==-1?h.splice(g,1):h.push(f)}),e=h.filter(f=>!f.findAncestors("Group").some(y=>y.getChildren(S=>S.id()===f.id())))}l||e.forEach(h=>{const f=h.findAncestors("Group"),g=f.length;f.forEach((v,y)=>{g>1&&y===0||!e.find(S=>S.id()===v.id())&&!this.selectedGroupChildNodes.find(S=>S.id()===h.id())&&(e.push(v),e=e.filter(S=>S.id()!==h.id()))})}),this.selectedGroupChildNodes.forEach(h=>{const g=h.findAncestors("Group").some(S=>e.some(C=>C.id()===S.id())),y=e.filter(S=>S.getClassName()==="Group").find(S=>S.findOne(`#${h.id()}`));(!e.find(S=>S.id()===h.id())||g||y)&&(h.draggable(!1),this.selectedGroupChildNodes=this.selectedGroupChildNodes.filter(S=>S.id()!==h.id()))}),e=e.filter(h=>!h.getAttr("locked")),this.selectionTransformer.nodes(e),this.selectionTransformer.zIndex(this.nodes.length+1),this.$dispatch("nodes-selected",{nodes:this.selectedNodes,nodesCount:this.selectedNodes.length,selectedNodesRect:this.selectedNodesRect})},get selectedNodesRect(){return this.selectedNodes.length?this.selectionTransformer.getClientRect():{x:0,y:0}},get selectedNodesProps(){const n=this.selectedNodes;if(!n.length)return{};const e=n[0],r=n.find(C=>C.getClassName()==="Rect"),a=n.find(C=>C.getClassName()==="Image"),l=n.find(C=>C.getClassName()==="RegularPolygon"),u=n.find(C=>C.getClassName()==="Star"),h=n.find(C=>C.getClassName()==="Ring"),f=n.find(C=>C.getClassName()==="Arc"),g=n.find(C=>C.getClassName()==="Wedge"),v=n.find(C=>C.getClassName()==="Text"),y=n.find(C=>C.getClassName()==="TextPath"),S={x:e.x(),y:e.y(),rotation:e.rotation(),width:e.width(),height:e.height(),opacity:e.opacity(),fill:e.fill(),fillPatternX:e.fillPatternX()??0,fillPatternY:e.fillPatternY()??0,fillPatternScaleX:e.fillPatternScaleX()??0,fillPatternScaleY:e.fillPatternScaleY()??0,fillPatternRepeat:e.fillPatternRepeat(),cornerRadius:((r==null?void 0:r.cornerRadius())||(a==null?void 0:a.cornerRadius()))??0,sides:(l==null?void 0:l.sides())??0,numPoints:(u==null?void 0:u.numPoints())??0,innerRadius:((u==null?void 0:u.innerRadius())||(h==null?void 0:h.innerRadius())||(f==null?void 0:f.innerRadius()))??0,outerRadius:((u==null?void 0:u.outerRadius())||(h==null?void 0:h.outerRadius())||(f==null?void 0:f.outerRadius()))??0,angle:((f==null?void 0:f.angle())||(g==null?void 0:g.angle()))??0,fontFamily:((v==null?void 0:v.fontFamily())||(y==null?void 0:y.fontFamily()))??"",fontSize:((v==null?void 0:v.fontSize())||(y==null?void 0:y.fontSize()))??0,fontStyle:((v==null?void 0:v.fontStyle())||(y==null?void 0:y.fontStyle()))??"normal 400",textDecoration:((v==null?void 0:v.textDecoration())||(y==null?void 0:y.textDecoration()))??"",lineHeight:v==null?void 0:v.lineHeight(),letterSpacing:((v==null?void 0:v.letterSpacing())||(y==null?void 0:y.letterSpacing()))??0,align:((v==null?void 0:v.align())||(y==null?void 0:y.align()))??"",stroke:e.stroke()??"",strokeWidth:e.strokeWidth()??0,dash:e.dash()??0,blurRadius:e.blurRadius()??null,skewX:e.skewX()??null,skewY:e.skewY()??null,globalCompositeOperation:e.globalCompositeOperation()??null};return Object.fromEntries(Object.entries(S).map(([C,A])=>{const M=n.every(z=>this.isPropertyNotApplicableToNodeType(C,z.getClassName())?!0:z[C]()===A)?this.formatPropertyValue(C,A):magicai_localize.mixed;return[C,M]}))},set selectedNodesProps(n={x:null,y:null,rotation:null,width:null,height:null,scaleX:null,scaleY:null,opacity:null,fill:null,fillPatternX:null,fillPatternY:null,fillPatternScaleX:null,fillPatternScaleY:null,fillPatternRepeat:null,cornerRadius:null,sides:null,numPoints:null,innerRadius:null,outerRadius:null,angle:null,fontFamily:null,fontSize:null,fontStyle:null,textDecoration:null,lineHeight:null,letterSpacing:null,align:null,stroke:null,strokeWidth:null,dash:null,blurRadius:null,skewX:null,skewY:null,globalCompositeOperation:null,useRelativeValue:!1}){const e=this.selectedNodes.length>1||n.useRelativeValue,r=["x","y","rotation","width","height","scaleX","scaleY","opacity","fill","fillPatternX","fillPatternY","fillPatternScaleX","fillPatternScaleY","fillPatternRepeat","cornerRadius","sides","numPoints","innerRadius","outerRadius","angle","fontFamily","fontSize","fontStyle","textDecoration","lineHeight","letterSpacing","align","stroke","strokeWidth","dash","blurRadius","skewX","skewY","globalCompositeOperation"];this.selectedNodes.forEach(a=>{const l=a.getClassName();r.forEach(u=>{if(n[u]==null||this.isPropertyNotApplicableToNodeType(u,l))return;const h=a[u==="fontWeight"?"fontStyle":u](),f=!isNaN(parseInt(h)),g=f&&n[u]==="flip"?h*-1:n[u],v=f?parseFloat(g):g;let y=f&&e?h+v:v;if(u==="fontStyle"){const S=(h??"").split(" ");let C=S[0]??"normal",A=S[1]??"400";isNaN(parseInt(n[u]))?C=n[u]:A=n[u],y=`${C} ${A}`}if(u==="rotation"&&["Rect","Text","TextPath","Image"].includes(l)){let S=(y%360+360)%360;S>180&&(S-=360),y=S;const{x:C,y:A,rotation:R}=this.rotateNodeAroundCenter(a,y);a.rotation(R),a.x(C),a.y(A);return}switch(u){case"width":case"height":case"cornerRadius":case"innerRadius":case"outerRadius":y=Math.max(0,y);break;case"sides":case"numPoints":y=Math.max(3,y);break;case"angle":y=Math.max(0,Math.min(360,y));break;case"opacity":y=Math.max(0,Math.min(1,y));break}a[u](y)})})},init(){this.googleFontsList=window.lqdGoogleFontsList,this.beforeUnloadHandler=this.beforeUnloadHandler.bind(this),this.positionTooltip=this.positionTooltip.bind(this),this.handleEditinTextareaOutsideClick=this.handleEditinTextareaOutsideClick.bind(this),this.removeEditingTextarea=this.removeEditingTextarea.bind(this),this.setEditingTextareaTextAndRemove=this.setEditingTextareaTextAndRemove.bind(this),this.addToHistory=bn.debounce(this.addToHistory.bind(this),250,{leading:!1,trailing:!0}),this.loadGoogleFontPreview=bn.throttle(this.loadGoogleFontPreview.bind(this),300,{leading:!1}),this.resizeStage=bn.throttle(this.resizeStage.bind(this),50),this.onWindowResize=bn.throttle(this.onWindowResize.bind(this),250),this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit),this.$watch("selectedFont",n=>{this.$dispatch("font-selected",{font:n})}),this.$watch("nodes.length",n=>{this.beforeUnloadListened||(n>0?this.addBeforeUnloadListener():this.removeBeforeUnloadListener())}),this.$watch("[zoomLevel, zoomOffsetX, zoomOffsetY]",()=>{this.positionTooltip(),this.positionEditingTextarea(),this.updateSelectionTransformerStroke()}),this.$watch("currentView",n=>{document.body.classList.toggle("overflow-hidden",["editor","gallery"].includes(n))}),this.initiateStage()},initiateStage(n={width:720,height:720}){const e=this.isMobile(),r=n.width??720,a=n.height??720;if(this.$refs.editorCanvasContainer===null){console.error("Creative Suite canvas was not found");return}if(this.stageInitiated||this.stage){console.warn("Creative Suite canvas was already initiated");return}this.stage=new Konva.Stage({container:this.$refs.editorCanvasContainer,width:r,height:a,name:"lqd-cs-stage",draggable:!1}),this.selectionTransformer=new Konva.Transformer({keepRatio:!1,borderStroke:this.selectionColors.stroke,anchorSize:e?10:6,rotationSnaps:[0,45,90,135,180,225,270,315,360],rotationSnapTolerance:5,rotateAnchorOffset:e?50:30,ignoreStroke:!0,flipEnabled:!1,id:"lqd-cs-selection-transformer",name:"lqd-cs-selection-transformer"}),this.selectionRectangle=new Konva.Rect({fill:this.selectionColors.fill,stroke:this.selectionColors.stroke,strokeWidth:1,visible:!1,id:"lqd-cs-selection-rectangle",name:"lqd-cs-selection-rectangle"}),this.layer=new Konva.Layer({name:"lqd-cs-layer-main"}),this.layer.add(this.selectionTransformer),this.layer.add(this.selectionRectangle),this.stage.add(this.layer),this.container=this.stage.container(),this.konvajsContent=this.container.querySelector(".konvajs-content"),this.container.tabIndex=1,this.container.focus(),this.setContainerDimensions(),this.selectionTransformerEvents(),this.handleSelectionRectangle(),this.initLayers(),this.stageEvents(),this.containerEvents(),this.handlePanAndZoom(),this.initNodesSnap(),this.positionTooltip(),this.handleWindowResize(),this.stageInitiated=!0},setContainerDimensions(){this.containerDimensions={x:this.container.offsetLeft,y:this.container.offsetTop,width:this.container.clientWidth,height:this.container.offsetHeight},this.konvajsContentDimensions={x:this.konvajsContent.offsetLeft,y:this.konvajsContent.offsetTop,width:this.konvajsContent.clientWidth,height:this.konvajsContent.offsetHeight}},handleSelectionRectangle(){let n,e,r,a,l=this.layer.getChildren().length;function u(h){if(!(!this.selectionRectangle.visible()||this.isPanning||this.isSpacePressed)){bn.defer(()=>{this.selectionRectangle.visible(!1)});var f=this.selectionRectangle.getClientRect(),g=this.nodes.filter(v=>Konva.Util.haveIntersection(f,v.getClientRect()));this.selectedNodes={nodes:g,event:h}}}this.stage.on("mousedown",h=>{var g;if(this.isPanning||this.isSpacePressed||((g=h.touches)==null?void 0:g.length)>=2)return;const f=h.target;f._id===this.stage._id?(l=this.layer.getChildren().length,n=this.stage.getPointerPosition().x,e=this.stage.getPointerPosition().y,r=this.stage.getPointerPosition().x,a=this.stage.getPointerPosition().y,this.selectionRectangle.setAttrs({x:n,y:e,width:0,height:0,visible:!0,zIndex:l-1})):this.nodes.find(v=>v.id()===f.id())&&!this.selectedNodes.find(v=>v.id()===f.id())&&(this.selectedNodes={nodes:[f],event:h.evt})}),this.stage.on("mousemove",h=>{var f;!this.selectionRectangle.visible()||this.isPanning||this.isSpacePressed||((f=h.touches)==null?void 0:f.length)>=2||(r=this.stage.getPointerPosition().x,a=this.stage.getPointerPosition().y,this.selectionRectangle.setAttrs({x:Math.min(n,r),y:Math.min(e,a),width:Math.abs(r-n),height:Math.abs(a-e),zIndex:l-1}))}),window.addEventListener("mouseup",u.bind(this)),this.stage.on("dblclick dbltap",h=>{let f=h.target;if(f._id===this.stage._id)return;const g=f.findAncestors("Group");g.length&&(g.length>1&&(f=g[0]),f.draggable(!0),this.selectedGroupChildNodes.push(f),this.selectedNodes={nodes:[f],event:h.evt})}),this.stage.on("click tap",h=>{const f=h.target;if(!(h.evt.shiftKey||this.selectionRectangle.visible()&&this.selectionRectangle.width()>0&&this.selectionRectangle.height()>0)){if(f._id===this.stage._id){this.selectedNodes.length&&(this.selectedNodes={});return}this.selectedNodes={nodes:[f],event:h.evt}}}),this.container.addEventListener("keydown",h=>{const f=h.key;if(!f||this.editingTextNode)return;const g=h.ctrlKey||h.metaKey,v=h.shiftKey;let y=1;switch(g&&(y=.1),v&&(y=10),f){case"Backspace":h.preventDefault(),this.destroySelectedNodes();break;case"ArrowUp":h.preventDefault(),this.selectedNodesProps={y:-y,useRelativeValue:!0},this.positionTooltip();break;case"ArrowDown":h.preventDefault(),this.selectedNodesProps={y,useRelativeValue:!0},this.positionTooltip();break;case"ArrowLeft":h.preventDefault(),this.selectedNodesProps={x:-y,useRelativeValue:!0},this.positionTooltip();break;case"ArrowRight":h.preventDefault(),this.selectedNodesProps={x:y,useRelativeValue:!0},this.positionTooltip();break;case"a":h.preventDefault(),g&&(this.selectedNodes={nodes:"all"});break}}),this.konvajsContent.addEventListener("dragover",h=>{h.preventDefault()}),this.konvajsContent.addEventListener("drop",h=>{h.preventDefault(),this.stage.setPointersPositions(h);const f=JSON.parse(h.dataTransfer.getData("data")??"{}");if(!f.type)return;let{x:g,y:v}=this.stage.getPointerPosition();const y=this.addNodeToStage({type:f.type,attrs:{...f.attrs},beforeAdd:S=>{const C=S.getClassName(),A=C==="Rect"||C==="Path",R=S.getClientRect();S.setAttrs({x:g-(A?R.width/2:0),y:v-(A?R.height/2:0)})}});this.selectedNodes={nodes:[y]}})},stageEvents(){this.stage.on("click tap",()=>{this.setActiveTooltipDropdown(null)}),this.stage.on("dragmove",n=>{const e=n.target;if(e.name()==="lqd-cs-stage"){e.x(0),e.y(0);return}}),this.stage.on("widthChange heightChange",this.addToHistory)},containerEvents(){const n=e=>{e.target===this.container&&this.selectedNodes.length&&(this.selectedNodes={})};this.container.addEventListener("click",n.bind(this)),this.container.addEventListener("tap",n.bind(this)),this.container.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="z"&&!e.shiftKey&&(e.preventDefault(),this.undo()),((e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="z"||(e.ctrlKey||e.metaKey)&&e.key==="y")&&(e.preventDefault(),this.redo())})},selectionTransformerEvents(){function n(r,a,l){const u=r.getClassName();if(["Rect","Image","Text"].includes(u))r.width(r.width()*a),r.height(r.height()*l),r.scaleX(1),r.scaleY(1);else if(u==="Circle"||u==="RegularPolygon"){const h=r.radius(),f=(a+l)/2;r.radius(h*f),r.scaleX(1),r.scaleY(1)}else u==="Ellipse"&&(r.radiusX(r.radiusX()*a),r.radiusY(r.radiusY()*l),r.scaleX(1),r.scaleY(1))}function e(r,a,l){r.getChildren().forEach(u=>{const h=u.getClassName(),{x:f,y:g}=u.position();if(u.position({x:f*a,y:g*l}),h==="Group"){const v=u.scaleX()*a,y=u.scaleY()*l;u.scaleX(1),u.scaleY(1),e(u,v,y)}else n(u,a*u.scaleX(),l*u.scaleY())})}this.selectionTransformer.on("transform",()=>{this.selectedNodes.forEach(a=>{const l=a.getClassName(),u=a.scaleX(),h=a.scaleY();if(l==="Group"){a.scaleX(1),a.scaleY(1),e(a,u,h);return}n(a,u,h)})})},createNode(n={type:null,attrs:{}}){var h;if(!this.stageInitiated)return;if(!Konva[n.type]){console.error(`Konva does not support the type "${n.type}"`);return}const e=this.generateNameByType(n.type),r=this.stage.width(),a=this.stage.height(),l={x:r/2,y:a/2,fill:Konva.Util.getRandomColor(),stroke:"",strokeWidth:0,draggable:!0,strokeScaleEnabled:!1,text:((h=n.attrs)==null?void 0:h.text)||magicai_localize.double_click_to_edit,fontSize:30,fontStyle:"normal 400",id:`${e.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,name:e,perfectDrawEnabled:!1,offset:{x:0,y:0},...n.attrs},u=new Konva[n.type](l);return l.x==="left"&&u.x(0),l.x==="center"&&u.x((r-u.width())/2),l.x==="right"&&u.x(r-u.width()),l.y==="top"&&u.y(0),l.y==="middle"&&u.y((a-u.height())/2),l.y==="bottom"&&u.y(a-u.height()),n.type==="Group"&&this.addGroupHighlighter(u),["Text","TextPath"].includes(n.type)&&this.handleTextEdit(u),n.type==="Image"&&(l.fillSource?this.fetchedAssets.includes(l.fillSource)||l.fillSource===this.placeholderImage?this.setNodeFillPattern({node:u,url:l.fillSource}):this.handleUploadImage(u,l.fillSource):this.setNodeFillPattern({node:u,url:this.placeholderImage})),u.on("heightChange widthChange innerRadiusChange outerRadiusChange radiusChange radiusXChange radiusYChange",()=>{this.handleFillCover(u)}),u.on(this.historyListeners.map(f=>f+="Change").join(" "),this.addToHistory),u},addNodeToStage(n={type:"Ellipse",attrs:{},beforeAdd:null,node:null,addHistory:!0}){if(!this.stageInitiated)return;const e=n.node||this.createNode(n),r=n.addHistory??!0;return n.beforeAdd&&typeof n.beforeAdd=="function"&&n.beforeAdd.call(this,e),this.showWelcomeScreen=!1,this.layer.add(e),this.selectedNodes={nodes:[e]},r&&this.addToHistory(),e},addGroupHighlighter(n){const e=new Konva.Transformer({id:`highlighter-${n.id()}`,name:"lqd-cs-highlighter",enabledAnchors:[],rotateEnabled:!1,borderStroke:this.selectionColors.stroke,draggable:!1});n.setAttr("highlighter",e.id()),this.layer.add(e)},handleHighlighterVisibility(n){let e="",r="",a=n;n.on("mouseover",l=>{const u=l.evt.ctrlKey||l.evt.metaKey,f=n.findAncestors("Group").at(-1);if(!u&&f&&(a=f),a.getType()==="Group"&&u)return;const g=this.layer.findOne(`#highlighter-${a.id()}`),v=this.selectedNodes.find(y=>y.id()===a.id());e=n.stroke(),r=n.strokeWidth(),v||(g&&g.nodes([a]),a.stroke(this.selectionColors.stroke),a.strokeWidth(r??2))}),n.on("mouseout",()=>{const l=a.getAttr("highlighter");l&&this.layer.findOne(`#${l}`).nodes([]),a.stroke(e),a.strokeWidth(r),a=n})},applyFilters(n,e){e.blurRadius?(n.clearCache(),n.cache(),n.filters([Konva.Filters.Blur])):!e.blurRadius&&!n.blurRadius()&&n.isCached()&&n.clearCache()},handleTextEdit(n){n.off("dblclick.editText dbltap.editText"),n.on("dblclick.editText dbltap.editText",()=>{if(n.getAttr("aiTaskInProgress"))return toastr.warn("An AI task is in progress. please wait until it's done.");n.hide(),this.selectionTransformer.hide(),this.editingTextarea=document.createElement("textarea"),this.container.insertAdjacentElement("afterend",this.editingTextarea),this.editingTextarea.classList.add("absolute","border-none","p-0","m-0","overflow-hidden","bg-transparent","outline-none","resize-none","whitespace-pre","origin-top-left","placeholder:text-transparent"),this.editingTextNode=n;const e=n.fontStyle().split(" "),r=this.editingTextNode.text();let a=e[0],l=e[1];isNaN(parseInt(a))||(a=null,l=a),this.editingTextarea.style.fontFamily=n.fontFamily(),this.editingTextarea.style.textAlign=n.align(),this.editingTextarea.style.color=n.fill().toString(),this.editingTextarea.style.transformOrigin="top left",this.editingTextarea.style.textDecoration=n.textDecoration(),this.editingTextarea.value=n.text(),this.editingTextarea.placeholder=this.editingTextarea.value,a&&(this.editingTextarea.style.fontStyle=a),l&&(this.editingTextarea.style.fontWeight=l),this.editingTextarea.focus(),this.editingTextarea.select(),this.positionEditingTextarea(),this.editingTextarea.addEventListener("keydown",u=>{if(this.editingTextarea){if(u.key==="Enter"&&!u.shiftKey){this.setEditingTextareaTextAndRemove();return}if(u.key==="Escape"){this.setEditingTextareaTextAndRemove(r);return}this.editingTextarea.placeholder=this.editingTextarea.value,this.editingTextarea.style.height="auto",this.editingTextarea.style.height=this.editingTextarea.scrollHeight+n.fontSize()+"px"}}),this.$nextTick(()=>{this.editingTextarea.addEventListener("focusout",this.setEditingTextareaTextAndRemove),window.addEventListener("click",this.handleEditinTextareaOutsideClick),window.addEventListener("tap",this.handleEditinTextareaOutsideClick)})}),n.on("fontFamilyChange fontSizeChange fontStyleChange textDecorationChange lineHeightChange letterSpacingChange",({newVal:e,type:r})=>{if(e==null||r==null||!this.editingTextarea)return;const a=r.replace("Change","");let l=e;(a==="letterSpacing"||a==="fontSize")&&(l+="px"),this.editingTextarea.style[a]=l})},handleEditinTextareaOutsideClick(n){this.editingTextNode&&n.target!==this.editingTextarea&&this.setEditingTextareaTextAndRemove(this.editingTextarea.value)},removeEditingTextarea(){var n;!this.editingTextNode||!this.editingTextarea||(this.editingTextarea.removeEventListener("focusout",this.setEditingTextareaTextAndRemove),(n=this.editingTextarea)==null||n.remove(),window.removeEventListener("click",this.handleEditinTextareaOutsideClick),window.removeEventListener("tap",this.handleEditinTextareaOutsideClick),this.editingTextNode.show(),this.selectionTransformer.show(),this.selectionTransformer.forceUpdate(),this.editingTextNode=null,this.editingTextarea=null)},setEditingTextareaTextAndRemove(n){var e;!this.editingTextarea||!this.editingTextNode||(typeof n!="string"&&(n=((e=this.editingTextarea)==null?void 0:e.value)??""),this.editingTextNode.text(n),this.removeEditingTextarea())},positionEditingTextarea(){if(!this.editingTextNode)return;const n=this.editingTextNode.getClientRect(),e=this.zoomLevel/100,r={x:n.x*e,y:n.y*e},a=this.konvajsContent.getBoundingClientRect(),l=this.editingTextNode.rotation(),h=this.editingTextNode.getClassName()==="TextPath",f=this.isMobile()?16:10;h&&(r.x+=n.width/2*e,r.y+=n.height/2*e),this.editingTextarea.style.width="auto",this.editingTextarea.style.height="auto",this.editingTextarea.style.top=Math.max(0,a.top+r.y)+"px",this.editingTextarea.style.left=Math.max(0,a.left+r.x)+"px",this.editingTextarea.style.fontSize=Math.max(f,this.editingTextNode.fontSize()*e)+"px",this.editingTextarea.style.letterSpacing=this.editingTextNode.letterSpacing()*e+"px",this.editingTextarea.style.lineHeight=h?"1.2":this.editingTextNode.lineHeight().toString(),this.$nextTick(()=>{this.editingTextarea.style.width=(h?this.stage.width():this.editingTextNode.width())*e+"px",this.editingTextarea.style.height=this.editingTextarea.scrollHeight+this.editingTextNode.fontSize()*this.editingTextNode.lineHeight()+"px"}),l&&!h&&(this.editingTextarea.style.transform=`rotate(${l}deg)`)},updateSelectionTransformerStroke(){const e=100/this.zoomLevel,r=1*Math.min(3,Math.max(.5,e)),l=6*Math.min(3,Math.max(.5,e));this.selectionTransformer.borderStrokeWidth(r),this.selectionTransformer.anchorSize(l)},getNodesFromOptions(n={ids:[],nodes:[],id:null,node:null}){var r,a,l;let e=[];return(r=n.nodes)!=null&&r.length?n.nodes==="all"?e=this.nodes:e=n.nodes:(a=n.ids)!=null&&a.length?e=this.nodes.filter(u=>n.ids.includes(u.id())):n.id?e=[this.nodes.find(u=>u.id()===n.id)]:n.node&&(this.nodes.find(u=>{var h;return u.id()===((h=n.node)==null?void 0:h.id())})?e=[n.node]:console.warn("Could not find the node: ",((l=n.node)==null?void 0:l.id())??"Unknown node ID")),e},deselectNodes(n){const e=this.getNodesFromOptions(n).map(r=>r.id());this.selectedNodes={nodes:this.selectedNodes.filter(r=>!e.includes(r.id()))}},removeNodes(n){const e=this.getNodesFromOptions(n);this.deselectNodes({nodes:e}),e.forEach(r=>r.remove())},destroyNodes(n){const e=this.getNodesFromOptions(n);this.deselectNodes({nodes:e}),e.forEach(r=>r.destroy()),this.nodes.length||(this.showWelcomeScreen=!0)},destroySelectedNodes(){this.destroyNodes({nodes:this.selectedNodes})},cloneSelectedNodes(){const n=this.selectedNodes.map(e=>{const r=this.generateNameByType(e.getClassName());return e.clone({x:e.x()+20,y:e.y()+20,name:r,id:`${r.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`})});n.filter(e=>["Text","TextPath"].includes(e.getClassName())).forEach(e=>this.handleTextEdit(e)),this.layer.add(...n),this.selectedNodes={nodes:n}},groupSelectedNodes(){const n=this.selectedNodes;if(!n.length)return;this.generateNameByType("Group");const e=this.addNodeToStage({type:"Group",attrs:{x:0,y:0,width:null,height:null,fill:null,draggable:!0}});n.forEach(r=>{e.add(r),r.draggable(!1)}),this.layer.add(e),this.addGroupHighlighter(e),this.selectedNodes={nodes:[e]}},ungroupSelectedNodes(){const n=this.selectedNodes;if(!n.length)return;n.filter(r=>r.getType()==="Group").forEach(r=>{const a=r.getChildren(),l=r.findAncestors("Group"),u=l==null?void 0:l.at(0),h=r.id(),f=r.getAttr("highlighter"),g=[];a.forEach(v=>{v.findAncestors("Group").length<=1&&g.push(v)}),g.forEach(v=>{const y=v.getAbsolutePosition(u??this.stage),S=v.rotation(),C=r.rotation(),A=(S+C)%360;v.moveTo(u??this.layer),v.position(y),v.rotation(A),v.draggable(!u)}),this.destroyNodes({ids:[h,f]}),this.selectedNodes={nodes:g}})},getNodesByType(n){return n?this.nodes.filter(e=>e.getClassName()===n):[]},generateNameByType(n){var l;if(!n)return"Node 0";const e=this.getNodesByType(n),r=e.length;return`${((l=e[0])==null?void 0:l.getClassName())||n} ${r+1}`},moveNode(n){this.selectedNodes.forEach(e=>e[n]())},initLayers(){const e=(navigator.userAgentData?navigator.userAgentData.platform.includes("macOS"):navigator.platform.includes("Mac"))?"Meta":"Control";this.layersSortable=Z.create(this.$refs.layers,{multiDrag:!0,selectedClass:"selected",multiDragKey:e,animation:150,draggable:".lqd-cs-layer",filter:".lqd-cs-layers-list-template",onSelect:r=>{const a=r.originalEvent.target,l=r.items.map(u=>u.dataset.id);this.selectedNodes={ids:l},this.elementIsFocusable(a)||this.$nextTick(()=>{this.container.focus()})},onEnd:()=>{const r=[...this.nodes],a=this.selectedNodes,l=this.layersSortable.toArray();r.sort((u,h)=>{const f=l.indexOf(u.id());return l.indexOf(h.id())-f}),bn.defer(()=>this.removeNodes({nodes:"all"})),bn.defer(()=>{this.layer.add(...r),this.selectedNodes={nodes:a}})}})},alignSelectedNodes(n){const e=this.selectedNodes;if(e.length===1){const a=e[0],l=a.getClientRect(),u=this.stage.width(),h=this.stage.height(),f=a.x(),g=a.y();switch(n){case"left":a.x(f-l.x);break;case"center":a.x(f-l.x+(u-l.width)/2);break;case"right":a.x(f-l.x+u-l.width);break;case"top":a.y(g-l.y);break;case"middle":a.y(g-l.y+(h-l.height)/2);break;case"bottom":a.y(g-l.y+h-l.height);break}return}const r=e.reduce((a,l)=>{const u=l.getClientRect();return{left:Math.min(a.left,u.x),right:Math.max(a.right,u.x+u.width),top:Math.min(a.top,u.y),bottom:Math.max(a.bottom,u.y+u.height),centerX:(a.left+a.right)/2,centerY:(a.top+a.bottom)/2}},{left:1/0,right:-1/0,top:1/0,bottom:-1/0,centerX:0,centerY:0});r.centerX=(r.left+r.right)/2,r.centerY=(r.top+r.bottom)/2,e.forEach(a=>{const l=a.getClientRect(),u=a.x(),h=a.y();switch(n){case"left":a.x(u-(l.x-r.left));break;case"center":a.x(u+(r.centerX-(l.x+l.width/2)));break;case"right":a.x(u+(r.right-(l.x+l.width)));break;case"top":a.y(h-(l.y-r.top));break;case"middle":a.y(h+(r.centerY-(l.y+l.height/2)));break;case"bottom":a.y(h+(r.bottom-(l.y+l.height)));break}})},rotatePoint({x:n,y:e},r){const a=Math.cos(r),l=Math.sin(r);return{x:n*a-e*l,y:e*a+n*l}},rotateNodeAroundCenter(n,e){const r={x:-n.width()/2,y:-n.height()/2},a=this.rotatePoint(r,Konva.getAngle(n.rotation())),l=this.rotatePoint(r,Konva.getAngle(e)),u=l.x-a.x,h=l.y-a.y,f=n.x()+u,g=n.y()+h;return{rotation:e,x:f,y:g}},isPropertyNotApplicableToNodeType(n,e){return n==="cornerRadius"&&!["Rect","Image"].includes(e)||n==="sides"&&e!=="RegularPolygon"||n==="numPoints"&&e!=="Star"||n==="innerRadius"&&!["Star","Ring","Arc"].includes(e)||n==="outerRadius"&&!["Star","Ring","Arc"].includes(e)||n==="angle"&&!["Arc","Wedge"].includes(e)||["fontSize","fontFamily","fontSize","fontStyle","fontWeight","textDecoration","letterSpacing","align"].includes(n)&&!["Text","TextPath"].includes(e)||n==="lineHeight"&&e!=="Text"},formatPropertyValue(n,e){return typeof e=="number"?n==="opacity"?e.toFixed(2):Number.isInteger(e)?e:e.toFixed(1):n==="fontStyle"&&e==="normal"?400:e},handleFillCover(n){n.getAttr("fillCover")&&this.applyFillCover(n)},async handleUploadImage(n,e){if(e)return e.startsWith("localhost/")?e=window.location.origin+"/"+e.substring(10):e.startsWith("http://localhost/")&&(e=e.replace("http://localhost/",window.location.origin+"/")),fetch(e).then(a=>a.blob()).then(async a=>{const l=new File([a],"image",{type:a.type}),u=await this.uploadImage({file:l,node:n});await this.setNodeFillPattern({node:n,url:u.url})}).catch(a=>{toastr.error("Failed to load image"),console.error("Error creating file from URL:",a)});const r=document.createElement("input");r.type="file",r.accept="image/*",r.style.display="none",document.body.appendChild(r),r.addEventListener("cancel",async a=>{!a.target.files[0]&&!n.fillPatternImage()&&this.destroyNodes({nodes:[n]})}),r.addEventListener("change",async a=>{const l=await this.uploadImage({event:a,node:n});await this.setNodeFillPattern({node:n,url:l.url}),this.activeFillTab="image",this.$nextTick(()=>{document.body.removeChild(r)})}),r.click()},async uploadImage({node:n,event:e,file:r}){if(e&&!r&&(r=e.target.files[0]),!r||!n)return;if(!r.type.startsWith("image/")){toastr.error("Please upload a valid image file");return}const a=new FormData;return a.append("image",r),(await(await fetch(`${window.location.origin}/dashboard/user/creative-suite/image/upload`,{method:"POST",body:a,headers:{Accept:"application/json"}})).json()).data},async setNodeFillPattern({node:n,url:e,setSize:r=!0}){const a=new Image;return new Promise((l,u)=>{a.onload=()=>{n.fillPatternImage(a),n.fillPriority("pattern"),n.setAttr("fillImageWidth",a.naturalWidth),n.setAttr("fillImageHeight",a.naturalHeight),n.setAttr("fillSource",a.src),n.setAttr("fillCover",!0),this.applyFillCover(n),l(a),this.fetchedAssets.includes(e)||this.fetchedAssets.push(e)},a.onerror=function(h){u(h)},e.startsWith("localhost/")?e=window.location.origin+"/"+e.substring(10):e.startsWith("http://localhost/")&&(e=e.replace("http://localhost/",window.location.origin+"/")),a.src=e})},removeFillPattern(){const n=this.selectedNodes[0];n.fillPatternImage(null),n.fillPriority("color"),this.$refs.selectedNodeFillPatternInput&&(this.$refs.selectedNodeFillPatternInput.value=""),n.setAttr("fillImageWidth",null),n.setAttr("fillImageHeight",null),n.setAttr("fillSource",null),n.setAttr("fillCover",null),n.setAttr("fillAlign",null)},getFillCoverProps(n){const e=n.getAttr("fillAlign")??"center-middle",r=n.getClassName(),a=n.getClientRect(),l=n.getAttr("fillImageWidth")??a.width,u=n.getAttr("fillImageHeight")??a.height;let h,f,g=!1;r==="Circle"?h=f=n.radius()*2:r==="Ellipse"?(h=n.radiusX()*2,f=n.radiusY()*2):["Rect","Image","Text"].includes(r)?(h=n.width(),f=n.height()):(h=a.width,f=a.height,g=!0);const v=l/u,y=h/f;let S,C;y>=v?(S=h/l,C=h/v/u):(S=f*v/l,C=f/u);const A=l*S,R=u*C;let M=0,z=0;return g||!["Rect","Image","Text"].includes(r)?(e.includes("left")?M=-h/2:e.includes("center")?M=-A/2:e.includes("right")&&(M=-A+h/2),e.includes("top")?z=-f/2:e.includes("middle")?z=-R/2:e.includes("bottom")&&(z=-R+f/2)):(e.includes("left")?M=0:e.includes("center")?M=(h-A)/2:e.includes("right")&&(M=h-A),e.includes("top")?z=0:e.includes("middle")?z=(f-R)/2:e.includes("bottom")&&(z=f-R)),r==="Path"&&g&&(M+=a.x,z+=a.y),{offsetX:M,offsetY:z,scaleX:S,scaleY:C}},applyFillCover(n){if(n=n??this.selectedNodes[0],!n)return;n.setAttr("fillPatternRepeat","no-repeat");const e=this.getFillCoverProps(n);n.setAttrs({fillPatternX:e.offsetX,fillPatternY:e.offsetY,fillPatternScaleX:e.scaleX,fillPatternScaleY:e.scaleY})},onFontsSearchInput(){const n=this.$event.target.value.trim();if(!n){this.fontsPaginationCurrent=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit);return}this.showingGoogleFonts=this.googleFontsList.filter(e=>e.toLowerCase().includes(n.toLowerCase()))},loadMoreFonts(){this.fontsPaginationCurrent+=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationCurrent)},addToGoogleFontLoadQueue(n,e=!1){if(!(e&&this.lqdFontPreview.includes(n))){if(!e)return this.loadGoogleFontFull(n);this.loadingFontPreviewQueue.push(n),this.loadGoogleFontPreview(n),this.lqdFontPreview.push(n)}},loadGoogleFontPreview(){if(!this.loadingFontPreviewQueue.length)return;const n=this.loadingFontPreviewQueue.map(a=>`family=${a}`).join("&").replaceAll(" ","+"),e=encodeURIComponent(this.loadingFontPreviewQueue.join("")),r=`https://fonts.googleapis.com/css2?${n}&display=swap&text=${e}`;this.createFontLink(r),this.loadingFontPreviewQueue=[]},async loadGoogleFontFull(n){const e=`https://fonts.googleapis.com/css2?family=${n.replaceAll(/ /g,"+")}:wght@400;500;600;700;800;900&display=swap`;this.createFontLink(e),document.fonts.ready.finally(()=>{this.selectedNodes.find(r=>["Text","TextPath"].includes(r.getClassName()))&&this.selectionTransformer.forceUpdate()})},createFontLink(n){const e=document.createElement("link");e.href=n,e.rel="stylesheet",e.type="text/css",document.head.appendChild(e)},handleStageResize({width:n,height:e,preserveAspectRatio:r=!1}){if(n==null&&e==null)return;const a=parseInt(this.stage.width(),10),l=parseInt(this.stage.height(),10);let u=n??a,h=e??l;if(r&&a&&l){const f=a/l;if(n&&!e)h=u/f;else if(!n&&e)u=h*f;else if(n&&e){const g=u/h;g>f?u=h*f:g<f&&(h=u/f)}}this.prevStageWidth=a,this.prevStageHeight=l,this.resizeStage(u,h)},resizeStage(n,e){this.stage.width(n),this.stage.height(e),this.container.style.width=n+"px",this.container.style.height=e+"px";const r=n/(this.prevStageWidth??1),a=e/(this.prevStageHeight??1);if(this.adaptiveResize&&this.prevStageWidth>0&&this.prevStageHeight>0){const u=n>this.prevStageWidth||e>this.prevStageHeight?Math.max(r,a):Math.min(r,a);this.nodes.forEach(h=>{h.x(h.x()*r),h.y(h.y()*a);const f=h.getClassName();if(h.width&&h.height){const g=h.width(),v=h.height();h.width(g*u),h.height(v*u)}if(f==="Circle"&&h.radius(h.radius()*u),f==="Ellipse"){const g=h.radiusX(),v=h.radiusY();h.radiusX(g*u),h.radiusY(v*u)}f==="RegularPolygon"&&h.radius(h.radius()*u),f==="Star"&&(h.innerRadius(h.innerRadius()*u),h.outerRadius(h.outerRadius()*u)),(f==="Text"||f==="TextPath")&&h.fontSize(h.fontSize()*u),h.fillPatternImage&&h.fillPatternScaleX&&h.fillPatternScaleY&&(h.fillPatternScaleX(h.fillPatternScaleX()*u),h.fillPatternScaleY(h.fillPatternScaleY()*u))}),bn.defer(()=>{this.selectionTransformer.forceUpdate(),this.fitToScreen(),this.setContainerDimensions()})}},switchView(n){if(!(this.editingTextNode||this.tool)){if(n==="<"){this.currentView=this.prevViews.pop()||"home";return}this.prevViews.push(this.currentView),this.currentView=n||"home"}},getZoomPadding(){const n=getComputedStyle(this.$el),e=15,r=parseInt(n.getPropertyValue("--sidebar-w")??0,10)+e,a=parseInt(n.getPropertyValue("--header-h")??0,10)+e;return{x:r,y:a}},getFitToScreenZoom(){const n=this.getZoomPadding(),e=(this.container.clientWidth-n.x)/(this.konvajsContent.clientWidth*(this.zoomLevel/100)),r=(this.container.clientHeight-n.y)/(this.konvajsContent.clientHeight*(this.zoomLevel/100)),a=Math.min(e,r)*100;return Math.max(this.minZoom,Math.min(this.maxZoom,a))},setZoomLevel(n){this.zoomLevel=Math.max(this.minZoom,Math.min(this.maxZoom,n)),this.reachedMinZoom=this.zoomLevel===this.minZoom,this.reachedMaxZoom=this.zoomLevel>=this.maxZoom},zoomIn(){this.setZoomLevel(this.zoomLevel+10)},zoomOut(){this.setZoomLevel(this.zoomLevel-10)},fitToScreen(){const n=this.getFitToScreenZoom();this.setZoomLevel(n);const e=this.getZoomPadding();this.zoomOffsetX=e.x/2,this.zoomOffsetY=e.y/2},positionTooltip(){if(!this.selectedNodes.length)return;const n=this.konvajsContent.getBoundingClientRect(),e=this.selectedNodesRect,r=this.zoomLevel/100,a=n.left+e.x*r+e.width*r/2,l=n.top+e.y*r-40,h=this.$refs.tooltip.getBoundingClientRect().height,f=Math.max(n.left,Math.min(a,n.right)),g=Math.max(n.top-h/2,Math.min(l,n.bottom-h/2));this._tooltipAnimationFrame||(this._tooltipAnimationFrame=requestAnimationFrame(()=>{this.$refs.tooltip.style.left=`${f}px`,this.$refs.tooltip.style.top=`${g}px`,this._tooltipAnimationFrame=null}))},handlePanAndZoom(){let n={x:0,y:0},e=0,r={x:0,y:0},a={x:0,y:0},l={x:0,y:0};const u=M=>{if(this.showWelcomeScreen)return;M.preventDefault();const z=this.konvajsContent.getBoundingClientRect(),N=M.clientX-z.left,B=M.clientY-z.top;if(M.metaKey||M.ctrlKey){const ft=(M.deltaY<0?1:-1)*2,ut=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoomLevel+ft)),dt=ut/this.zoomLevel;this.setZoomLevel(ut);const xt={x:z.width/2,y:z.height/2},nt={x:(N-xt.x)/this.zoomLevel,y:(B-xt.y)/this.zoomLevel};this.zoomOffsetX-=nt.x*(dt-1),this.zoomOffsetY-=nt.y*(dt-1)}else{const G=this.zoomLevel/15;this.zoomOffsetX-=M.deltaX/G,this.zoomOffsetY-=M.deltaY/G}},h=M=>{this.docActiveElementIsWritable()||M.code==="Space"&&!M.repeat&&!this.isSpacePressed&&!this.showWelcomeScreen&&(this.isSpacePressed=!0,document.body.classList.add("is-panning"),this.container.classList.add("is-panning"),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this.container.focus(),M.preventDefault())},f=M=>{this.docActiveElementIsWritable()||M.code==="Space"&&(this.isSpacePressed=!1,this.isPanning=!1,document.body.classList.remove("is-panning","is-panning-active"),this.container.classList.remove("is-panning","is-panning-active"))},g=M=>{this.docActiveElementIsWritable()||this.isSpacePressed&&M.button===0&&!this.showWelcomeScreen&&(this.isPanning=!0,n={x:M.clientX,y:M.clientY},document.body.classList.add("is-panning-active"),this.container.classList.add("is-panning-active"),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this.container.focus(),M.stopPropagation(),M.preventDefault())},v=M=>{if(!this.docActiveElementIsWritable()&&this.isPanning){const z=M.clientX-n.x,N=M.clientY-n.y;n={x:M.clientX,y:M.clientY},this.zoomOffsetX+=z/(this.zoomLevel/15),this.zoomOffsetY+=N/(this.zoomLevel/15),M.preventDefault(),M.stopPropagation()}},y=()=>{this.docActiveElementIsWritable()||this.isPanning&&(this.isPanning=!1,document.body.classList.remove("is-panning-active"),this.container.classList.remove("is-panning-active"))},S=()=>{this.docActiveElementIsWritable()||this.isPanning&&(this.isPanning=!1,document.body.classList.remove("is-panning-active"),this.container.classList.remove("is-panning-active"))},C=M=>{const z=M.touches;if(this.showWelcomeScreen||z.length<2)return;const N=z[0],B=z[1];N&&B&&this.stage.stopDrag(!1),e=Math.hypot(B.clientX-N.clientX,B.clientY-N.clientY);const G=this.konvajsContent.getBoundingClientRect();r={x:(N.clientX+B.clientX)/2-G.left,y:(N.clientY+B.clientY)/2-G.top},a={x:(N.clientX+B.clientX)/2,y:(N.clientY+B.clientY)/2},l={x:this.zoomOffsetX,y:this.zoomOffsetY}},A=M=>{const z=M.touches;if(!(this.showWelcomeScreen||z.length<2)&&(M.preventDefault(),z.length===2)){const N=z[0],B=z[1];if(N&&B){const G={x:(N.clientX+B.clientX)/2,y:(N.clientY+B.clientY)/2},ft=G.x-a.x,ut=G.y-a.y;this.zoomOffsetX=l.x+ft/(this.zoomLevel/15),this.zoomOffsetY=l.y+ut/(this.zoomLevel/15);const dt=Math.hypot(B.clientX-N.clientX,B.clientY-N.clientY),xt=dt/e;if(e>0&&xt!==1){const nt=this.konvajsContent.getBoundingClientRect(),Jt={x:(N.clientX+B.clientX)/2-nt.left,y:(N.clientY+B.clientY)/2-nt.top},It=Math.max(this.minZoom,Math.min(this.maxZoom,this.zoomLevel*xt)),Vt=this.zoomLevel,Ot=It/Vt;this.setZoomLevel(It);const jt=nt.width/2,wt=nt.height/2,Ct=(r.x-jt)/Vt,Ht=(r.y-wt)/Vt;this.zoomOffsetX-=Ct*(Ot-1),this.zoomOffsetY-=Ht*(Ot-1),e=dt,r=Jt}}}},R=M=>{this.showWelcomeScreen||(e=0,r={x:0,y:0},this.stage.draggable(!0))};this.container.addEventListener("wheel",u,{passive:!1}),this.container.addEventListener("mousedown",g),this.container.addEventListener("touchstart",C),this.container.addEventListener("touchmove",A),this.container.addEventListener("touchend",R),this.container.addEventListener("touchcancel",R),document.addEventListener("keydown",h),document.addEventListener("keyup",f),document.addEventListener("mousemove",v),document.addEventListener("mouseup",y),document.addEventListener("mouseleave",S),window.addEventListener("resize",this.positionTooltip),this.selectionTransformer.on("transform",this.positionTooltip),document.addEventListener("nodes-selected",this.positionTooltip)},initNodesSnap(){let n=this.nodes,e=[];const r=()=>{var h=[0,this.stage.width()/2,this.stage.width()],f=[0,this.stage.height()/2,this.stage.height()];return n.forEach(g=>{if(!this.selectionTransformer.nodes().find(y=>y.id()===g.id())){var v=g.getClientRect();h.push([v.x,v.x+v.width,v.x+v.width/2]),f.push([v.y,v.y+v.height,v.y+v.height/2])}}),{vertical:h.flat(),horizontal:f.flat()}},a=()=>{const h=this.selectionTransformer.getClientRect(),f=this.selectionTransformer.absolutePosition();return h.height=h.height-this.selectionTransformer.rotateAnchorOffset(),h.y=h.y+this.selectionTransformer.rotateAnchorOffset(),{vertical:[{guide:Math.round(h.x),offset:Math.round(f.x-h.x),snap:"start"},{guide:Math.round(h.x+h.width/2),offset:Math.round(f.x-h.x-h.width/2),snap:"center"},{guide:Math.round(h.x+h.width),offset:Math.round(f.x-h.x-h.width),snap:"end"}],horizontal:[{guide:Math.round(h.y),offset:Math.round(f.y-h.y),snap:"start"},{guide:Math.round(h.y+h.height/2),offset:Math.round(f.y-h.y-h.height/2),snap:"center"},{guide:Math.round(h.y+h.height),offset:Math.round(f.y-h.y-h.height),snap:"end"}]}},l=(h,f)=>{var g=[],v=[];h.vertical.forEach(A=>{f.vertical.forEach(R=>{var M=Math.abs(A-R.guide);M<this.guidelineOffset&&g.push({lineGuide:A,diff:M,snap:R.snap,offset:R.offset})})}),h.horizontal.forEach(A=>{f.horizontal.forEach(R=>{var M=Math.abs(A-R.guide);M<this.guidelineOffset&&v.push({lineGuide:A,diff:M,snap:R.snap,offset:R.offset})})});var y=[],S=g.sort((A,R)=>A.diff-R.diff)[0],C=v.sort((A,R)=>A.diff-R.diff)[0];return S&&y.push({lineGuide:S.lineGuide,offset:S.offset,orientation:"V",snap:S.snap}),C&&y.push({lineGuide:C.lineGuide,offset:C.offset,orientation:"H",snap:C.snap}),y},u=h=>{h.forEach(f=>{const g=f.orientation==="H";var v=new Konva.Line({points:g?[-6e3,0,6e3,0]:[0,-6e3,0,6e3],stroke:this.selectionColors.stroke,strokeWidth:1,name:"lqd-cs-guide-line",dash:[4,6]});this.layer.add(v),v.absolutePosition({x:g?0:f.lineGuide,y:g?f.lineGuide:0})})};this.selectionTransformer.on("dragstart",()=>{n=this.nodes,e=[];const h=this.selectionTransformer.absolutePosition();this.selectedNodes.forEach(f=>{const g=f.absolutePosition();e.push({id:f.id(),xDiff:g.x-h.x,yDiff:g.y-h.y})})}),this.selectionTransformer.on("dragmove",h=>{this.layer.find(".lqd-cs-guide-line").forEach(S=>S.destroy());var f=r(),g=a(),v=l(f,g);if(!v.length){this.positionTooltip();return}u(v);const y={...this.selectionTransformer.absolutePosition()};v.forEach(S=>{switch(S.orientation){case"V":{y.x=S.lineGuide+S.offset;break}case"H":{y.y=S.lineGuide+S.offset;break}}}),this.selectionTransformer.absolutePosition(y),this.selectedNodes.forEach(S=>{const C=e.find(A=>A.id===S.id());C&&S.absolutePosition({x:y.x+C.xDiff,y:y.y+C.yDiff})}),this.positionTooltip()}),this.layer.on("dragend",()=>{this.layer.find(".lqd-cs-guide-line").forEach(h=>h.destroy())})},addToHistory(){this.history.length>this.maxHistoryLength-1&&this.history.shift(),this.historyPointer!==this.history.length-1&&(this.history=this.history.slice(0,this.historyPointer+1)),this.history.push({stage:{width:this.stage.width(),height:this.stage.height()},zoom:{zoomOffsetX:this.zoomOffsetX,zoomOffsetY:this.zoomOffsetY,zoomLevel:this.zoomLevel},nodes:this.nodes.map(n=>n.toJSON()),selectedNodeIds:this.selectedNodes.map(n=>n.id())}),this.historyPointer=Math.min(this.history.length-1,this.historyPointer+1)},undo(){this.historyPointer!==-1&&(this.historyPointer=Math.max(-1,this.historyPointer-1),this.applyHistory())},redo(){this.historyPointer!==this.history.length-1&&(this.historyPointer=Math.min(this.history.length-1,this.historyPointer+1),this.applyHistory())},applyHistory(){var l,u,h;if(this.historyPointer===-1)return this.destroyNodes({nodes:"all"});const n=this.history[this.historyPointer];if(!n)return;const e=this.stage.width(),r=this.stage.height();let a=!1;(l=n.stage)!=null&&l.width&&n.stage.width!==e&&(this.stage.width(n.stage.width),a=!0),(u=n.stage)!=null&&u.height&&n.stage.height!==r&&(this.stage.height(n.stage.height),a=!0),a&&n.zoom&&this.$nextTick(()=>{this.fitToScreen()}),this.destroyNodes({nodes:"all"}),(h=n.nodes)==null||h.forEach(f=>{try{const g=Konva.Node.create(f),v=g.getClassName(),y=g.getAttrs();this.addNodeToStage({type:v,attrs:y,addHistory:!1}),g.destroy(),n.selectedNodeIds&&(this.selectedNodes={ids:n.selectedNodeIds})}catch(g){console.error("Error creating node:",g)}})},downloadImage(){if(this.stage){this.busy=!0;try{const n=this.selectionTransformer.visible();this.selectionTransformer.visible(!1);const e=document.createElement("div");e.style.position="absolute",e.style.zIndex="-1",e.style.opacity="0",e.style.width=`${this.stage.width()}px`,e.style.height=`${this.stage.height()}px`,document.body.appendChild(e);const r=new Konva.Stage({container:e,width:this.stage.width(),height:this.stage.height(),background:"white"}),a=this.layer.clone();a.find("#lqd-cs-selection-transformer, #lqd-cs-selection-rectangle").forEach(l=>{l.remove()}),r.add(a),r.toDataURL({mimeType:"image/png",quality:1,pixelRatio:2,callback:l=>{const u=document.createElement("a");u.download=`canvas-export-${new Date().getTime()}.png`,u.href=l,document.body.appendChild(u),u.click(),document.body.removeChild(u),document.body.removeChild(e),r.destroy(),this.selectionTransformer.visible(n),this.busy=!1}})}catch(n){console.error("Error exporting image:",n),this.busy=!1,this.selectionTransformer.visible(!0)}}},resetCanvas(){this.nodes.length&&confirm(magicai_localize.all_your_current_edits_will_be_lost__are_you_sure_)&&(this.resetHistory(),this.destroyNodes({nodes:"all"}),this.fitToScreen(),this.currentDocId=null,this.currentDocName=null)},resetHistory(){this.history=[],this.historyPointer=-1},beforeUnloadHandler(n){if(this.nodes.length>0){const e=magicai_localize.you_have_unsaved_changes__are_you_sure_you_want_to_leave_;return n.preventDefault(),n.returnValue=e,e}},addBeforeUnloadListener(){this.beforeUnloadListened=!0,window.addEventListener("beforeunload",this.beforeUnloadHandler)},removeBeforeUnloadListener(){this.beforeUnloadListened=!1,window.removeEventListener("beforeunload",this.beforeUnloadHandler)},handleExport(){if(!(!this.stage||!this.nodes.length))try{const n=this.getExportData(),e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n)),r=document.createElement("a");r.setAttribute("href",e),r.setAttribute("download",`canvas-export-${new Date().getTime()}.json`),document.body.appendChild(r),r.click(),r.remove(),toastr.success("Canvas exported successfully")}catch(n){console.error("Error exporting canvas:",n),toastr.error("Failed to export canvas")}},getExportData(){const n=this.nodes.map(e=>e.toJSON());return{name:this.currentDocName||"Untitled Document",stage:{width:this.stage.width(),height:this.stage.height()},nodes:n}},handleImport(){const n=document.createElement("input");n.type="file",n.accept=".json",n.style.display="none",n.addEventListener("change",e=>{const r=e.target.files[0];if(!r)return;const a=new FileReader;a.onload=l=>{try{const u=JSON.parse(l.target.result);this.importData({data:u}),this.currentView!=="editor"&&this.switchView("editor"),toastr.success("Canvas imported successfully")}catch(u){console.error("Error importing canvas:",u),toastr.error("Failed to import canvas")}},a.readAsText(r),n.remove()}),document.body.appendChild(n),n.click()},importData({data:n,docId:e=null,switchToEditor:r=!0}){if(!n.nodes||!Array.isArray(n.nodes))throw new Error("Invalid file format");(!this.nodes.length||this.nodes.length&&confirm(magicai_localize.all_your_current_edits_will_be_lost__are_you_sure_))&&(this.destroyNodes({nodes:"all"}),n.name&&(this.currentDocName=n.name),n.stage&&this.handleStageResize({width:n.stage.width,height:n.stage.height}),n.nodes.forEach(a=>{try{const l=Konva.Node.create(a),u=l.getClassName(),h=l.getAttrs();this.addNodeToStage({type:u,attrs:h,addHistory:!1,beforeAdd:f=>{h.fontFamily&&this.loadGoogleFontFull(h.fontFamily),u==="Group"&&l.getChildren().forEach(v=>{v.draggable(!1),f.add(v.clone())})}}),l.destroy()}catch(l){console.error("Error creating node:",l)}}),this.resetHistory(),this.currentDocId=e,r&&this.currentView!=="editor"&&this.switchView("editor"))},async loadTemplatesList(n,e="all"){if(n!=null){this.loadingTemplates=!0,this.loadingTemplatesFailed=!1;try{let r="/api/creative-suite/templates";e&&e!=="all"&&(r+=`?category=${encodeURIComponent(e)}`);const a=await fetch(r,{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(this.loadingTemplates=!1,!l.success||!l.data||!Array.isArray(l.data))throw new Error("Invalid API response format");this.templatesList=l.data,this.templatesPagination=l.pagination||{},this.templatesCategories=l.categories||[]}catch(r){console.error("Error loading templates:",r),this.loadingTemplates=!1,this.loadingTemplatesFailed=!0,toastr.error(magicai_localize.could_not_fetch_templates_list_please_try_again||"Could not fetch templates list. Please try again.")}}},loadTemplate(n){if(n==null)return;const e=this.templatesList.find(r=>r.id==n);if(!e)return toastr.error(magicai_localize.could_not_fetch_template_data_please_try_again||"Could not fetch template data. Please try again.");this.importData({data:e.data})},async saveDocument(){const n=this.getExportData(),e=new FormData,r=document.createElement("div");r.style.position="absolute",r.style.zIndex="-1",r.style.opacity="0",r.style.width=`${this.stage.width()}px`,r.style.height=`${this.stage.height()}px`,document.body.appendChild(r);const a=new Konva.Stage({container:r,width:this.stage.width(),height:this.stage.height(),background:"white"}),l=this.layer.clone();l.find("#lqd-cs-selection-transformer, #lqd-cs-selection-rectangle").forEach(h=>{h.remove()}),a.add(l);const u=await a.toBlob({mimeType:"image/png",quality:.7,pixelRatio:Math.min(2,Math.max(1,720/Math.min(720,a.width())))});document.body.removeChild(r),a.destroy(),e.append("payload",JSON.stringify(n)),e.append("preview",new File([u],"preview.png",{type:"image/png"})),this.currentDocId!=null&&e.append("id",this.currentDocId),this.currentDocName&&e.append("name",this.currentDocName);try{const h=await fetch(`${window.location.origin}/dashboard/user/creative-suite/document`,{method:"POST",body:e,headers:{Accept:"application/json"}});if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const f=await h.json();if(f.status==="error"){toastr.error(f.message||magicai_localize.error_saving_document);return}if(f.data.id){const g=document.querySelectorAll(`.lqd-cs-doc-item[data-id="${f.data.id}"]`);this.currentDocId=f.data.id;let v=f.data.preview_url;if(v&&v.startsWith("localhost/")?v=window.location.origin+"/"+v.substring(10):v&&v.startsWith("http://localhost/")&&(v=v.replace("http://localhost/",window.location.origin+"/")),g.length)g.forEach(y=>y.querySelector("img").src=v);else{const y={...f.data,preview:v};this.newItems.push(y)}}this.removeBeforeUnloadListener(),toastr.success(magicai_localize.saved_succesfully)}catch(h){toastr.error("Upload failed:",h)}},async duplicateDocument(n){if(!n)return;const e=new FormData;e.append("id",n);try{const r=await fetch(`${window.location.origin}/dashboard/user/creative-suite/document/duplicate`,{method:"POST",body:e,headers:{Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=await r.json();if(a.status==="error"){toastr.error(a.message||magicai_localize.error_saving_document);return}if(a.data){if(!document.querySelector(`.lqd-cs-doc-item[data-id="${a.data.id}"]`)){let l=a.data.preview_url;l&&l.startsWith("localhost/")?l=window.location.origin+"/"+l.substring(10):l&&l.startsWith("http://localhost/")&&(l=l.replace("http://localhost/",window.location.origin+"/"));const u={...a.data,preview:l};this.newItems.push(u)}toastr.success(magicai_localize.duplicated_the_document_successfully)}}catch(r){toastr.error("Upload failed:",r)}},async deleteDocument(n){var r;if(!n)return;const e=new FormData;e.append("id",n);try{const a=await fetch(`${window.location.origin}/dashboard/user/creative-suite/document/delete`,{method:"POST",body:e,headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(l.status==="error"){toastr.error(l.message||magicai_localize.error_saving_document);return}l.status==="success"&&((r=document.querySelectorAll(`.lqd-cs-doc-item[data-id="${n}"]`))==null||r.forEach(u=>u.remove()),toastr.success(magicai_localize.document_deleted_successfully))}catch(a){toastr.error("Upload failed:",a)}},async loadDocument(n){if(n)try{const e=await fetch(`${window.location.origin}/dashboard/user/creative-suite/document/${n}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();if(!r.data.payload)return;this.importData({data:JSON.parse(r.data.payload),docId:r.data.id}),this.currentDocName=r.data.name,this.$nextTick(()=>{this.positionTooltip()})}catch(e){console.error("Upload failed:",e)}},async updateDocumentName(n){const e=new FormData(n.target);if(e.get("id")){this.updatingName=!0;try{const r=await fetch(`${window.location.origin}/dashboard/user/creative-suite/document/name`,{method:"POST",body:e,headers:{Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=await r.json();if(a.status==="error"){toastr.error(responseData.message||magicai_localize.error_saving_document);return}document.querySelectorAll(`.lqd-cs-doc-item[data-id="${a.id}"]`).forEach(u=>{const h=u.querySelector("h5");h&&(h.innerText=a.name)}),toastr.success(magicai_localize.name_updated_successfully)}catch(r){toastr.error("Updating name failed:",r)}finally{this.updatingName=!1}}},handleWindowResize(){window.addEventListener("resize",this.onWindowResize)},onWindowResize(){this.setContainerDimensions()},setActiveTooltipDropdown(n){if(!n||this.activeTooltipDropdown===n)return this.activeTooltipDropdown=null;this.activeTooltipDropdown=n},elementIsFocusable(n,e=[]){if(!n||!(n instanceof HTMLElement))return;const r=["INPUT","BUTTON","TEXTAREA","SELECT","A"];return bn.difference(r,e).includes(n.tagName)},docActiveElementIsWritable(){return document.activeElement&&["TEXTAREA","INPUT"].includes(document.activeElement.tagName)},async aiTextAction({prompt:n=""}){if(!n.trim())return;const e=this.selectedNodes.filter(r=>r.getClassName()==="Text");e.length&&e.forEach(async r=>{const a=`request-${r.id()}`,l=new FormData;l.append("lock_key",a),l.append("prompt",n),l.append("content",r.text()),this.aiTasksQueue.push(a),r.setAttr("aiTaskInProgress",!0);const u=await fetch("/dashboard/user/openai/update-writing",{method:"POST",body:l,headers:{Accept:"application/json"}});this.aiTasksQueue=this.aiTasksQueue.filter(f=>f===a),r.setAttr("aiTaskInProgress",!1);const h=await u.json();if(h.type==="error"){toastr.error(h.message);return}h.result&&r.text(h.result)})},async aiImageAction(n){const e=this.selectedNodes.filter(r=>r.getClassName()==="Image"||r.fillPatternImage());e.length&&e.forEach(async r=>{var S,C;const a=`request-${r.id()}`,l=new FormData(n.target),u=Math.min(720,r.width()),h=Math.min(720,r.getAttr("fillImageWidth")??720),f=await r.toBlob({pixelRatio:Math.min(2,Math.max(1,h/u))}),g=new File([f],"image",{type:f.type});l.append("lock_key",a),l.append("uploaded_image",g),this.aiTasksQueue.push(a),r.setAttr("aiTaskInProgress",!0);const v=await fetch(n.target.action,{method:"POST",body:l,headers:{Accept:"application/json"}});if(this.aiTasksQueue=this.aiTasksQueue.filter(A=>A===a),r.setAttr("aiTaskInProgress",!1),!v.ok)return v.json().then(A=>{toastr.error(A.message||"An unknown error occurred")});const y=await v.json();if(y.type==="error"){toastr.error(y.message);return}((S=y==null?void 0:y.data)==null?void 0:S.status)==="CREATED"||((C=y==null?void 0:y.data)==null?void 0:C.status)==="IN_PROGRESS"?this.getAIImageStatus(y.data,r,a):this.onAIImageProcessDone(y.data,r,a)})},async getAIImageStatus(n={},e,r){const a=await fetch("/dashboard/user/advanced-image/editor/"+n.id+"/status",{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)return a.json().then(u=>{toastr.error(u.message||"An unknown error occurred")});const l=await a.json();if(l.status==="error")return toastr.error(l.message);l.data.status==="COMPLETED"?this.onAIImageProcessDone(l.data,e,r):setTimeout(()=>{this.getAIImageStatus(l.data,e,r)},1e3)},onAIImageProcessDone(n,e,r){console.log(n)},isMobile(){return window.innerWidth<768},togglePromptLibraryShow(){this.promptLibraryShow=!this.promptLibraryShow},changePromptFilter(n){n!==this.promptFilter&&(this.promptFilter=n)},setSearchPromptStr(n){this.searchPromptStr=n.trim().toLowerCase()},setPrompt(n){this.prompt=n},focusOnPrompt(){this.$nextTick(()=>{var n;(n=this.$refs.promptInput)==null||n.focus(),this.dropdownOpen=!0})}});var hw=Object.defineProperty,$h=(o,n)=>{for(var e in n)hw(o,e,{get:n[e],enumerable:!0})},fw={};$h(fw,{lerp:()=>zh,makeCurveEasings:()=>Hh,pointOnCurve:()=>Wh,scaleSpreadArray:()=>dw,shuffleArray:()=>Bh});function Bh(o,n=Math.random){const e=[...o];let r=e.length,a;for(;r!=0;)a=Math.floor(n()*r),r--,[e[r],e[a]]=[e[a],e[r]];return e}var zh=(o,n,e)=>n+o*(e-n),dw=(o,n,e=zh)=>{if(!o||o.length<2)throw new Error("valuesToFill array must have at least two values.");if(n<o.length)throw new Error("Target size must be greater than or equal to the valuesToFill array length.");const r=n-o.length,a=o.map(l=>[l]);for(let l=0;l<r;l++)a[l%(o.length-1)].push(null);for(let l=0;l<a.length-1;l++){const u=a[l],h=a[l+1],f=u[0],g=h[0];for(let v=1;v<u.length;v++){const y=v/u.length;u[v]=e(y,f,g)}}return a.flat()},Wh=(o,n)=>e=>{const r=Math.PI/2,a=r/1,l=e;let u=0,h=0;if(o==="lam"){const f=l*r,g=2/(2+20*n),v=Math.cos(f),y=Math.sin(f);u=Math.sign(v)*Math.abs(v)**g,h=Math.sign(y)*Math.abs(y)**g}else if(o==="arc")h=Math.cos(-Math.PI/2+e*a+n),u=Math.sin(Math.PI/2+e*a-n);else if(o==="pow")u=Math.pow(1-l,1-n),h=Math.pow(l,1-n);else if(o==="powY")u=Math.pow(1-l,n),h=Math.pow(l,1-n);else if(o==="powX")u=Math.pow(l,n),h=Math.pow(l,1-n);else if(typeof o=="function"){const[f,g]=o(e,n);u=f,h=g}else throw new Error(`pointOnCurve() curveAccent parameter is expected to be "lam" | "arc" | "pow" | "powY" | "powX" or a function but \`${o}\` given.`);return{x:u,y:h}},Hh=(o,n)=>{const e=Wh(o,n);return{sEasing:r=>e(r).x,lEasing:r=>e(r).y}},Ja={};$h(Ja,{colorHarmonies:()=>pw,colorToCSS:()=>yw,harveyHue:()=>gw,hsv2hsl:()=>Uh,normalizeHue:()=>mt,uniqueRandomHues:()=>mw});function mt(o){return(o%360+360)%360}function gw(o){if(o=mt(o)/360,o===1||o===0)return o;o=1+o%1;const n=1/6,e=o%n/n*Math.PI/2,[r,a]=[n*Math.cos(e),n*Math.sin(e)],l=Math.floor(o*6);return[a,1/3-r,1/3+a,2/3-r,2/3+a,1-r][l%6]*360}var pw={complementary:o=>[mt(o),mt(o+180)],splitComplementary:o=>[mt(o),mt(o+150),mt(o-150)],triadic:o=>[mt(o),mt(o+120),mt(o+240)],tetradic:o=>[mt(o),mt(o+90),mt(o+180),mt(o+270)],monochromatic:o=>[mt(o),mt(o)],doubleComplementary:o=>[mt(o),mt(o+180),mt(o+30),mt(o+210)],compound:o=>[mt(o),mt(o+180),mt(o+60),mt(o+240)],analogous:o=>[mt(o),mt(o+30),mt(o+60),mt(o+90),mt(o+120),mt(o+150)]};function mw({startHue:o=0,total:n=9,minHueDiffAngle:e=60,rndFn:r=Math.random}={}){e=Math.min(e,360/n);const a=o||r()*360,l=Array.from({length:Math.round(360/e)},(h,f)=>(a+f*e)%360);let u=Bh(l,r);return u.length>n&&(u=u.slice(0,n)),u}var Uh=([o,n,e])=>{const r=e-e*n/2,a=Math.min(r,1-r),l=a===0?0:(e-r)/a;return[o,l,r]},vw={oklch:o=>[o[2]*100+"%",o[1]*100+"%",o[0]],lch:o=>[o[2]*100+"%",o[1]*100+"%",o[0]],hsl:o=>[o[0],o[1]*100+"%",o[2]*100+"%"],hsv:o=>{const[n,e,r]=Uh(o);return[n,e*100+"%",r*100+"%"]}},yw=(o,n="oklch")=>`${n==="hsv"?"hsl":n}(${vw[n](o).join(" ")})`;function ja({total:o=9,hStart:n=Math.random()*360,hStartCenter:e=.5,hEasing:r=y=>y,hCycles:a=1,sRange:l=[.4,.35],sEasing:u=y=>Math.pow(y,2),lRange:h=[Math.random()*.1,.9],lEasing:f=y=>Math.pow(y,1.5),transformFn:g=([y,S,C])=>[y,S,C],hueList:v}={}){const y=h[1]-h[0],S=l[1]-l[0],C=v&&v.length>0?v.length:o;return Array.from({length:C},(A,R)=>{const M=R/(C-1),z=1/C,N=v?v[R]:mt(n+(1-r(M,z)-e)*(360*a)),B=l[0]+S*u(M,z),G=h[0]+y*f(M,z);return g([N,B,G],R)})}var bw=({total:o=9,hStart:n=Math.random()*360,hStartCenter:e=.5,hCycles:r=1,sRange:a=[.4,.35],lRange:l=[Math.random()*.1,.9],hueList:u,curveMethod:h="lam",curveAccent:f=.5,transformFn:g=([v,y,S])=>[v,y,S]}={})=>{const{sEasing:v,lEasing:y}=Hh(h,f);return ja({total:o,hStart:n,hStartCenter:e,hCycles:r,sRange:a,lRange:l,sEasing:v,lEasing:y,transformFn:g,hueList:u})};function Rw(){return{options:{},styleTag:document.querySelector("#lqd-customizer-style"),darkMode:document.body.classList.contains("theme-dark"),rootStyles:null,styleString:"",lqdFontPreview:[],googleFontsList:[],showingGoogleFonts:[],fontsPaginationCurrent:20,fontsPaginationLimit:20,loadingFontPreviewQueue:[],localStorageKey:"lqdCustomizerStyle",cssSelectors:{light:":root",dark:".theme-dark"},init(){const o=document.body.getAttribute("data-theme");this.localStorageKey=o+":"+this.localStorageKey,this.onImportStyles=_.throttle(this.onImportStyles.bind(this),300,{leading:!1}),this.loadGoogleFontPreview=_.throttle(this.loadGoogleFontPreview.bind(this),300,{leading:!1}),this.options=window.lqdCustomizerOptions,this.googleFontsList=window.lqdGoogleFontsList,this.currentEdits=this.readFromLocalStorage();const n=document.body.classList.contains("theme-dark");this.rootStyles=getComputedStyle(n?document.body:document.documentElement),Object.entries(this.options).forEach(([e])=>{this.options[e].type==="color"&&(this.options[e].values={},this.options[e].values.light={},this.options[e].values.dark={})}),this.$watch("$store.darkMode.on",e=>{this.darkMode=e,this.rootStyles=getComputedStyle(e?document.body:document.documentElement)}),this.$watch("options",this.updateOutputs.bind(this)),this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit),this.currentEdits&&this.onImportStyles(this.currentEdits)},setStyleStrings(){let o="",n="";if(Object.entries(this.options).forEach(([e,r])=>{var f,g;const a=r.type==="font",l=r.cssVar;let u=r.value,h=null;(f=r.values)!=null&&f.light&&(u=r.values.light.twHsl),(g=r.values)!=null&&g.dark&&(h=r.values.dark.twHsl),u&&(o+=`	${l}: ${a?`'${u}'`:u};
`),h&&(n+=`	${l}: ${h};
`)}),!o.length&&!n.length)return this.styleString="";this.styleString=`${this.cssSelectors.light} {
${o}}`,n.length&&(this.styleString+=`
${this.cssSelectors.dark} {
${n}}`)},updateOutputs(){this.setStyleStrings(),this.fillStyleTag(),this.writeToLocalStorage()},fillStyleTag(){if(!this.styleTag)return console.error("Style tag not found");this.styleTag.innerText=this.styleString.replace(/[\n\t]/g,"")},onColorInput({key:o,color:n,manipulations:e=[],assosiatedKeys:r=[]}){var u;if(((u=this.options[o])==null?void 0:u.type)!=="color")return;const a=this.parseColor({color:n,format:["twHsl","hex"],manipulations:e}),l=this.darkMode?"dark":"light";this.options[o].values[l]={twHsl:a.twHsl,hex:a.hex},r.length&&r.forEach(({key:h,color:f,manipulations:g})=>{this.onColorInput({key:h,color:f||n,manipulations:g})})},parseColor({color:o,format:n="hsl",manipulations:e=[]}){const r=typeof o=="string";let a=r?o.trim():o;r&&(/^--[\w-]+$/.test(o)&&(a=this.rootStyles.getPropertyValue(o).trim()),/\S+\s+\S+/.test(a)&&!a.startsWith("hsl")&&(a=`hsl(${a})`));let l=tinycolor(a);if(e.length&&e.forEach(({type:u,value:h,condition:f})=>{if(!(f==="lightMode"&&this.darkMode||f==="darkMode"&&!this.darkMode)){if(u==="autoBlackWhite")return l=l.getLuminance()>=.4?tinycolor("#000"):tinycolor("#fff");l=l[u](h)}}),Array.isArray(n)){const u={};return n.forEach(h=>{u[h]=this.getColorString(l,h)}),u}return this.getColorString(l,n)},getColorString(o,n="hsl"){if(n==="colorObj")return o;if(n==="twHsl"){const e=o.toHsl();return`${Math.ceil(e.h)} ${Math.ceil(e.s*100)}% ${Math.ceil(e.l*100)}%${e.a&&e.a!==1?` / ${Math.ceil(e.a*100)}%`:""}`}return o.toString(n)},randomColors(){const o=tinycolor.random();let n=[.25,1],e=[1,.05];this.darkMode&&(n[1]=.7,e=e.reverse());const r=ja({total:7,hStart:o.toHsl().h,hStartCenter:0,hCycles:.75,hEasing:(wt,Ct)=>wt+(-Ct+Math.random()*Ct*2)*.5,sRange:n,lRange:e,sEasing:(wt,Ct)=>wt+(-Ct+Math.random()*Ct*2)*.5,lEasing:(wt,Ct)=>wt+(-Ct+Math.random()*Ct*2)*.5}),a=bw({hueList:Ja.colorHarmonies.splitComplementary(o.toHsl().h),sRange:n.reverse(),lRange:e.reverse(),curveMethod:"arc",curveAccent:.01}),l=ja({hueList:Ja.uniqueRandomHues({startHue:0,total:4,minDistance:90}),sRange:[.5,.9],lRange:[.5,.9]}),u=Math.floor(r.length/2),h=r[u],f=r[u-1],g=r[u+1],v=r[0],y=r[r.length-1],S=r[1],C=Math.floor(a.length/2),A=a[a.length-1],R=a[0],M=a[C],z=l[0],N=l[1],B=l[2],G=tinycolor({h:h[0],s:h[1],l:h[2]}),ft=tinycolor({h:f[0],s:Math.min(1,f[1]),l:Math.min(1,f[2])}),ut=tinycolor({h:g[0],s:Math.min(1,g[1]),l:Math.min(1,g[2])}),dt=tinycolor({h:y[0],s:Math.min(1,y[1]),l:Math.min(1,y[2])}),xt=tinycolor({h:v[0],s:Math.min(1,v[1]),l:Math.min(1,v[2])}).desaturate(this.darkMode?30:0),nt=tinycolor({h:S[0],s:Math.min(1,S[1]),l:Math.min(1,S[2])}).desaturate(20).setAlpha(.55),Jt=tinycolor({h:A[0],s:Math.min(1,A[1]),l:Math.min(1,A[2])}).desaturate(this.darkMode?30:0),It=tinycolor({h:R[0],s:Math.min(1,R[1]),l:Math.min(1,R[2])}),Vt=tinycolor({h:M[0],s:Math.min(1,M[1]),l:Math.min(1,M[2])})[this.darkMode?"lighten":"darken"](30),Dt=tinycolor({h:z[0],s:Math.min(1,z[1]),l:Math.min(1,z[2])}),Ot=tinycolor({h:N[0],s:Math.min(1,N[1]),l:Math.min(1,N[2])}),jt=tinycolor({h:B[0],s:Math.min(1,B[1]),l:Math.min(1,B[2])});this.onColorInput({key:"colorMainPrimary",color:G,assosiatedKeys:[{key:"colorMainPrimaryForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainSecondary",color:ft,assosiatedKeys:[{key:"colorMainSecondaryForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainAccent",color:ut,assosiatedKeys:[{key:"colorMainAccentForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainForeground",color:dt,assosiatedKeys:[{key:"colorMainHeadingForeground",manipulations:[{type:"darken",value:22,condition:"lightMode"},{type:"lighten",value:30,condition:"darkMode"},{type:"desaturate",value:7,condition:"lightMode"},{type:"desaturate",value:30,condition:"darkMode"}]}]}),this.onColorInput({key:"colorMainBackground",color:xt}),this.onColorInput({key:"colorMainBorder",color:nt}),this.onColorInput({key:"colorNavbarBackground",color:Jt}),this.onColorInput({key:"colorNavbarForeground",color:It}),this.onColorInput({key:"colorNavbarActiveBackground",color:Vt,assosiatedKeys:[{key:"colorNavbarActiveForeground"},{key:"colorNavbarHoverForeground"},{key:"colorNavbarHoverBackground"}]}),this.onColorInput({key:"colorMainGradientFrom",color:Dt}),this.onColorInput({key:"colorMainGradientVia",color:Ot}),this.onColorInput({key:"colorMainGradientTo",color:jt})},addToGoogleFontLoadQueue(o,n=!1){if(!(n&&this.lqdFontPreview.includes(o))){if(!n)return this.loadGoogleFontFull(o);this.loadingFontPreviewQueue.push(o),this.loadGoogleFontPreview(o),this.lqdFontPreview.push(o)}},loadGoogleFontPreview(){if(!this.loadingFontPreviewQueue.length)return;const o=this.loadingFontPreviewQueue.map(r=>`family=${r}`).join("&").replaceAll(" ","+"),n=encodeURIComponent(this.loadingFontPreviewQueue.join("")),e=`https://fonts.googleapis.com/css2?${o}&display=swap&text=${n}`;this.createLink(e),this.loadingFontPreviewQueue=[]},loadGoogleFontFull(o){const n=`https://fonts.googleapis.com/css2?family=${o.replaceAll(/ /g,"+")}&display=swap`;this.createLink(n)},createLink(o){const n=document.createElement("link");n.href=o,n.rel="stylesheet",n.type="text/css",document.head.appendChild(n)},onImportStyles(o){if(!o)return;let n=o.trim();const e={},r=/([\w\s\.\:\-\#]+)\s*\{([^}]*)\}/g;let a;for(;(a=r.exec(n))!==null;){const l=a[1].trim(),u=a[2].trim().split(";").filter(Boolean);e[l]=e[l]||[];for(const h of u){const f=h.indexOf(":");if(f>0){const g=h.slice(0,f).trim(),v=h.slice(f+1).trim();g&&v&&e[l].push({property:g,value:v})}}}Object.entries(this.options).forEach(([l,u])=>{const h=u.cssVar;Object.entries(this.cssSelectors).forEach(([f,g])=>{var S;const v=(S=e[g])==null?void 0:S.find(C=>C.property===h);if(!v)return;const y=this.sanitizeCssValue(v.value);if(u.type==="color"){const C=this.parseColor({color:y,format:["twHsl","hex"]});this.options[l].values[f].twHsl=C.twHsl,this.options[l].values[f].hex=C.hex}else if(u.type==="font"){const C=y.replace(/['"]/g,"");this.options[l].value=C,this.addToGoogleFontLoadQueue(C)}else this.options[l].value=y})})},sanitizeCssValue(o){if(!o)return"";o=o.replace(/javascript:/gi,"").replace(/expression\(/gi,"").replace(/eval\(/gi,"").replace(/url\(/gi,"").replace(/data:/gi,""),o=o.replace(/[^\w\s,.#:;%\/\-+()[\]@!~="'*]/g,"");const n=(o.match(/'/g)||[]).length,e=(o.match(/"/g)||[]).length;return n%2!==0&&(o=o.replace(/'/g,"")),e%2!==0&&(o=o.replace(/"/g,"")),o},resetStyles(){Object.entries(this.options).forEach(([o,n])=>{n.type==="color"?(this.options[o].values.light={},this.options[o].values.dark={}):n.type==="font"?this.options[o].value="":this.options[o].value=""})},readFromLocalStorage(){let o=localStorage.getItem(this.localStorageKey);return o||(o=this.styleTag.textContent),o},writeToLocalStorage(){const o=this.styleString.replace(/[\n\t]/g,"");if(!o){this.emptyLocalStorage();return}localStorage.setItem(this.localStorageKey,o)},emptyLocalStorage(){localStorage.removeItem(this.localStorageKey)},saveAndClose(){this.setBackEnd(this.styleString??"")},discardChanges(){var n,e;!(((e=(n=this.currentEdits)==null?void 0:n.replace(/[\n\t]/g,""))==null?void 0:e.trim())??"").length&&this.resetStyles(),this.emptyLocalStorage(),this.setBackEnd("",!0)},async setBackEnd(o="",n=!1){const e={};Object.entries(this.options).forEach(([l,u])=>{u.type==="font"&&(e[l]=u.value)});const r=await fetch("/dashboard/admin/live-customizer",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({style:o,fonts:e,clear:n})});let a=await r.json();if(!r.ok){toastr.error("Error uploading the customizer styles");return}if(a.status==="success"){toastr.success(a.message),setTimeout(()=>{this.emptyLocalStorage(),window.location.reload()},1e3);return}toastr.error(a.message??"Error uploading the customizer styles")}}}function Mw(o){return{dropdownOpen:!1,selectedFont:"",searchString:"",init(){this.$watch("selectedFont",n=>{this.options[o].value=n})},onSearchInput(){const n=this.$event.target.value.trim();if(!n){this.fontsPaginationCurrent=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit);return}this.showingGoogleFonts=this.googleFontsList.filter(e=>e.toLowerCase().includes(n.toLowerCase()))},loadMoreFonts(){this.fontsPaginationCurrent+=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationCurrent)}}}rn.store("realtimeChatStatus",{active:!1,conversationStarted:!1,setActive(o){this.active=o,this.onActiveChange()},setConversationStarted(o){this.conversationStarted=o,this.onConversationStartedChange()},onActiveChange(){var o,n;document.querySelectorAll(".lqd-realtime-chat-button").forEach(e=>e.classList.toggle("active",this.active)),(n=(o=document.querySelector(".lqd-audio-vis-wrap"))==null?void 0:o.classList)==null||n.toggle("active",this.active)},onConversationStartedChange(){const o=document.querySelector(".chats-wrap");o.classList.toggle("conversation-started",this.conversationStarted),o.classList.toggle("conversation-not-started",!this.conversationStarted),document.querySelectorAll(".lqd-realtime-chat-button").forEach(n=>{n.classList.toggle("conversation-started",this.conversationStarted),n.classList.toggle("conversation-not-started",!this.conversationStarted)})}});const Ow=o=>({agentId:o,recordingActive:!1,buffer:new Uint8Array,conversation:null,audioRecorder:null,audioPlayer:null,activeVisulaizer:"idle",audioVisWrap:null,audioVisBars:null,audioVisDotWrap:null,audioVisLoader:null,conversationArea:document.querySelector(".conversation-area"),chatsContainer:document.querySelector(".chats-container"),userBubbleTemplate:document.querySelector("#chat_user_bubble"),aiBubbleTemplate:document.querySelector("#chat_ai_bubble"),lastAiBubble:null,lastUserBubble:null,lastUserQuestion:"",lastAiResponse:"",lastResponseSaved:!1,init(){var n,e,r;this.audioVisWrap=document.querySelector(".lqd-audio-vis-wrap"),this.audioVisBars=(n=this.audioVisWrap)==null?void 0:n.querySelectorAll(".lqd-audio-vis-bar"),this.audioVisDotWrap=(e=this.audioVisWrap)==null?void 0:e.querySelector(".lqd-audio-vis-dot-wrap"),this.audioVisLoader=(r=this.audioVisWrap)==null?void 0:r.querySelector(".lqd-audio-vis-loader"),this.processAudioRecordingBuffer=this.processAudioRecordingBuffer.bind(this)},async start(){if(rn.store("realtimeChatStatus").isActive)return;rn.store("realtimeChatStatus").setActive(!0),this.switchVisualizers("waiting");const n=await this.checkBalance(!0);if(n.shouldStop){toastr.error(n.errorMsg),this.stop();return}this.conversation=await M0.startSession({agentId:this.agentId,onConnect:async()=>{await Promise.all([this.startRecorder(),this.startPlayer()]).then(()=>{this.startBarsVisualizer(),this.startDotVisualizer(),this.switchVisualizers("idle"),rn.store("realtimeChatStatus").setConversationStarted(!0)}).catch(e=>{this.stop(),console.error("Error starting recorder and player:",e),this.appendToChatBubble("ai","[Error]: Unable to start audio recorder and player. Please check your microphone permissions and refresh the page.")})},onDisconnect:()=>{var e;this.disconnectHandle((e=this.conversation)==null?void 0:e.connection),this.stop()},onModeChange:e=>{this.checkBalance().then(r=>{if(r.shouldStop){this.stop(),toastr.error(r.errorMsg);return}})},onMessage:e=>{e.source=="ai"?(this.createChatBubble("ai"),this.appendToChatBubble("ai",e.message),this.lastAiResponse=e.message,"saveResponseAsync"in window&&(saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","elevenlabs-voice-chatbot"),this.lastResponseSaved=!0),"formatString"in window&&this.lastAiBubble&&(this.lastAiBubble.innerHTML=formatString(this.lastAiResponse)),this.lastAiResponse=this.lastUserQuestion=""):(this.createChatBubble("user"),this.appendToChatBubble("user",e.message),this.lastUserQuestion+=" "+e.message,this.lastResponseSaved=!1)},onError:e=>{console.error("Error:",e),this.stop()}})},async stop(){!this.lastResponseSaved&&"saveResponseAsync"in window&&this.lastUserQuestion.trim()!==""&&this.lastAiResponse.trim()!==""&&saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","elevenlabs-voice-chatbot"),this.resetPlayers(),this.conversation&&(await this.conversation.endSession(),this.conversation=null),this.switchVisualizers(""),rn.store("realtimeChatStatus").setActive(!1)},async startPlayer(){try{this.audioPlayer=new kh,await this.audioPlayer.init(24e3)}catch(n){console.error("Error starting audio player:",n)}},async startRecorder(){try{this.audioRecorder=new uh(this.processAudioRecordingBuffer);const n=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});await this.audioRecorder.start(n),this.recordingActive=!0}catch(n){console.error("Error starting audio recorder:",n)}},combineArray(n){const e=new Uint8Array(this.buffer.length+n.length);e.set(this.buffer),e.set(n,this.buffer.length),this.buffer=e},processAudioRecordingBuffer(n){const e=new Uint8Array(n);if(this.combineArray(e),this.buffer.length>=4800){const r=new Uint8Array(this.buffer.slice(0,4800));this.buffer=new Uint8Array(this.buffer.slice(4800));const a=String.fromCharCode(...r);btoa(a)}},async resetPlayers(){var n,e;this.recordingActive=!1,(n=this.audioRecorder)==null||n.stop(),(e=this.audioPlayer)==null||e.clear()},getSystemMessage(){return""},getTemperature(){return parseFloat(.8)},getVoice(){return"alloy"},switchVisualizers(n){var e;this.activeVisulaizer=n,(e=this.audioVisWrap)==null||e.setAttribute("data-state",this.activeVisulaizer)},createChatBubble(n){const r=(n==="user"?this.userBubbleTemplate:this.aiBubbleTemplate).content.cloneNode(!0),a=r.querySelector(".chat-content");this.chatsContainer.appendChild(r),n==="user"?this.lastUserBubble=a:this.lastAiBubble=a,this.scrollConversationAreaToBottom()},appendToChatBubble(n,e){const r=n==="user"?this.lastUserBubble:this.lastAiBubble;r?(r.textContent+=e,this.scrollConversationAreaToBottom()):(this.createChatBubble(n),this.appendToChatBubble(n,e))},scrollConversationAreaToBottom(){this.conversationArea.scrollTo({top:this.conversationArea.scrollHeight+200,left:0})},startBarsVisualizer(){var h;if(!((h=this.audioVisBars)!=null&&h.length))return;const n=this.audioPlayer.audioContext.createAnalyser();n.fftSize=4096;const e=n.frequencyBinCount,r=new Uint8Array(e),a=this.audioVisBars.length;this.audioPlayer.playbackNode.connect(n);const l=[[85,150],[150,250],[250,400],[400,600],[600,1e3]];this.barHeights=this.barHeights||new Array(a).fill(0);const u=()=>{n.getByteFrequencyData(r),this.audioVisBars.forEach((f,g)=>{const[v,y]=l[g],S=Math.floor(v/(this.audioPlayer.audioContext.sampleRate/n.fftSize)),C=Math.ceil(y/(this.audioPlayer.audioContext.sampleRate/n.fftSize));let A=0;for(let M=S;M<=C&&M<r.length;M++)r[M]>A&&(A=r[M]);let R=A/255*80;this.barHeights[g]+=(R-this.barHeights[g])*.4,this.barHeights[g]+=(Math.random()-.5)*2,this.barHeights[g]=Math.max(5,Math.min(100,this.barHeights[g])),f.animate([{height:f.style.height},{height:`${this.barHeights[g]}%`}],{duration:30,fill:"forwards",easing:"linear"})}),requestAnimationFrame(u)};u()},startDotVisualizer(){if(!this.audioRecorder||!this.audioVisDotWrap)return;const n=this.audioRecorder.audioContext.createAnalyser();n.fftSize=256;const e=n.frequencyBinCount,r=new Uint8Array(e);this.audioRecorder.getMediaStreamSource().connect(n);const a=this.audioVisDotWrap.querySelector(".lqd-audio-vis-dot");if(!a)return;const l=()=>{n.getByteFrequencyData(r);let u=0;for(let v=0;v<e;v++)u+=r[v];const f=1+u/e/256*1.5,g=Math.max(.2,1-(f-1)/1.5);a.style.transform=`scale(${f})`,a.style.opacity=g.toFixed(2),requestAnimationFrame(l)};l()},checkBalance(n=!1){return new Promise(e=>{$.ajax({url:"/dashboard/admin/voice-chatbot/check-balance",type:"POST",data:{onStart:n},dataType:"json",success:r=>{const a=r.status!=="success",l=r.message||"";e({shouldStop:a,errorMsg:l})},error:()=>{e({shouldStop:!0,errorMsg:"An error occurred."})}})})},disconnectHandle(n){var e,r;((e=n==null?void 0:n.disconnectionDetails)==null?void 0:e.reason)=="error"&&(toastr.error("Something went wrong. Please contact support for assistance"),console.error((r=n==null?void 0:n.disconnectionDetails)==null?void 0:r.message))}});export{xw as M,Z as S,Ew as a,Cw as b,Tw as c,Iw as d,Ow as e,Pw as f,Rw as g,Mw as h,Dw as i,bn as l,Sw as m,Aw as o};
